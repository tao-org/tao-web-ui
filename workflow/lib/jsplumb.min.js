(function(){function a(n,t){return[-n[0][t]+3*n[1][t]+-3*n[2][t]+n[3][t],3*n[0][t]-6*n[1][t]+3*n[2][t],-3*n[0][t]+3*n[1][t],n[0][t]]}function st(n){return[a(n,"x"),a(n,"y")]}function v(n){return n<0?-1:n>0?1:0}function ht(n,t,i,r){var f=t/n,y=i/n,p=r/n,s=(3*y-Math.pow(f,2))/9,e=(9*f*y-27*p-2*Math.pow(f,3))/54,h=Math.pow(s,3)+Math.pow(e,2),c,l,u=[],a,o;for(h>=0?(c=v(e+Math.sqrt(h))*Math.pow(Math.abs(e+Math.sqrt(h)),1/3),l=v(e-Math.sqrt(h))*Math.pow(Math.abs(e-Math.sqrt(h)),1/3),u[0]=-f/3+(c+l),u[1]=-f/3-(c+l)/2,u[2]=-f/3-(c+l)/2,Math.abs(Math.sqrt(3)*(c-l)/2)!==0&&(u[1]=-1,u[2]=-1)):(a=Math.acos(e/Math.sqrt(-Math.pow(s,3))),u[0]=2*Math.sqrt(-s)*Math.cos(a/3)-f/3,u[1]=2*Math.sqrt(-s)*Math.cos((a+2*Math.PI)/3)-f/3,u[2]=2*Math.sqrt(-s)*Math.cos((a+4*Math.PI)/3)-f/3),o=0;o<3;o++)(u[o]<0||u[o]>1)&&(u[o]=-1);return u}var ct=this,y;typeof Math.sgn=="undefined"&&(Math.sgn=function(n){return n==0?0:n>0?1:-1});var n={subtract:function(n,t){return{x:n.x-t.x,y:n.y-t.y}},dotProduct:function(n,t){return n.x*t.x+n.y*t.y},square:function(n){return Math.sqrt(n.x*n.x+n.y*n.y)},scale:function(n,t){return{x:n.x*t,y:n.y*t}}},o=64,p=Math.pow(2,-o-1),s=function(t,i){for(var r,h=[],a=b(t,i),c=i.length-1,v=2*c-1,y=u(a,v,h,0),e=n.subtract(t,i[0]),o=n.square(e),l=0,s=0;s<y;s++)e=n.subtract(t,f(i,c,h[s],null,null)),r=n.square(e),r<o&&(o=r,l=h[s]);return e=n.subtract(t,i[c]),r=n.square(e),r<o&&(o=r,l=1),{location:l,distance:o}},w=function(n,t){var i=s(n,t);return{point:f(t,t.length-1,i.location,null,null),location:i.location}},b=function(t,i){for(var f,s,a,v,o,w,b,l,u=i.length-1,y=2*u-1,p=[],h=[],c=[],e=[],k=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],r=0;r<=u;r++)p[r]=n.subtract(i[r],t);for(r=0;r<=u-1;r++)h[r]=n.subtract(i[r+1],i[r]),h[r]=n.scale(h[r],3);for(f=0;f<=u-1;f++)for(s=0;s<=u;s++)c[f]||(c[f]=[]),c[f][s]=n.dotProduct(h[f],p[s]);for(r=0;r<=y;r++)e[r]||(e[r]=[]),e[r].y=0,e[r].x=parseFloat(r)/y;for(a=u,v=u-1,o=0;o<=a+v;o++)for(w=Math.max(0,o-v),b=Math.min(o,a),r=w;r<=b;r++)l=o-r,e[r+l].y+=c[l][r]*k[l][r];return e},u=function(n,t,i,r){var c=[],l=[],s,h,a=[],v=[],e;switch(k(n,t)){case 0:return 0;case 1:if(r>=o)return i[0]=(n[0].x+n[t].x)/2,1;if(d(n,t))return i[0]=g(n,t),1}for(f(n,t,.5,c,l),s=u(c,t,a,r+1),h=u(l,t,v,r+1),e=0;e<s;e++)i[e]=a[e];for(e=0;e<h;e++)i[e+s]=v[e];return s+h},k=function(n,t){for(var f=0,u,i=u=Math.sgn(n[0].y),r=1;r<=t;r++)i=Math.sgn(n[r].y),i!=u&&f++,u=i;return f},d=function(n,t){var g,w,b,nt,tt,e,o,s,h,c,k,r,d,l,i,a,v,y,u,f;for(e=n[0].y-n[t].y,o=n[t].x-n[0].x,s=n[0].x*n[t].y-n[t].x*n[0].y,v=y=0,u=1;u<t;u++)f=e*n[u].x+o*n[u].y+s,f>v?v=f:f<y&&(y=f);return k=0,r=1,d=0,l=e,i=o,a=s-v,h=k*i-l*r,c=1/h,w=(r*a-i*d)*c,l=e,i=o,a=s-y,h=k*i-l*r,c=1/h,b=(r*a-i*d)*c,nt=Math.min(w,b),tt=Math.max(w,b),g=tt-nt,g<p?1:0},g=function(n,t){var i=1,r=n[t].x-n[0].x,u=n[t].y-n[0].y,f=n[0].x-0,e=n[0].y-0,o=r*0-u*i,s=1/o,h=(r*e-u*f)*s;return 0+i*h},f=function(n,t,i,r,u){for(var o,e=[[]],f=0;f<=t;f++)e[0][f]=n[f];for(o=1;o<=t;o++)for(f=0;f<=t-o;f++)e[o]||(e[o]=[]),e[o][f]||(e[o][f]={}),e[o][f].x=(1-i)*e[o-1][f].x+i*e[o-1][f+1].x,e[o][f].y=(1-i)*e[o-1][f].y+i*e[o-1][f+1].y;if(r!=null)for(f=0;f<=t;f++)r[f]=e[f][0];if(u!=null)for(f=0;f<=t;f++)u[f]=e[t-f][f];return e[t][0]},h={},nt=function(n){var t=h[n],r,u,i;if(!t){t=[];var f=function(){return function(t){return Math.pow(t,n)}},e=function(){return function(t){return Math.pow(1-t,n)}},o=function(n){return function(){return n}},s=function(){return function(n){return n}},c=function(){return function(n){return 1-n}},l=function(n){return function(t){for(var i=1,r=0;r<n.length;r++)i=i*n[r](t);return i}};for(t.push(new f),r=1;r<n;r++){for(u=[new o(n)],i=0;i<n-r;i++)u.push(new s);for(i=0;i<r;i++)u.push(new c);t.push(new l(u))}t.push(new e);h[n]=t}return t},i=function(n,t){for(var f=nt(n.length-1),r=0,u=0,i=0;i<n.length;i++)r=r+n[i].x*f[i](t),u=u+n[i].y*f[i](t);return{x:r,y:u}},c=function(n,t){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))},l=function(n){return n[0].x===n[1].x&&n[0].y===n[1].y},r=function(n,t,r){if(l(n))return{point:n[0],location:t};for(var e=i(n,t),o=0,f=t,s=r>0?1:-1,u=null;o<Math.abs(r);)f+=.005*s,u=i(n,f),o+=c(u,e),e=u;return{point:u,location:f}},tt=function(n){var e=(new Date).getTime();if(l(n))return 0;for(var u=i(n,0),f=0,t=0,r=null;t<1;)t+=.005*1,r=i(n,t),f+=c(r,u),u=r;return console.log("length",(new Date).getTime()-e),f},it=function(n,t,i){return r(n,t,i).point},rt=function(n,t,i){return r(n,t,i).location},e=function(n,t){var r=i(n,t),u=i(n.slice(0,n.length-1),t),f=u.y-r.y,e=u.x-r.x;return f===0?Infinity:Math.atan(f/e)},ut=function(n,t,i){var u=r(n,t,i);return u.location>1&&(u.location=1),u.location<0&&(u.location=0),e(n,u.location)},ft=function(n,t,i,u){u=u==null?0:u;var f=r(n,t,u),c=e(n,f.location),o=Math.atan(-1/c),s=i/2*Math.sin(o),h=i/2*Math.cos(o);return[{x:f.point.x+h,y:f.point.y+s},{x:f.point.x-h,y:f.point.y-s}]},t=function(n,t,i,r,u){var o=r-t,s=n-i,w=n*(t-r)+t*(i-n),f=st(u),b=[o*f[0][0]+s*f[1][0],o*f[0][1]+s*f[1][1],o*f[0][2]+s*f[1][2],o*f[0][3]+s*f[1][3]+w],a=ht.apply(null,b),v=[],h;if(a!=null)for(h=0;h<3;h++){var e=a[h],y=Math.pow(e,2),p=Math.pow(e,3),c=[f[0][0]*p+f[0][1]*y+f[0][2]*e+f[0][3],f[1][0]*p+f[1][1]*y+f[1][2]*e+f[1][3]],l;l=i-n!=0?(c[0]-n)/(i-n):(c[1]-t)/(r-t);e>=0&&e<=1&&l>=0&&l<=1&&v.push(c)}return v},et=function(n,i,r,u,f){var e=[];return e.push.apply(e,t(n,i,n+r,i,f)),e.push.apply(e,t(n+r,i,n+r,i+u,f)),e.push.apply(e,t(n+r,i+u,n,i+u,f)),e.push.apply(e,t(n,i+u,n,i,f)),e},ot=function(n,i){var r=[];return r.push.apply(r,t(n.x,n.y,n.x+n.w,n.y,i)),r.push.apply(r,t(n.x+n.w,n.y,n.x+n.w,n.y+n.h,i)),r.push.apply(r,t(n.x+n.w,n.y+n.h,n.x,n.y+n.h,i)),r.push.apply(r,t(n.x,n.y+n.h,n.x,n.y,i)),r};y=this.jsBezier={distanceFromCurve:s,gradientAtPoint:e,gradientAtPointAlongCurveFrom:ut,nearestPointOnCurve:w,pointOnCurve:i,pointAlongCurveFrom:it,perpendicularToCurveAt:ft,locationAlongCurveFrom:rt,getLength:tt,lineIntersection:t,boxIntersection:et,boundingBoxIntersection:ot,version:"0.9.0"};typeof exports!="undefined"&&(exports.jsBezier=y)}).call(typeof window!="undefined"?window:this),function(){"use strict";var f=this,n=f.Biltong={version:"0.4.0"};typeof exports!="undefined"&&(exports.Biltong=n);var r=function(n){return Object.prototype.toString.call(n)==="[object Array]"},t=function(n,t,i){return n=r(n)?n:[n.x,n.y],t=r(t)?t:[t.x,t.y],i(n,t)},i=n.gradient=function(n,i){return t(n,i,function(n,t){return t[0]==n[0]?t[1]>n[1]?Infinity:-Infinity:t[1]==n[1]?t[0]>n[0]?0:-0:(t[1]-n[1])/(t[0]-n[0])})},s=n.normal=function(n,t){return-1/i(n,t)},h=n.lineLength=function(n,i){return t(n,i,function(n,t){return Math.sqrt(Math.pow(t[1]-n[1],2)+Math.pow(t[0]-n[0],2))})},u=n.quadrant=function(n,i){return t(n,i,function(n,t){return t[0]>n[0]?t[1]>n[1]?2:1:t[0]==n[0]?t[1]>n[1]?2:1:t[1]>n[1]?3:4})},c=n.theta=function(n,r){return t(n,r,function(n,t){var e=i(n,t),r=Math.atan(e),f=u(n,t);return(f==4||f==3)&&(r+=Math.PI),r<0&&(r+=2*Math.PI),r})},l=n.intersects=function(n,t){var i=n.x,s=n.x+n.w,u=n.y,f=n.y+n.h,r=t.x,h=t.x+t.w,e=t.y,o=t.y+t.h;return i<=r&&r<=s&&u<=e&&e<=f||i<=h&&h<=s&&u<=e&&e<=f||i<=r&&r<=s&&u<=o&&o<=f||i<=h&&r<=s&&u<=o&&o<=f||r<=i&&i<=h&&e<=u&&u<=o||r<=s&&s<=h&&e<=u&&u<=o||r<=i&&i<=h&&e<=f&&f<=o||r<=s&&i<=h&&e<=f&&f<=o},a=n.encloses=function(n,t,i){var u=n.x,f=n.x+n.w,e=n.y,o=n.y+n.h,s=t.x,h=t.x+t.w,c=t.y,l=t.y+t.h,r=function(n,t,r,u){return i?n<=t&&r>=u:n<t&&r>u};return r(u,s,f,h)&&r(e,c,o,l)},e=[null,[1,-1],[1,1],[-1,1],[-1,-1]],o=[null,[-1,-1],[-1,1],[1,1],[1,-1]],v=n.pointOnLine=function(n,t,r){var c=i(n,t),f=u(n,t),s=r>0?e[f]:o[f],h=Math.atan(c),l=Math.abs(r*Math.sin(h))*s[1],a=Math.abs(r*Math.cos(h))*s[0];return{x:n.x+a,y:n.y+l}},y=n.perpendicularLineTo=function(n,t,r){var o=i(n,t),u=Math.atan(-1/o),f=r/2*Math.sin(u),e=r/2*Math.cos(u);return[{x:t.x+e,y:t.y+f},{x:t.x-e,y:t.y-f}]}}.call(typeof window!="undefined"?window:this),function(){"use strict";function nt(n,t,i,r,u,f,e,o){return new Touch({target:t,identifier:yt(),pageX:i,pageY:r,screenX:u,screenY:f,clientX:e||u,clientY:o||f})}function tt(){var n=[];return Array.prototype.push.apply(n,arguments),n.item=function(n){return this[n]},n}function it(){return tt(nt.apply(null,arguments))}var t=this,f=function(n,t,i){var u,r;for(i=i||n.parentNode,u=i.querySelectorAll(t),r=0;r<u.length;r++)if(u[r]===n)return!0;return!1},o=function(n){return typeof n=="string"||n.constructor===String?document.getElementById(n):n},r=function(n){return n.srcElement||n.target},v=function(n,t,i,r){if(r){if(typeof n.path!="undefined"&&n.path.indexOf)return{path:n.path,end:n.path.indexOf(i)};var u={path:[],end:-1},f=function(n){u.path.push(n);n===i?u.end=u.path.length-1:n.parentNode!=null&&f(n.parentNode)};return f(t),u}return{path:[t],end:1}},w=function(n,t){for(var i=0,r=n.length;i<r;i++)if(n[i]==t)break;i<n.length&&n.splice(i,1)},rt=1,b=function(n,t,i){var r=rt++;return n.__ta=n.__ta||{},n.__ta[t]=n.__ta[t]||{},n.__ta[t][r]=i,i.__tauid=r,r},ut=function(n,t,i){if(n.__ta&&n.__ta[t]&&delete n.__ta[t][i.__tauid],i.__taExtra){for(var r=0;r<i.__taExtra.length;r++)l(n,i.__taExtra[r][0],i.__taExtra[r][1]);i.__taExtra.length=0}i.__taUnstore&&i.__taUnstore()},s=function(n,t,i,u){if(n==null)return i;var o=n.split(","),e=function(u){var s,h;e.__tauid=i.__tauid;var a=r(u),c=a,l=v(u,a,t,n!=null);if(l.end!=-1)for(s=0;s<l.end;s++)for(c=l.path[s],h=0;h<o.length;h++)f(c,o[h],t)&&i.apply(c,arguments)};return ft(i,u,e),e},ft=function(n,t,i){n.__taExtra=n.__taExtra||[];n.__taExtra.push([t,i])},i=function(t,i,r,f){if(u&&n[i]){var e=s(f,t,r,n[i]);c(t,n[i],e,r)}i==="focus"&&t.getAttribute("tabindex")==null&&t.setAttribute("tabindex","1");c(t,i,s(f,t,r,i),r)},et=function(n,t,u,f){if(n.__taSmartClicks==null){var e=function(t){n.__tad=h(t)},o=function(t){n.__tau=h(t)},s=function(t){if(n.__tad&&n.__tau&&n.__tad[0]===n.__tau[0]&&n.__tad[1]===n.__tau[1])for(var i=0;i<n.__taSmartClicks.length;i++)n.__taSmartClicks[i].apply(r(t),[t])};i(n,"mousedown",e,f);i(n,"mouseup",o,f);i(n,"click",s,f);n.__taSmartClicks=[]}n.__taSmartClicks.push(u);u.__taUnstore=function(){w(n.__taSmartClicks,u)}},y={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},ot=function(n,t){return function(u,o,s,h){if(o=="contextmenu"&&e)i(u,o,s,h);else{if(u.__taTapHandler==null){var c=u.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]},l=function(i){for(var e,o=r(i),l=v(i,o,u,h!=null),a=!1,s=0;s<l.end;s++){if(a)return;for(o=l.path[s],e=0;e<c.downSelectors.length;e++)if(c.downSelectors[e]==null||f(o,c.downSelectors[e],u)){c.down=!0;setTimeout(p,n);setTimeout(b,t);a=!0;break}}},a=function(n){var l,s,h,a,t,e,i,o;if(c.down){l=r(n);c.taps++;a=vt(n);for(t in y)if(y.hasOwnProperty(t)&&(e=y[t],e.touches===a&&(e.taps===1||e.taps===c.taps)))for(i=0;i<c[t].length;i++)for(h=v(n,l,u,c[t][i][1]!=null),o=0;o<h.end;o++)if(s=h.path[o],c[t][i][1]==null||f(s,c[t][i][1],u)){c[t][i][0].apply(s,[n]);break}}},p=function(){c.down=!1},b=function(){c.taps=0};i(u,"mousedown",l);i(u,"mouseup",a)}u.__taTapHandler.downSelectors.push(h);u.__taTapHandler[o].push([s,h]);s.__taUnstore=function(){w(u.__taTapHandler[o],s)}}}},k=function(n,t,i,r){for(var u in i.__tamee[n])i.__tamee[n].hasOwnProperty(u)&&i.__tamee[n][u].apply(r,[t])},st=function(){var n=[];return function(t,i,u,e){if(!t.__tamee){t.__tamee={over:!1,mouseenter:[],mouseexit:[]};var o=function(i){var u=r(i);(e!=null||u!=t||t.__tamee.over)&&(!f(u,e,t)||u.__tamee!=null&&u.__tamee.over)||(k("mouseenter",i,t,u),u.__tamee=u.__tamee||{},u.__tamee.over=!0,n.push(u))},h=function(i){for(var u=r(i),e=0;e<n.length;e++)u!=n[e]||f(i.relatedTarget||i.toElement,"*",u)||(u.__tamee.over=!1,n.splice(e,1),k("mouseexit",i,t,u))};c(t,"mouseover",s(e,t,o,"mouseover"),o);c(t,"mouseout",s(e,t,h,"mouseout"),h)}u.__taUnstore=function(){delete t.__tamee[i][u.__tauid]};b(t,i,u);t.__tamee[i][u.__tauid]=u}},u="ontouchstart"in document.documentElement||navigator.maxTouchPoints,e="onmousedown"in document.documentElement,n={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},d=function(){var n=-1,t,i;return navigator.appName=="Microsoft Internet Explorer"&&(t=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),i.exec(t)!=null&&(n=parseFloat(RegExp.$1))),n}(),ht=d>-1&&d<9,p=function(n,t){if(n==null)return[0,0];var r=g(n),i=at(r,0);return[i[t+"X"],i[t+"Y"]]},h=function(n){return n==null?[0,0]:ht?[n.clientX+document.documentElement.scrollLeft,n.clientY+document.documentElement.scrollTop]:p(n,"page")},ct=function(n){return p(n,"screen")},lt=function(n){return p(n,"client")},at=function(n,t){return n.item?n.item(t):n[t]},g=function(n){return n.touches&&n.touches.length>0?n.touches:n.changedTouches&&n.changedTouches.length>0?n.changedTouches:n.targetTouches&&n.targetTouches.length>0?n.targetTouches:[n]},vt=function(n){return g(n).length},c=function(n,t,i,r){if(b(n,t,i),r.__tauid=i.__tauid,n.addEventListener)n.addEventListener(t,i,!1);else if(n.attachEvent){var u=t+i.__tauid;n["e"+u]=i;n[u]=function(){n["e"+u]&&n["e"+u](window.event)};n.attachEvent("on"+t,n[u])}},l=function(t,i,r){r!=null&&a(t,function(){var f=o(this),e;ut(f,i,r);r.__tauid!=null&&(f.removeEventListener?(f.removeEventListener(i,r,!1),u&&n[i]&&f.removeEventListener(n[i],r,!1)):this.detachEvent&&(e=i+r.__tauid,f[e]&&f.detachEvent("on"+i,f[e]),f[e]=null,f["e"+e]=null));r.__taTouchProxy&&l(t,r.__taTouchProxy[1],r.__taTouchProxy[0])})},a=function(n,t){if(n!=null){n=typeof Window!="undefined"&&typeof n.top!="unknown"&&n==n.top?[n]:typeof n!="string"&&n.tagName==null&&n.length!=null?n:typeof n=="string"?document.querySelectorAll(n):[n];for(var i=0;i<n.length;i++)t.apply(n[i])}},yt=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)})};t.Mottle=function(t){t=t||{};var r=t.clickThreshold||250,f=t.dblClickThreshold||450,s=new st,c=new ot(r,f),v=t.smartClicks,y=function(n,t,r,u){r!=null&&a(n,function(){var n=o(this);v&&t==="click"?et(n,t,r,u):t==="tap"||t==="dbltap"||t==="contextmenu"?c(n,t,r,u):t==="mouseenter"||t=="mouseexit"?s(n,t,r,u):i(n,t,r,u)})};this.remove=function(n){return a(n,function(){var n=o(this),t,i;if(n.__ta)for(t in n.__ta)if(n.__ta.hasOwnProperty(t))for(i in n.__ta[t])n.__ta[t].hasOwnProperty(i)&&l(n,t,n.__ta[t][i]);n.parentNode&&n.parentNode.removeChild(n)}),this};this.on=function(){var n=arguments[0],t=arguments.length==4?arguments[2]:null,i=arguments[1],r=arguments[arguments.length-1];return y(n,i,r,t),this};this.off=function(n,t,i){return l(n,t,i),this};this.trigger=function(t,i,r,f){var y=e&&(typeof MouseEvent=="undefined"||r==null||r.constructor===MouseEvent),l=u&&!e&&n[i]?n[i]:i,p=!(u&&!e&&n[i]),v=h(r),s=ct(r),c=lt(r);return a(t,function(){var e=o(this),t,h,w,b,a;r=r||{screenX:s[0],screenY:s[1],clientX:c[0],clientY:c[1]};h=function(n){f&&(n.payload=f)};w={TouchEvent:function(n){var t=it(window,e,0,v[0],v[1],s[0],s[1],c[0],c[1]),i=n.initTouchEvent||n.initEvent;i(l,!0,!0,window,null,s[0],s[1],c[0],c[1],!1,!1,!1,!1,t,t,t,1,0)},MouseEvents:function(n){n.initMouseEvent(l,!0,!0,window,0,s[0],s[1],c[0],c[1],!1,!1,!1,!1,1,e)}};document.createEvent?(b=!p&&!y&&u&&n[i],a=b?"TouchEvent":"MouseEvents",t=document.createEvent(a),w[a](t),h(t),e.dispatchEvent(t)):document.createEventObject&&(t=document.createEventObject(),t.eventType=t.eventName=l,t.screenX=s[0],t.screenY=s[1],t.clientX=c[0],t.clientY=c[1],h(t),e.fireEvent("on"+l,t))}),this}};t.Mottle.consume=function(n,t){n.stopPropagation?n.stopPropagation():n.returnValue=!1;!t&&n.preventDefault&&n.preventDefault()};t.Mottle.pageLocation=h;t.Mottle.setForceTouchEvents=function(n){u=n};t.Mottle.setForceMouseEvents=function(n){e=n};t.Mottle.version="0.8.0";typeof exports!="undefined"&&(exports.Mottle=t.Mottle)}.call(typeof window=="undefined"?this:window),function(){"use strict";var o=this,l=function(n,t,i){return n.indexOf(t)===-1?(i?n.unshift(t):n.push(t),!0):!1},s=function(n,t){var i=n.indexOf(t);i!==-1&&n.splice(i,1)},tt=function(n,t){for(var r=[],i=0;i<n.length;i++)t.indexOf(n[i])===-1&&r.push(n[i]);return r},f=function(n){return n==null?!1:typeof n=="string"||n.constructor===String},it=function(n){var r=n.getBoundingClientRect(),t=document.body,i=document.documentElement,u=window.pageYOffset||i.scrollTop||t.scrollTop,f=window.pageXOffset||i.scrollLeft||t.scrollLeft,e=i.clientTop||t.clientTop||0,o=i.clientLeft||t.clientLeft||0,s=r.top+u-e,h=r.left+f-o;return{top:Math.round(s),left:Math.round(h)}},u=function(n,t,i){var u,r;for(i=i||n.parentNode,u=i.querySelectorAll(t),r=0;r<u.length;r++)if(u[r]===n)return!0;return!1},rt=function(n,t,i){if(u(t,i,n))return t;for(var r=t.parentNode;r!=null&&r!==n;){if(u(r,i,n))return r;r=r.parentNode}},ut=function(n,t,i){for(var e,s,f=null,o=t.getAttribute("katavorio-draggable"),h=o!=null?"[katavorio-draggable='"+o+"'] ":"",r=0;r<n.length;r++)if(f=rt(t,i,h+n[r].selector),f!=null)return n[r].filter&&(e=u(i,n[r].filter,f),s=n[r].filterExclude===!0,s&&!e||e)?null:[n[r],f];return null},h=function(){var n=-1,t,i;return navigator.appName==="Microsoft Internet Explorer"&&(t=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),i.exec(t)!=null&&(n=parseFloat(RegExp.$1))),n}(),a=10,v=10,ft=h>-1&&h<9,et=h===9,y=function(n){if(ft)return[n.clientX+document.documentElement.scrollLeft,n.clientY+document.documentElement.scrollTop];var i=st(n),t=ot(i,0);return et?[t.pageX||t.clientX,t.pageY||t.clientY]:[t.pageX,t.pageY]},ot=function(n,t){return n.item?n.item(t):n[t]},st=function(n){return n.touches&&n.touches.length>0?n.touches:n.changedTouches&&n.changedTouches.length>0?n.changedTouches:n.targetTouches&&n.targetTouches.length>0?n.targetTouches:[n]},e={delegatedDraggable:"katavorio-delegated-draggable",draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy",clonedDrag:"katavorio-clone-drag"},ht="katavorio-drag-scope",i=["stop","start","drag","drop","over","out","beforeStart"],ct=function(){},lt=function(){return!0},t=function(n,t,i){for(var r=0;r<n.length;r++)n[r]!=i&&t(n[r])},p=function(n,i,r,u){t(n,function(n){n.setActive(i);i&&n.updatePosition();r&&n.setHover(u,i)})},n=function(n,t){if(n!=null){n=!f(n)&&n.tagName==null&&n.length!=null?n:[n];for(var i=0;i<n.length;i++)t.apply(n[i],[n[i]])}},w=function(n){n.stopPropagation?(n.stopPropagation(),n.preventDefault()):n.returnValue=!1},at="input,textarea,select,button,option",vt=function(n,t,i){var r=n.srcElement||n.target;return!u(r,i.getInputFilterSelector(),t)},b=function(t,i,r,u){this.params=i||{};this.el=t;this.params.addClass(this.el,this._class);this.uuid=c();var f=!0;return this.setEnabled=function(n){f=n},this.isEnabled=function(){return f},this.toggleEnabled=function(){f=!f},this.setScope=function(n){this.scopes=n?n.split(/\s+/):[u]},this.addScope=function(t){var i={},r;n(this.scopes,function(n){i[n]=!0});n(t?t.split(/\s+/):[],function(n){i[n]=!0});this.scopes=[];for(r in i)this.scopes.push(r)},this.removeScope=function(t){var i={},r;n(this.scopes,function(n){i[n]=!0});n(t?t.split(/\s+/):[],function(n){delete i[n]});this.scopes=[];for(r in i)this.scopes.push(r)},this.toggleScope=function(t){var i={},r;n(this.scopes,function(n){i[n]=!0});n(t?t.split(/\s+/):[],function(n){i[n]?delete i[n]:i[n]=!0});this.scopes=[];for(r in i)this.scopes.push(r)},this.setScope(i.scope),this.k=i.katavorio,i.katavorio},k=function(){return!0},yt=function(){return!1},d=function(n,t,i){var d,gt,ft,ui,li,fi,ei,ai,ni,vi,o,tt,s,et,at;this._class=i.draggable;d=b.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;var g=[0,0],rt=null,ti=null,ii=[0,0],pt=!1,ri=[0,0],yi=this.params.consumeStartEvent!==!1,r=this.el,si=this.params.clone,ki=this.params.scroll,pi=t.multipleDrop!==!1,ot=!1,wt,hi,h=null,bt=[],l=null,ci=t.ghostProxyParent,kt,dt,ht,ct;wt=t.ghostProxy===!0?k:t.ghostProxy&&typeof t.ghostProxy=="function"?t.ghostProxy:function(n,t){return l&&l.useGhostProxy?l.useGhostProxy(n,t):!1};hi=t.makeGhostProxy?t.makeGhostProxy:function(n){return l&&l.makeGhostProxy?l.makeGhostProxy(n):n.cloneNode(!0)};t.selector&&(gt=n.getAttribute("katavorio-draggable"),gt==null&&(gt=""+(new Date).getTime(),n.setAttribute("katavorio-draggable",gt)),bt.push(t));ft=t.snapThreshold;ui=function(n,t,i,r,u){var h=Math.floor(n[0]/t),f=t*h,o=f+t,c=Math.abs(n[0]-f)<=r?f:Math.abs(o-n[0])<=r?o:n[0],l=Math.floor(n[1]/i),e=i*l,s=e+i,a=Math.abs(n[1]-e)<=u?e:Math.abs(s-n[1])<=u?s:n[1];return[c,a]};this.posses=[];this.posseRoles={};this.toGrid=function(n){if(this.params.grid==null)return n;var t=ft?ft:this.params.grid?this.params.grid[0]/2:a/2,i=ft?ft:this.params.grid?this.params.grid[1]/2:v/2;return ui(n,this.params.grid[0],this.params.grid[1],t,i)};this.snap=function(n,t){if(r!=null){n=n||(this.params.grid?this.params.grid[0]:a);t=t||(this.params.grid?this.params.grid[1]:v);var u=this.params.getPosition(r),f=this.params.grid?this.params.grid[0]/2:ft,e=this.params.grid?this.params.grid[1]/2:ft,i=ui(u,n,t,f,e);return this.params.setPosition(r,i),i}};this.setUseGhostProxy=function(n){wt=n?k:yt};fi=function(n){return t.allowNegative===!1?[Math.max(0,n[0]),Math.max(0,n[1])]:n};ei=function(n){li=typeof n=="function"?n:n?function(n,t,i,r){return fi([Math.max(0,Math.min(i.w-r[0],n[0])),Math.max(0,Math.min(i.h-r[1],n[1]))])}.bind(this):function(n){return fi(n)}}.bind(this);ei(typeof this.params.constrain=="function"?this.params.constrain:this.params.constrain||this.params.containment);this.setConstrain=function(n){ei(n)};ai=function(n,t,i,r){return l!=null&&l.constrain&&typeof l.constrain=="function"?l.constrain(n,t,i,r):li(n,t,i,r)};this.setRevert=function(n){ni=n};this.params.revert&&(ni=this.params.revert);var wi=function(n){return typeof n=="function"?(n._katavorioId=c(),n._katavorioId):n},st={},bi=function(n){var r,i,t;for(r in st)if(i=st[r],t=i[0](n),i[1]&&(t=!t),!t)return!1;return!0},oi=this.setFilter=function(t,i){if(t){var r=wi(t);st[r]=[function(i){var e=i.srcElement||i.target,r;return f(t)?r=u(e,t,n):typeof t=="function"&&(r=t(i,n)),r},i!==!1]}},di=this.addFilter=oi,gi=this.removeFilter=function(n){var t=typeof n=="function"?n._katavorioId:n;delete st[t]};this.clearAllFilters=function(){st={}};this.canDrag=this.params.canDrag||lt;o=[];tt=[];this.addSelector=function(n){n.selector&&bt.push(n)};this.downListener=function(n){var o,s,t,u,f;if(!n.defaultPrevented&&(o=this.rightButtonCanDrag||n.which!==3&&n.button!==2,o&&this.isEnabled()&&this.canDrag()))if(s=bi(n)&&vt(n,this.el,this.k),s){if(l=null,h=null,bt.length>0){if(t=ut(bt,this.el,n.target||n.srcElement),t!=null&&(l=t[0],h=t[1]),h==null)return}else h=this.el;si?(r=h.cloneNode(!0),this.params.addClass(r,e.clonedDrag),r.setAttribute("id",null),r.style.position="absolute",this.params.parent!=null?(u=this.params.getPosition(this.el),r.style.left=u[0]+"px",r.style.top=u[1]+"px",this.params.parent.appendChild(r)):(f=it(h),r.style.left=f.left+"px",r.style.top=f.top+"px",document.body.appendChild(r))):r=h;yi&&w(n);g=y(n);r&&r.parentNode&&(ri=[r.parentNode.scrollLeft,r.parentNode.scrollTop]);this.params.bind(document,"mousemove",this.moveListener);this.params.bind(document,"mouseup",this.upListener);d.markSelection(this);d.markPosses(this);this.params.addClass(document.body,i.noSelect);et("beforeStart",{el:this.el,pos:rt,e:n,drag:this})}else this.params.consumeFilteredEvents&&w(n)}.bind(this);this.moveListener=function(n){var u;if(g){if(!pt)if(u=et("start",{el:this.el,pos:rt,e:n,drag:this}),u!==!1){if(!g)return;this.mark(!0);pt=!0}else this.abort();if(g){tt.length=0;var f=y(n),t=f[0]-g[0],i=f[1]-g[1],e=this.params.ignoreZoom?1:d.getZoom();r&&r.parentNode&&(t+=r.parentNode.scrollLeft-ri[0],i+=r.parentNode.scrollTop-ri[1]);t/=e;i/=e;this.moveBy(t,i,n);d.updateSelection(t,i,this);d.updatePosses(t,i,this)}}}.bind(this);this.upListener=function(n){g&&(g=null,this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.params.removeClass(document.body,i.noSelect),this.unmark(n),d.unmarkSelection(this,n),d.unmarkPosses(this,n),this.stop(n),d.notifyPosseDragStop(this,n),pt=!1,tt.length=0,si?(r&&r.parentNode&&r.parentNode.removeChild(r),r=null):ni&&ni(r,this.params.getPosition(r))===!0&&(this.params.setPosition(r,rt),et("revert",r)))}.bind(this);this.getFilters=function(){return st};this.abort=function(){g!=null&&this.upListener()};this.getDragElement=function(n){return n?h||this.el:r||this.el};s={start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]};t.events.start&&s.start.push(t.events.start);t.events.beforeStart&&s.beforeStart.push(t.events.beforeStart);t.events.stop&&s.stop.push(t.events.stop);t.events.drag&&s.drag.push(t.events.drag);t.events.revert&&s.revert.push(t.events.revert);this.on=function(n,t){s[n]&&s[n].push(t)};this.off=function(n,t){var r,i;if(s[n]){for(r=[],i=0;i<s[n].length;i++)s[n][i]!==t&&r.push(s[n][i]);s[n]=r}};et=function(n,t){var r=null,i,u;if(l&&l[n])r=l[n](t);else if(s[n])for(i=0;i<s[n].length;i++)try{u=s[n][i](t);u!=null&&(r=u)}catch(f){}return r};this.notifyStart=function(n){et("start",{el:this.el,pos:this.params.getPosition(r),e:n,drag:this})};this.stop=function(n,t){var i,o;if(t||pt){var e=[],u=d.getSelection(),f=this.params.getPosition(r);if(u.length>0)for(i=0;i<u.length;i++)o=this.params.getPosition(u[i].el),e.push([u[i].el,{left:o[0],top:o[1]},u[i]]);else e.push([r,{left:f[0],top:f[1]},this]);et("stop",{el:r,pos:at||f,finalPos:f,e:n,drag:this,selection:e})}};this.mark=function(n){rt=this.params.getPosition(r);ti=this.params.getPosition(r,!0);ii=[ti[0]-rt[0],ti[1]-rt[1]];this.size=this.params.getSize(r);o=d.getMatchingDroppables(this);p(o,!0,!1,this);this.params.addClass(r,this.params.dragClass||i.drag);var t;t=this.params.getConstrainingRectangle?this.params.getConstrainingRectangle(r):this.params.getSize(r.parentNode);vi={w:t[0],h:t[1]};ht=0;ct=0;n&&d.notifySelectionDragStart(this)};this.unmark=function(n,u){var f,e;if(p(o,!1,!0,this),ot&&wt(h,r)?(at=[r.offsetLeft-ht,r.offsetTop-ct],r.parentNode.removeChild(r),r=h):at=null,this.params.removeClass(r,this.params.dragClass||i.drag),o.length=0,ot=!1,!u)for(tt.length>0&&at&&t.setPosition(h,at),tt.sort(nt),f=0;f<tt.length;f++)if(e=tt[f].drop(this,n),e===!0)break};this.moveBy=function(n,i,u){var c,s,l,f,y;tt.length=0;c=this.toGrid([rt[0]+n,rt[1]+i]);s=ai(c,r,vi,this.size);wt(this.el,r)&&(c[0]!==s[0]||c[1]!==s[1]?(ot||(l=hi(h),t.addClass(l,e.ghostProxy),ci?(ci.appendChild(l),kt=t.getPosition(h.parentNode,!0),dt=t.getPosition(t.ghostProxyParent,!0),ht=kt[0]-dt[0],ct=kt[1]-dt[1]):h.parentNode.appendChild(l),r=l,ot=!0),s=c):ot&&(r.parentNode.removeChild(r),r=h,ot=!1,kt=null,dt=null,ht=0,ct=0));var a={x:s[0],y:s[1],w:this.size[0],h:this.size[1]},p={x:a.x+ii[0],y:a.y+ii[1],w:a.w,h:a.h},v=null;for(this.params.setPosition(r,[s[0]+ht,s[1]+ct]),f=0;f<o.length;f++)y={x:o[f].pagePosition[0],y:o[f].pagePosition[1],w:o[f].size[0],h:o[f].size[1]},this.params.intersects(p,y)&&(pi||v==null||v===o[f].el)&&o[f].canDrop(this)?(v||(v=o[f].el),tt.push(o[f]),o[f].setHover(this,!0,u)):o[f].isHover()&&o[f].setHover(this,!1,u);et("drag",{el:this.el,pos:s,e:u,drag:this})};this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener);this.params.unbind(document,"mousemove",this.moveListener);this.params.unbind(document,"mouseup",this.upListener);this.downListener=null;this.upListener=null;this.moveListener=null};this.params.bind(this.el,"mousedown",this.downListener);this.params.handle?oi(this.params.handle,!1):oi(this.params.filter,this.params.filterExclude)},g=function(n,t,i){this._class=i.droppable;this.params=t||{};this.rank=t.rank||0;this._activeClass=this.params.activeClass||i.active;this._hoverClass=this.params.hoverClass||i.hover;b.apply(this,arguments);var r=!1;this.allowLoopback=this.params.allowLoopback!==!1;this.setActive=function(n){this.params[n?"addClass":"removeClass"](this.el,this._activeClass)};this.updatePosition=function(){this.position=this.params.getPosition(this.el);this.pagePosition=this.params.getPosition(this.el,!0);this.size=this.params.getSize(this.el)};this.canDrop=this.params.canDrop||function(){return!0};this.isHover=function(){return r};this.setHover=function(n,t,i){(t||this.el._katavorioDragHover==null||this.el._katavorioDragHover===n.el._katavorio)&&(this.params[t?"addClass":"removeClass"](this.el,this._hoverClass),this.el._katavorioDragHover=t?n.el._katavorio:null,r!==t&&this.params.events[t?"over":"out"]({el:this.el,e:i,drag:n,drop:this}),r=t)};this.drop=function(n,t){return this.params.events.drop({drag:n,e:t,drop:this})};this.destroy=function(){this._class=null;this._activeClass=null;this._hoverClass=null;r=null}},c=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n==="x"?t:t&3|8;return i.toString(16)})},nt=function(n,t){return n.rank<t.rank?1:n.rank>t.rank?-1:0},r=function(n){return n==null?null:(n=typeof n=="string"||n.constructor===String?document.getElementById(n):n,n==null)?null:(n._katavorio=n._katavorio||c(),n)};o.Katavorio=function(u){var o=[],a={},v,w,b,y,k,it,h,rt;this._dragsByScope={};this._dropsByScope={};var ut=1,p=function(t,i){n(t,function(n){for(var t=0;t<n.scopes.length;t++)i[n.scopes[t]]=i[n.scopes[t]]||[],i[n.scopes[t]].push(n)})},ft=function(t,i){var r=0;return n(t,function(n){for(var f,t=0;t<n.scopes.length;t++)i[n.scopes[t]]&&(f=u.indexOf(i[n.scopes[t]],n),f!==-1&&(i[n.scopes[t]].splice(f,1),r++))}),r>0},vt=this.getMatchingDroppables=function(n){for(var t,i,r=[],f={},u=0;u<n.scopes.length;u++)if(t=this._dropsByScope[n.scopes[u]],t)for(i=0;i<t.length;i++)t[i].canDrop(n)&&!f[t[i].uuid]&&(t[i].allowLoopback||t[i].el!==n.el)&&(f[t[i].uuid]=!0,r.push(t[i]));return r.sort(nt),r},et=function(n){n=n||{};var r={events:{}};for(var t in u)r[t]=u[t];for(t in n)r[t]=n[t];for(t=0;t<i.length;t++)r.events[i[t]]=n[i[t]]||ct;return r.katavorio=this,r}.bind(this),lt=function(n,t){for(var r=0;r<i.length;r++)if(t[i[r]])n.on(i[r],t[i[r]])}.bind(this),c={},ot=u.css||{},st=u.scope||ht;for(v in e)c[v]=e[v];for(v in ot)c[v]=ot[v];w=u.inputFilterSelector||at;this.getInputFilterSelector=function(){return w};this.setInputFilterSelector=function(n){return w=n,this};this.draggable=function(t,i){var f=[];return n(t,function(n){if(n=r(n),n!=null)if(n._katavorioDrag==null){var t=et(i);n._katavorioDrag=new d(n,t,c,st);p(n._katavorioDrag,this._dragsByScope);f.push(n._katavorioDrag);u.addClass(n,t.selector?c.delegatedDraggable:c.draggable)}else lt(n._katavorioDrag,i)}.bind(this)),f};this.droppable=function(t,i){var f=[];return n(t,function(n){if(n=r(n),n!=null){var t=new g(n,et(i),c,st);n._katavorioDrop=n._katavorioDrop||[];n._katavorioDrop.push(t);p(t,this._dropsByScope);f.push(t);u.addClass(n,c.droppable)}}.bind(this)),f};this.select=function(t){return n(t,function(){var n=r(this);n&&n._katavorioDrag&&(a[n._katavorio]||(o.push(n._katavorioDrag),a[n._katavorio]=[n,o.length-1],u.addClass(n,c.selected)))}),this};this.deselect=function(t){return n(t,function(){var n=r(this),f,i,t;if(n&&n._katavorio&&(f=a[n._katavorio],f)){for(i=[],t=0;t<o.length;t++)o[t].el!==n&&i.push(o[t]);o=i;delete a[n._katavorio];u.removeClass(n,c.selected)}}),this};this.deselectAll=function(){var n,t;for(n in a)t=a[n],u.removeClass(t[0],c.selected);o.length=0;a={}};this.markSelection=function(n){t(o,function(n){n.mark()},n)};this.markPosses=function(i){i.posses&&n(i.posses,function(n){i.posseRoles[n]&&h[n]&&t(h[n].members,function(n){n.mark()},i)})};this.unmarkSelection=function(n,i){t(o,function(n){n.unmark(i)},n)};this.unmarkPosses=function(i,r){i.posses&&n(i.posses,function(n){i.posseRoles[n]&&h[n]&&t(h[n].members,function(n){n.unmark(r,!0)},i)})};this.getSelection=function(){return o.slice(0)};this.updateSelection=function(n,i,r){t(o,function(t){t.moveBy(n,i)},r)};b=function(i,r){r.posses&&n(r.posses,function(n){r.posseRoles[n]&&h[n]&&t(h[n].members,function(n){i(n)},r)})};this.updatePosses=function(n,t,i){b(function(i){i.moveBy(n,t)},i)};this.notifyPosseDragStop=function(n,t){b(function(n){n.stop(t,!0)},n)};this.notifySelectionDragStop=function(n,i){t(o,function(n){n.stop(i,!0)},n)};this.notifySelectionDragStart=function(n,i){t(o,function(n){n.notifyStart(i)},n)};this.setZoom=function(n){ut=n};this.getZoom=function(){return ut};y=function(t,i,r,u){n(t,function(n){ft(n,r);n[u](i);p(n,r)})};n(["set","add","remove","toggle"],function(n){this[n+"Scope"]=function(t,i){y(t._katavorioDrag,i,this._dragsByScope,n+"Scope");y(t._katavorioDrop,i,this._dropsByScope,n+"Scope")}.bind(this);this[n+"DragScope"]=function(t,i){y(t.constructor===d?t:t._katavorioDrag,i,this._dragsByScope,n+"Scope")}.bind(this);this[n+"DropScope"]=function(t,i){y(t.constructor===g?t:t._katavorioDrop,i,this._dropsByScope,n+"Scope")}.bind(this)}.bind(this));this.snapToGrid=function(n,i){for(var r in this._dragsByScope)t(this._dragsByScope[r],function(t){t.snap(n,i)})};this.getDragsForScope=function(n){return this._dragsByScope[n]};this.getDropsForScope=function(n){return this._dropsByScope[n]};k=function(t,i,u){if(t=r(t),t[i]){var f=o.indexOf(t[i]);f>=0&&o.splice(f,1);ft(t[i],u)&&n(t[i],function(n){n.destroy()});delete t[i]}};it=function(n,t,i,u){n=r(n);n[t]&&n[t].off(i,u)};this.elementRemoved=function(n){n._katavorioDrag&&this.destroyDraggable(n);n._katavorioDrop&&this.destroyDroppable(n)};this.destroyDraggable=function(n,t,i){arguments.length===1?k(n,"_katavorioDrag",this._dragsByScope):it(n,"_katavorioDrag",t,i)};this.destroyDroppable=function(n,t,i){arguments.length===1?k(n,"_katavorioDrop",this._dropsByScope):it(n,"_katavorioDrop",t,i)};this.reset=function(){this._dragsByScope={};this._dropsByScope={};o=[];a={};h={}};h={};rt=function(t,i,r){var e=f(i)?i:i.id,o=f(i)?!0:i.active!==!1,u=h[e]||function(){var n={name:e,members:[]};return h[e]=n,n}();return n(t,function(n){if(n._katavorioDrag){if(r&&n._katavorioDrag.posseRoles[u.name]!=null)return;l(u.members,n._katavorioDrag);l(n._katavorioDrag.posses,u.name);n._katavorioDrag.posseRoles[u.name]=o}}),u};this.addToPosse=function(n){for(var t=[],i=1;i<arguments.length;i++)t.push(rt(n,arguments[i]));return t.length===1?t[0]:t};this.setPosse=function(t){for(var i=[],r=1;r<arguments.length;r++)i.push(rt(t,arguments[r],!0).name);return n(t,function(n){var r,u,t;if(n._katavorioDrag)for(r=tt(n._katavorioDrag.posses,i),u=[],Array.prototype.push.apply(u,n._katavorioDrag.posses),t=0;t<r.length;t++)this.removeFromPosse(n,r[t])}.bind(this)),i.length===1?i[0]:i};this.removeFromPosse=function(t,i){if(arguments.length<2)throw new TypeError("No posse id provided for remove operation");for(var r=1;r<arguments.length;r++)i=arguments[r],n(t,function(t){if(t._katavorioDrag&&t._katavorioDrag.posses){var r=t._katavorioDrag;n(i,function(n){s(h[n].members,r);s(r.posses,n);delete r.posseRoles[n]})}})};this.removeFromAllPosses=function(t){n(t,function(t){if(t._katavorioDrag&&t._katavorioDrag.posses){var i=t._katavorioDrag;n(i.posses,function(n){s(h[n].members,i)});i.posses.length=0;i.posseRoles={}}})};this.setPosseState=function(t,i,r){var u=h[i];u&&n(t,function(n){n._katavorioDrag&&n._katavorioDrag.posses&&(n._katavorioDrag.posseRoles[u.name]=r)})}};o.Katavorio.version="1.0.0";typeof exports!="undefined"&&(exports.Katavorio=o.Katavorio)}.call(typeof window!="undefined"?window:this),function(){function i(n){return Object.prototype.toString.call(n)==="[object Array]"}function d(n){return Object.prototype.toString.call(n)==="[object Number]"}function e(n){return typeof n=="string"}function o(n){return typeof n=="boolean"}function g(n){return n==null}function u(n){return n==null?!1:Object.prototype.toString.call(n)==="[object Object]"}function v(n){return Object.prototype.toString.call(n)==="[object Date]"}function s(n){return Object.prototype.toString.call(n)==="[object Function]"}function nt(n){return s(n)&&n.name!=null&&n.name.length>0}function tt(n){for(var t in n)if(n.hasOwnProperty(t))return!1;return!0}function h(n){var r,t,f,c;if(e(n))return""+n;if(o(n))return!!n;if(v(n))return new Date(n.getTime());if(s(n))return n;if(i(n)){for(r=[],t=0;t<n.length;t++)r.push(h(n[t]));return r}if(u(n)){f={};for(c in n)f[c]=h(n[c]);return f}return n}function y(n,t,r,f){var v={},l,s,y={},c,a;for(r=r||[],f=f||[],s=0;s<r.length;s++)v[r[s]]=!0;for(s=0;s<f.length;s++)y[f[s]]=!0;c=h(n);for(s in t)if(c[s]==null||y[s])c[s]=t[s];else if(e(t[s])||o(t[s]))v[s]?(l=[],l.push.apply(l,i(c[s])?c[s]:[c[s]]),l.push.apply(l,o(t[s])?t[s]:[t[s]]),c[s]=l):c[s]=t[s];else if(i(t[s]))l=[],i(c[s])&&l.push.apply(l,c[s]),l.push.apply(l,t[s]),c[s]=l;else if(u(t[s])){u(c[s])||(c[s]={});for(a in t[s])c[s][a]=t[s][a]}return c}function it(n,t,i){if(n!=null){var u=n,r=u;return t.replace(/([^\.])+/g,function(n,t,u,f){var e=n.match(/([^\[0-9]+){1}(\[)([0-9+])/),h=u+n.length>=f.length,s=function(){return r[e[1]]||function(){return r[e[1]]=[],r[e[1]]}()},o;return h?e?s()[e[3]]=i:r[n]=i:e?(o=s(),r=o[e[3]]||function(){return o[e[3]]={},o[e[3]]}()):r=r[n]||function(){return r[n]={},r[n]}(),""}),n}}function rt(n,t,i){for(var u,r=0;r<i.length;r++)if(u=i[r][0][i[r][1]].apply(i[r][0],i[r][2]),u===t)return u;return n}function ut(n,t,r,f){var h=function(n){var r=n.match(/(\${.*?})/g),i,u;if(r!=null)for(i=0;i<r.length;i++)u=t[r[i].substring(2,r[i].length-1)]||"",u!=null&&(n=n.replace(r[i],u));return n},o=function(n){var l,c,a,v;if(n!=null){if(e(n))return h(n);if(s(n)&&!f&&(r==null||(n.name||"").indexOf(r)===0))return n(t);if(i(n)){for(l=[],c=0;c<n.length;c++)l.push(o(n[c]));return l}if(u(n)){a={};for(v in n)a[v]=o(n[v]);return a}return n}};return o(n)}function l(n,t){if(n)for(var i=0;i<n.length;i++)if(t(n[i]))return i;return-1}function ft(n,t){var i=l(n,t);return i>-1&&n.splice(i,1),i!==-1}function a(n,t){var i=n.indexOf(t);return i>-1&&n.splice(i,1),i!==-1}function et(n,t,i){l(n,i)===-1&&n.push(t)}function p(n,t,i,r){var u=n[t];return u==null&&(u=[],n[t]=u),u[r?"unshift":"push"](i),u}function ot(n,t,i){return n.indexOf(t)===-1?(i?n.unshift(t):n.push(t),!0):!1}function st(n,t){var r,f,u,e,o;for(t=i(t)?t:[t],f=function(t){for(var i=t.__proto__,r;i!=null;)if(i.prototype!=null){for(r in i.prototype)i.prototype.hasOwnProperty(r)&&!n.prototype.hasOwnProperty(r)&&(n.prototype[r]=i.prototype[r]);i=i.prototype.__proto__}else i=null},r=0;r<t.length;r++){for(u in t[r].prototype)t[r].prototype.hasOwnProperty(u)&&!n.prototype.hasOwnProperty(u)&&(n.prototype[u]=t[r].prototype[u]);f(t[r])}if(e=function(n,i){return function(){for(r=0;r<t.length;r++)t[r].prototype[n]&&t[r].prototype[n].apply(this,arguments);return i.apply(this,arguments)}},o=function(t){for(var i in t)n.prototype[i]=e(i,t[i])},arguments.length>2)for(r=2;r<arguments.length;r++)o(arguments[r]);return n}function w(){var n=Math.random()*4294967295|0,i=Math.random()*4294967295|0,r=Math.random()*4294967295|0,u=Math.random()*4294967295|0;return t[n&255]+t[n>>8&255]+t[n>>16&255]+t[n>>24&255]+"-"+t[i&255]+t[i>>8&255]+"-"+t[i>>16&15|64]+t[i>>24&255]+"-"+t[r&63|128]+t[r>>8&255]+"-"+t[r>>16&255]+t[r>>24&255]+t[u&255]+t[u>>8&255]+t[u>>16&255]+t[u>>24&255]}function ht(n){if(n==null)return null;for(var t=n.replace(/^\s\s*/,""),i=t.length;/\s/.test(t.charAt(--i)););return t.slice(0,i+1)}function ct(n,t){n=n.length==null||typeof n=="string"?[n]:n;for(var i=0;i<n.length;i++)t(n[i])}function lt(n,t){for(var r=[],i=0;i<n.length;i++)r.push(t(n[i]));return r}function at(n,t,i){i=i||"parent";var u=function(n){return n?t[n]:null},f=function(n){return n?u(n[i]):null},e=function(n,t){var i,r;return n==null?t:(i=["anchor","anchors","cssClass","connector","paintStyle","hoverPaintStyle","endpoint","endpoints"],t.mergeStrategy==="override"&&Array.prototype.push.apply(i,["events","overlays"]),r=y(n,t,[],i),e(f(n),r))},o=function(n){if(n==null)return{};if(typeof n=="string")return u(n);if(n.length){for(var r=!1,t=0,i=void 0;!r&&t<n.length;)i=o(n[t]),i?r=!0:t++;return i}},r=o(n);return r?e(f(r),r):{}}function f(){for(var i,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];if(n.logEnabled&&typeof console!="undefined")try{i=arguments[arguments.length-1];console.log(i)}catch(u){}}function vt(n,t,i){return function(){var r=null;try{t!=null&&(r=t.apply(this,arguments))}catch(u){f("jsPlumb function failed : "+u)}if(n!=null&&(i==null||r!==i))try{r=n.apply(this,arguments)}catch(u){f("wrapped function failed : "+u)}return r}}function k(n,t,i){var r=[n[0]-t[0],n[1]-t[1]],u=Math.cos(i/360*Math.PI*2),f=Math.sin(i/360*Math.PI*2);return[r[0]*u-r[1]*f+t[0],r[1]*u+r[0]*f+t[1],u,f]}function yt(n,t){var i=k(n,[0,0],t);return[Math.round(i[0]),Math.round(i[1])]}var c=this,n,t,r,b;for(c.jsPlumbUtil=c.jsPlumbUtil||{},n=c.jsPlumbUtil,typeof exports!="undefined"&&(exports.jsPlumbUtil=n),n.isArray=i,n.isNumber=d,n.isString=e,n.isBoolean=o,n.isNull=g,n.isObject=u,n.isDate=v,n.isFunction=s,n.isNamedFunction=nt,n.isEmpty=tt,n.clone=h,n.merge=y,n.replace=it,n.functionChain=rt,n.populate=ut,n.findWithFunction=l,n.removeWithFunction=ft,n.remove=a,n.addWithFunction=et,n.addToList=p,n.suggest=ot,n.extend=st,t=[],r=0;r<256;r++)t[r]=(r<16?"0":"")+r.toString(16);n.uuid=w;n.fastTrim=ht;n.each=ct;n.map=lt;n.mergeWithParents=at;n.logEnabled=!0;n.log=f;n.wrap=vt;b=function(){function n(){var n=this;this._listeners={};this.eventsSuspended=!1;this.tick=!1;this.eventsToDieOn={ready:!0};this.queue=[];this.bind=function(t,i,r){var f=function(t){p(n._listeners,t,i,r);i.__jsPlumb=i.__jsPlumb||{};i.__jsPlumb[w()]=t},u;if(typeof t=="string")f(t);else if(t.length!=null)for(u=0;u<t.length;u++)f(t[u]);return n};this.fire=function(n,t,i){if(this.tick)this.queue.unshift(arguments);else{if(this.tick=!0,!this.eventsSuspended&&this._listeners[n]){var o=this._listeners[n].length,r=0,u=!1,e=null;if(!this.shouldFireEvent||this.shouldFireEvent(n,t,i))while(!u&&r<o&&e!==!1){if(this.eventsToDieOn[n])this._listeners[n][r].apply(this,[t,i]);else try{e=this._listeners[n][r].apply(this,[t,i])}catch(s){f("jsPlumb: fire failed for event "+n+" : "+s)}r++;(this._listeners==null||this._listeners[n]==null)&&(u=!0)}}this.tick=!1;this._drain()}return this};this._drain=function(){var t=n.queue.pop();t&&n.fire.apply(n,t)};this.unbind=function(n,t){var i,r;if(arguments.length===0)this._listeners={};else if(arguments.length===1){if(typeof n=="string")delete this._listeners[n];else if(n.__jsPlumb){i=void 0;for(r in n.__jsPlumb)i=n.__jsPlumb[r],a(this._listeners[i]||[],n)}}else arguments.length===2&&a(this._listeners[n]||[],t);return this};this.getListener=function(t){return n._listeners[t]};this.setSuspendEvents=function(t){n.eventsSuspended=t};this.isSuspendEvents=function(){return n.eventsSuspended};this.silently=function(t){n.setSuspendEvents(!0);try{t()}catch(i){f("Cannot execute silent function "+i)}n.setSuspendEvents(!1)};this.cleanupListeners=function(){for(var t in n._listeners)n._listeners[t]=null}}return n}();n.EventGenerator=b;n.rotatePoint=k;n.rotateAnchorOrientation=yt}.call(typeof window!="undefined"?window:this),function(){"use strict";var n=this;n.jsPlumbUtil.matchesSelector=function(n,t,i){var u,r;for(i=i||n.parentNode,u=i.querySelectorAll(t),r=0;r<u.length;r++)if(u[r]===n)return!0;return!1};n.jsPlumbUtil.consume=function(n,t){n.stopPropagation?n.stopPropagation():n.returnValue=!1;!t&&n.preventDefault&&n.preventDefault()};n.jsPlumbUtil.sizeElement=function(n,t,i,r,u){n&&(n.style.height=u+"px",n.height=u,n.style.width=r+"px",n.width=r,n.style.left=t+"px",n.style.top=i+"px")}}.call(typeof window!="undefined"?window:this),function(){var i={deriveAnchor:function(n,t){return{top:["TopRight","TopLeft"],bottom:["BottomRight","BottomLeft"]}[n][t]}},r=this,n=function(n,t){this.count=0;this.instance=n;this.lists={};this.options=t||{};this.instance.addList=function(n,t){return this.listManager.addList(n,t)};this.instance.removeList=function(n){this.listManager.removeList(n)};this.instance.bind("manageElement",function(n){for(var i=this.instance.getSelector(n.el,"[jtk-scrollable-list]"),t=0;t<i.length;t++)this.addList(i[t])}.bind(this));this.instance.bind("unmanageElement",function(n){this.removeList(n.el)});this.instance.bind("connection",function(n,t){t==null&&(this._maybeUpdateParentList(n.source),this._maybeUpdateParentList(n.target))}.bind(this))},t;r.jsPlumbListManager=n;n.prototype={addList:function(n,r){var f=this.instance.extend({},i),u;this.instance.extend(f,this.options);r=this.instance.extend(f,r||{});u=[this.instance.getInstanceIndex(),this.count++].join("_");this.lists[u]=new t(this.instance,n,r,u)},removeList:function(n){var t=this.lists[n._jsPlumbList];t&&(t.destroy(),delete this.lists[n._jsPlumbList])},_maybeUpdateParentList:function(n){for(var t=n.parentNode,i=this.instance.getContainer();t!=null&&t!==i;){if(t._jsPlumbList!=null&&this.lists[t._jsPlumbList]!=null){t._jsPlumbScrollHandler();return}t=t.parentNode}}};t=function(n,t,i,r){function u(n,t,r,u){return i.anchor?i.anchor:i.deriveAnchor(n,t,r,u)}function f(n,t,r,u){return i.deriveEndpoint?i.deriveEndpoint(n,t,r,u):i.endpoint?i.endpoint:r.type}function o(t){for(var i=t.parentNode,r=n.getContainer();i!=null&&i!==r;){if(n.hasClass(i,"jtk-managed")){n.recalculateOffsets(i);return}i=i.parentNode}}t._jsPlumbList=r;var e=function(){for(var s,r=n.getSelector(t,".jtk-managed"),e=n.getId(t),i=0;i<r.length;i++){if(r[i].offsetTop<t.scrollTop)r[i]._jsPlumbProxies||(r[i]._jsPlumbProxies=r[i]._jsPlumbProxies||[],n.select({source:r[i]}).each(function(o){n.proxyConnection(o,0,t,e,function(){return f("top",0,o.endpoints[0],o)},function(){return u("top",0,o.endpoints[0],o)});r[i]._jsPlumbProxies.push([o,0])}),n.select({target:r[i]}).each(function(o){n.proxyConnection(o,1,t,e,function(){return f("top",1,o.endpoints[1],o)},function(){return u("top",1,o.endpoints[1],o)});r[i]._jsPlumbProxies.push([o,1])}));else if(r[i].offsetTop+r[i].offsetHeight>t.scrollTop+t.offsetHeight)r[i]._jsPlumbProxies||(r[i]._jsPlumbProxies=r[i]._jsPlumbProxies||[],n.select({source:r[i]}).each(function(o){n.proxyConnection(o,0,t,e,function(){return f("bottom",0,o.endpoints[0],o)},function(){return u("bottom",0,o.endpoints[0],o)});r[i]._jsPlumbProxies.push([o,0])}),n.select({target:r[i]}).each(function(o){n.proxyConnection(o,1,t,e,function(){return f("bottom",1,o.endpoints[1],o)},function(){return u("bottom",1,o.endpoints[1],o)});r[i]._jsPlumbProxies.push([o,1])}));else if(r[i]._jsPlumbProxies){for(s=0;s<r[i]._jsPlumbProxies.length;s++)n.unproxyConnection(r[i]._jsPlumbProxies[s][0],r[i]._jsPlumbProxies[s][1],e);delete r[i]._jsPlumbProxies}n.revalidate(r[i])}o(t)};n.setAttribute(t,"jtk-scrollable-list","true");t._jsPlumbScrollHandler=e;n.on(t,"scroll",e);e();this.destroy=function(){var r,f,i,u;for(n.off(t,"scroll",e),delete t._jsPlumbScrollHandler,r=n.getSelector(t,".jtk-managed"),f=n.getId(t),i=0;i<r.length;i++)if(r[i]._jsPlumbProxies){for(u=0;u<r[i]._jsPlumbProxies.length;u++)n.unproxyConnection(r[i]._jsPlumbProxies[u][0],r[i]._jsPlumbProxies[u][1],f);delete r[i]._jsPlumbProxies}}}}.call(typeof window!="undefined"?window:this),function(){"use strict";var t=this,n=t.jsPlumbUtil,e=function(n){if(n._jsPlumb.paintStyle&&n._jsPlumb.hoverPaintStyle){var t={};i.extend(t,n._jsPlumb.paintStyle);i.extend(t,n._jsPlumb.hoverPaintStyle);delete n._jsPlumb.hoverPaintStyle;t.gradient&&n._jsPlumb.paintStyle.fill&&delete t.gradient;n._jsPlumb.hoverPaintStyle=t}},o=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],a=function(n,t,i,r){var f=n.getAttachedElements(),u,e;if(f)for(u=0,e=f.length;u<e;u++)r&&r===f[u]||f[u].setHover(t,!0,i)},u=function(n){return n==null?null:n.split(" ")},s=function(n,t,i){for(var r in t)n[r]=i},y=function(t,i){i=n.isArray(i)||i.length!=null&&!n.isString(i)?i:[i];for(var r=0;r<i.length;r++)try{t.apply(i[r],[i[r]])}catch(u){n.log(".each iteration failed : "+u)}},r=function(t,i,r){var e,v,o,f,c,l;if(t.getDefaultType){var y=t.getTypeDescriptor(),h={},a=t.getDefaultType(),u=n.merge({},a);for(s(h,a,"__default"),e=0,v=t._jsPlumb.types.length;e<v;e++)o=t._jsPlumb.types[e],o!=="__default"&&(f=t._jsPlumb.instance.getType(o,y),f!=null&&(c=["anchor","anchors","connector","paintStyle","hoverPaintStyle","endpoint","endpoints","connectorOverlays","connectorStyle","connectorHoverStyle","endpointStyle","endpointHoverStyle"],l=[],f.mergeStrategy==="override"?Array.prototype.push.apply(c,["events","overlays","cssClass"]):l.push("cssClass"),u=n.merge(u,f,l,c),s(h,f,o)));i&&(u=n.populate(u,i,"_"));t.applyType(u,r,h);r||t.repaint()}},h=t.jsPlumbUIComponent=function(t){var u,f,r,e,o,s,h;n.EventGenerator.apply(this,arguments);var c=this,l=arguments,a=c.idPrefix,v=a+(new Date).getTime();if(this._jsPlumb={instance:t._jsPlumb,parameters:t.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:t.beforeDetach,beforeDrop:t.beforeDrop,overlayPlacements:[],hoverClass:t.hoverClass||t._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}},this.cacheTypeItem=function(n,t,i){this._jsPlumb.typeCache[i]=this._jsPlumb.typeCache[i]||{};this._jsPlumb.typeCache[i][n]=t},this.getCachedTypeItem=function(n,t){return this._jsPlumb.typeCache[t]?this._jsPlumb.typeCache[t][n]:null},this.getId=function(){return v},u=t.overlays||[],f={},this.defaultOverlayKeys){for(r=0;r<this.defaultOverlayKeys.length;r++)Array.prototype.push.apply(u,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[r]]||[]);for(r=0;r<u.length;r++)e=i.convertToFullOverlaySpec(u[r]),f[e[1].id]=e}if(o={overlays:f,parameters:t.parameters||{},scope:t.scope||this._jsPlumb.instance.getDefaultScope()},this.getDefaultType=function(){return o},this.appendToDefaultType=function(n){for(var t in n)o[t]=n[t]},t.events)for(s in t.events)c.bind(s,t.events[s]);this.clone=function(){var n=Object.create(this.constructor.prototype);return this.constructor.apply(n,l),n}.bind(this);this.isDetachAllowed=function(t){var i=!0;if(this._jsPlumb.beforeDetach)try{i=this._jsPlumb.beforeDetach(t)}catch(r){n.log("jsPlumb: beforeDetach callback failed",r)}return i};this.isDropAllowed=function(t,i,r,u,f,e,o){var s=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:t,targetId:i,scope:r,connection:u,dropEndpoint:f,source:e,target:o});if(this._jsPlumb.beforeDrop)try{s=this._jsPlumb.beforeDrop({sourceId:t,targetId:i,scope:r,connection:u,dropEndpoint:f,source:e,target:o})}catch(h){n.log("jsPlumb: beforeDrop callback failed",h)}return s};h=[];this.setListenerComponent=function(n){for(var t=0;t<h.length;t++)h[t][3]=n}},f=function(n,t){var r=n._jsPlumb.types[t],i=n._jsPlumb.instance.getType(r,n.getTypeDescriptor());i!=null&&i.cssClass&&n.canvas&&n._jsPlumb.instance.removeClass(n.canvas,i.cssClass)},i;n.extend(t.jsPlumbUIComponent,n.EventGenerator,{getParameter:function(n){return this._jsPlumb.parameters[n]},setParameter:function(n,t){this._jsPlumb.parameters[n]=t},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(n){this._jsPlumb.parameters=n},getClass:function(){return i.getClass(this.canvas)},hasClass:function(n){return i.hasClass(this.canvas,n)},addClass:function(n){i.addClass(this.canvas,n)},removeClass:function(n){i.removeClass(this.canvas,n)},updateClasses:function(n,t){i.updateClasses(this.canvas,n,t)},setType:function(n,t,i){this.clearTypes();this._jsPlumb.types=u(n)||[];r(this,t,i)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(n,t){r(this,n,t)},hasType:function(n){return this._jsPlumb.types.indexOf(n)!==-1},addType:function(n,t,i){var e=u(n),o=!1,f,s;if(e!=null){for(f=0,s=e.length;f<s;f++)this.hasType(e[f])||(this._jsPlumb.types.push(e[f]),o=!0);o&&r(this,t,i)}},removeType:function(n,t,i){var o=u(n),s=!1,c=function(n){var t=this._jsPlumb.types.indexOf(n);return t!==-1?(f(this,t),this._jsPlumb.types.splice(t,1),!0):!1}.bind(this),e,h;if(o!=null){for(e=0,h=o.length;e<h;e++)s=c(o[e])||s;s&&r(this,t,i)}},clearTypes:function(n,t){for(var u=this._jsPlumb.types.length,i=0;i<u;i++)f(this,0),this._jsPlumb.types.splice(0,1);r(this,n,t)},toggleType:function(n,t,i){var o=u(n),e,h,s;if(o!=null){for(e=0,h=o.length;e<h;e++)s=this._jsPlumb.types.indexOf(o[e]),s!==-1?(f(this,s),this._jsPlumb.types.splice(s,1)):this._jsPlumb.types.push(o[e]);r(this,t,i)}},applyType:function(n,t){if(this.setPaintStyle(n.paintStyle,t),this.setHoverPaintStyle(n.hoverPaintStyle,t),n.parameters)for(var i in n.parameters)this.setParameter(i,n.parameters[i]);this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(n,t){this._jsPlumb.paintStyle=n;this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle;e(this);t||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(n,t){this._jsPlumb.hoverPaintStyle=n;e(this);t||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(n){(n||this.typeId==null)&&(this.cleanupListeners(),this.clone=null,this._jsPlumb=null)},isHover:function(){return this._jsPlumb.hover},setHover:function(n,t,i){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=n;var r=n?"addClass":"removeClass";this.canvas!=null&&(this._jsPlumb.instance.hoverClass!=null&&this._jsPlumb.instance[r](this.canvas,this._jsPlumb.instance.hoverClass),this._jsPlumb.hoverClass!=null&&this._jsPlumb.instance[r](this.canvas,this._jsPlumb.hoverClass));this._jsPlumb.hoverPaintStyle!=null&&(this._jsPlumb.paintStyleInUse=n?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(i=i||jsPlumbUtil.uuid(),this.repaint({timestamp:i,recalc:!1})));this.getAttachedElements&&!t&&a(this,n,jsPlumbUtil.uuid(),this)}}});var c=0,v=function(){var n=c+1;return c++,n},l=t.jsPlumbInstance=function(r){var wt,l,w,pi,ni,ct,wi,vt,tt,di,ii,pt,ri,et,ot,gi,ui,fi,ei;this.version="2.15.6";this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fill:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},ListStyle:{},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{"stroke-width":4,stroke:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"};r&&i.extend(this.Defaults,r);this.logEnabled=this.Defaults.LogEnabled;this._connectionTypes={};this._endpointTypes={};n.EventGenerator.apply(this);var u=this,oi=v(),nr=u.bind,si={},st=1,c=function(t){if(t==null)return null;if(t.nodeType===3||t.nodeType===8)return{el:t,text:!0};var i=u.getElement(t);return{el:i,id:n.isString(t)&&i==null?t:y(i)}};this.getInstanceIndex=function(){return oi};this.setZoom=function(n,t){return st=n,u.fire("zoom",st),t&&u.repaintEverything(),!0};this.getZoom=function(){return st};for(wt in this.Defaults)si[wt]=this.Defaults[wt];w=[];this.unbindContainer=function(){if(l!=null&&w.length>0)for(var n=0;n<w.length;n++)u.off(l,w[n][0],w[n][1])};this.setContainer=function(n){var r,t,h,i;this.unbindContainer();n=this.getElement(n);this.select().each(function(t){t.moveParent(n)});this.selectEndpoints().each(function(t){t.moveParent(n)});r=l;l=n;w.length=0;var c={endpointclick:"endpointClick",endpointdblclick:"endpointDblClick"},f=function(n,t,i){var r=t.srcElement||t.target,f=(r&&r.parentNode?r.parentNode._jsPlumb:null)||(r?r._jsPlumb:null)||(r&&r.parentNode&&r.parentNode.parentNode?r.parentNode.parentNode._jsPlumb:null),e;f&&(f.fire(n,f,t),e=i?c[i+n]||n:n,u.fire(e,f.component||f,t))},s=function(n,t,i){w.push([n,i]);u.on(l,n,t,i)},a=function(n){s(n,".jtk-connector",function(t){f(n,t)});s(n,".jtk-endpoint",function(t){f(n,t,"endpoint")});s(n,".jtk-overlay",function(t){f(n,t)})};for(t=0;t<o.length;t++)a(o[t]);for(h in e)i=e[h].el,i.parentNode===r&&(r.removeChild(i),l.appendChild(i))};this.getContainer=function(){return l};this.bind=function(n,t){"ready"===n&&bt?t():nr.apply(u,[n,t])};u.importDefaults=function(n){for(var t in n)u.Defaults[t]=n[t];return n.Container&&u.setContainer(n.Container),u};u.restoreDefaults=function(){return u.Defaults=i.extend({},si),u};var hi=null,bt=!1,p=[],f={},k={},e={},s={},ht={},tr={},ci=!1,a=[],d=!1,b=null,li=this.Defaults.Scope,ir=1,rt=function(){return""+ir++},rr=function(n,t){l?l.appendChild(n):t?this.getElement(t).appendChild(n):this.appendToRoot(n)}.bind(this),ut=function(n,t,i,r){var o={c:[],e:[]},c,f,l,s,e,h;if(!d&&(n=u.getElement(n),n!=null)){for(c=y(n),f=n.querySelectorAll(".jtk-managed"),i==null&&(i=jsPlumbUtil.uuid()),l=tt({elId:c,offset:t,recalc:!1,timestamp:i}),s=0;s<f.length;s++)tt({elId:f[s].getAttribute("id"),recalc:!0,timestamp:i});if(e=u.router.redraw(c,t,i,null,r),Array.prototype.push.apply(o.c,e.c),Array.prototype.push.apply(o.e,e.e),f)for(h=0;h<f.length;h++)e=u.router.redraw(f[h].getAttribute("id"),null,i,null,r,!0),Array.prototype.push.apply(o.c,e.c),Array.prototype.push.apply(o.e,e.e)}return o},kt=function(n){return k[n]},ur=function(n,t){for(var i,u=n.scope.split(/\s/),f=t.scope.split(/\s/),r=0;r<u.length;r++)for(i=0;i<f.length;i++)if(f[i]===u[r])return!0;return!1},fr=function(n,t){var u=i.extend({},n);for(var r in t)t[r]&&(u[r]=t[r]);return u},er=function(t,r){var f=i.extend({},t),e,s,h,o;if(r&&i.extend(f,r),f.source&&(f.source.endpoint?f.sourceEndpoint=f.source:f.source=u.getElement(f.source)),f.target&&(f.target.endpoint?f.targetEndpoint=f.target:f.target=u.getElement(f.target)),t.uuids&&(f.sourceEndpoint=kt(t.uuids[0]),f.targetEndpoint=kt(t.uuids[1])),f.sourceEndpoint&&f.sourceEndpoint.isFull()){n.log(u,"could not add connection; source endpoint is full");return}if(f.targetEndpoint&&f.targetEndpoint.isFull()){n.log(u,"could not add connection; target endpoint is full");return}if(!f.type&&f.sourceEndpoint&&(f.type=f.sourceEndpoint.connectionType),f.sourceEndpoint&&f.sourceEndpoint.connectorOverlays)for(f.overlays=f.overlays||[],e=0,s=f.sourceEndpoint.connectorOverlays.length;e<s;e++)f.overlays.push(f.sourceEndpoint.connectorOverlays[e]);if(f.sourceEndpoint&&f.sourceEndpoint.scope&&(f.scope=f.sourceEndpoint.scope),!f["pointer-events"]&&f.sourceEndpoint&&f.sourceEndpoint.connectorPointerEvents&&(f["pointer-events"]=f.sourceEndpoint.connectorPointerEvents),h=function(n,t,i){var r=fr(t,{anchor:f.anchors?f.anchors[i]:f.anchor,endpoint:f.endpoints?f.endpoints[i]:f.endpoint,paintStyle:f.endpointStyles?f.endpointStyles[i]:f.endpointStyle,hoverPaintStyle:f.endpointHoverStyles?f.endpointHoverStyles[i]:f.endpointHoverStyle});return u.addEndpoint(n,r)},o=function(n,t,r,u){var c,e,s,o;if(f[n]&&!f[n].endpoint&&!f[n+"Endpoint"]&&!f.newConnection&&(c=y(f[n]),e=r[c],e=e?e[u]:null,e)){if(!e.enabled||(s=i.extend({},e.def),delete s.label,o=e.endpoint!=null&&e.endpoint._jsPlumb?e.endpoint:h(f[n],s,t),o.isFull()))return!1;f[n+"Endpoint"]=o;!f.scope&&s.scope&&(f.scope=s.scope);e.uniqueEndpoint?e.endpoint?o.finalEndpoint=e.endpoint:(e.endpoint=o,o.setDeleteOnEmpty(!1)):o.setDeleteOnEmpty(!0);t===0&&e.def.connectorOverlays&&(f.overlays=f.overlays||[],Array.prototype.push.apply(f.overlays,e.def.connectorOverlays))}},o("source",0,this.sourceEndpointDefinitions,f.type||"default")!==!1)return o("target",1,this.targetEndpointDefinitions,f.type||"default")===!1?void 0:(f.sourceEndpoint&&f.targetEndpoint&&(ur(f.sourceEndpoint,f.targetEndpoint)||(f=null)),f)}.bind(u),dt=function(n){var i=u.Defaults.ConnectionType||u.getDefaultConnectionType(),t;return n._jsPlumb=u,n.newConnection=dt,n.newEndpoint=gt,n.endpointsByUUID=k,n.endpointsByElement=f,n.finaliseConnection=ai,n.id="con_"+rt(),t=new i(n),t.isDetachable()&&(t.endpoints[0].initDraggable("_jsPlumbSource"),t.endpoints[1].initDraggable("_jsPlumbTarget")),t},ai=u.finaliseConnection=function(n,t,i,r){if(t=t||{},n.suspendedEndpoint||p.push(n),n.pending=null,n.endpoints[0].isTemporarySource=!1,r!==!1&&u.router.newConnection(n),ut(n.source),!t.doNotFireConnectionEvent&&t.fireEvent!==!1){var f={connection:n,source:n.source,target:n.target,sourceId:n.sourceId,targetId:n.targetId,sourceEndpoint:n.endpoints[0],targetEndpoint:n.endpoints[1]};u.fire("connection",f,i)}},gt=function(n,t){var o=u.Defaults.EndpointType||i.Endpoint,r=i.extend({},n),e;return r._jsPlumb=u,r.newConnection=dt,r.newEndpoint=gt,r.endpointsByUUID=k,r.endpointsByElement=f,r.fireDetachEvent=ct,r.elementId=t||y(r.source),e=new o(r),e.id="ep_"+rt(),ki(r.elementId,r.source),i.headless||u.getDragManager().endpointAdded(r.source,t),e},vi=function(n,t,i){var r=f[n],u,o,e,s,h;if(r&&r.length)for(u=0,o=r.length;u<o;u++){for(e=0,s=r[u].connections.length;e<s;e++)if(h=t(r[u].connections[e]),h)return;i&&i(r[u])}},wr=function(n,t){return i.each(n,function(n){u.isDragSupported(n)&&(tr[u.getAttribute(n,"id")]=t,u.setElementDraggable(n,t))})},yi=function(n,t,i){var r,u;t=t==="block";r=null;i&&(r=function(n){n.setVisible(t,!0,!0)});u=c(n);vi(u.id,function(n){if(t&&i){var r=n.sourceId===u.id?1:0;n.endpoints[r].isVisible()&&n.setVisible(!0)}else n.setVisible(t)},r)},or=function(n,t){var i=null;t&&(i=function(n){var t=n.isVisible();n.setVisible(!t)});vi(n,function(n){var t=n.isVisible();n.setVisible(!t)},i)},sr=function(n){var t=s[n];return t?{o:t,s:a[n]}:tt({elId:n})},y=function(t,i,r){if(n.isString(t))return t;if(t==null)return null;var f=u.getAttribute(t,"id");return f&&f!=="undefined"||(arguments.length===2&&arguments[1]!==undefined?f=i:arguments.length!==1&&(arguments.length!==3||arguments[2])||(f="jsPlumb_"+oi+"_"+rt()),r||u.setAttribute(t,"id",f)),f};this.setConnectionBeingDragged=function(n){ci=n};this.isConnectionBeingDragged=function(){return ci};this.getManagedElements=function(){return e};this.connectorClass="jtk-connector";this.connectorOutlineClass="jtk-connector-outline";this.connectedClass="jtk-connected";this.hoverClass="jtk-hover";this.endpointClass="jtk-endpoint";this.endpointConnectedClass="jtk-endpoint-connected";this.endpointFullClass="jtk-endpoint-full";this.endpointDropAllowedClass="jtk-endpoint-drop-allowed";this.endpointDropForbiddenClass="jtk-endpoint-drop-forbidden";this.overlayClass="jtk-overlay";this.draggingClass="jtk-dragging";this.elementDraggingClass="jtk-element-dragging";this.sourceElementDraggingClass="jtk-source-element-dragging";this.targetElementDraggingClass="jtk-target-element-dragging";this.endpointAnchorClassPrefix="jtk-endpoint-anchor";this.hoverSourceClass="jtk-source-hover";this.hoverTargetClass="jtk-target-hover";this.dragSelectClass="jtk-drag-select";this.Anchors={};this.Connectors={svg:{}};this.Endpoints={svg:{}};this.Overlays={svg:{}};this.ConnectorRenderers={};this.SVG="svg";this.addEndpoint=function(t,r,e){var o,s,v,l,p;for(e=e||{},o=i.extend({},e),i.extend(o,r),o.endpoint=o.endpoint||u.Defaults.Endpoint,o.paintStyle=o.paintStyle||u.Defaults.EndpointStyle,s=[],v=n.isArray(t)||t.length!=null&&!n.isString(t)?t:[t],l=0,p=v.length;l<p;l++){o.source=u.getElement(v[l]);yt(o.source);var h=y(o.source),c=gt(o,h),w=ki(h,o.source,null,!d).info.o;n.addToList(f,h,c);d||c.paint({anchorLoc:c.anchor.compute({xy:[w.left,w.top],wh:a[h],element:c,timestamp:b,rotation:this.getRotation(h)}),timestamp:b});s.push(c)}return s.length===1?s[0]:s};this.addEndpoints=function(t,i,r){for(var f,e=[],o=0,s=i.length;o<s;o++)f=u.addEndpoint(t,i[o],r),n.isArray(f)?Array.prototype.push.apply(e,f):e.push(f);return e};this.animate=function(t,r,f){if(!this.animationSupported)return!1;f=f||{};var e=u.getElement(t),o=y(e),s=i.animEvents.step,h=i.animEvents.complete;f[s]=n.wrap(f[s],function(){u.revalidate(o)});f[h]=n.wrap(f[h],function(){u.revalidate(o)});u.doAnimate(e,r,f)};this.checkCondition=function(t){var i=u.getListener(t),f=!0,e,r,o;if(i&&i.length>0){e=Array.prototype.slice.call(arguments,1);try{for(r=0,o=i.length;r<o;r++)f=f&&i[r].apply(i[r],e)}catch(s){n.log(u,"cannot check condition ["+t+"]"+s)}}return f};this.connect=function(t,i){var r=er(t,i),u;if(r){if(r.source==null&&r.sourceEndpoint==null){n.log("Cannot establish connection - source does not exist");return}if(r.target==null&&r.targetEndpoint==null){n.log("Cannot establish connection - target does not exist");return}yt(r.source);u=dt(r);ai(u,r)}return u};pi=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}];ni=function(n,t,r,u){var f,s=pi[r],l=n[s.elId],v=n[s.el],h,e,a=n.endpoints[r],c={index:r,originalSourceId:r===0?l:n.sourceId,newSourceId:n.sourceId,originalTargetId:r===1?l:n.targetId,newTargetId:n.targetId,connection:n},o;if(t.constructor===i.Endpoint)f=t,f.addConnection(n),t=f.element;else if(h=y(t),e=this[s.epDefs][h],h===n[s.elId])f=null;else if(e)for(o in e){if(!e[o].enabled)return;f=e[o].endpoint!=null&&e[o].endpoint._jsPlumb?e[o].endpoint:this.addEndpoint(t,e[o].def);e[o].uniqueEndpoint&&(e[o].endpoint=f);f.addConnection(n)}else f=n.makeEndpoint(r===0,t,h);return f!=null&&(a.detachFromConnection(n),n.endpoints[r]=f,n[s.el]=f.element,n[s.elId]=f.elementId,c[r===0?"newSourceId":"newTargetId"]=f.elementId,wi(c),u||n.repaint()),c.element=t,c}.bind(this);this.setSource=function(n,t,i){var r=ni(n,t,0,i);this.router.sourceOrTargetChanged(r.originalSourceId,r.newSourceId,n,r.el,0)};this.setTarget=function(n,t,i){var r=ni(n,t,1,i);this.router.sourceOrTargetChanged(r.originalTargetId,r.newTargetId,n,r.el,1)};this.deleteEndpoint=function(n,t,i){var r=typeof n=="string"?k[n]:n;return r&&u.deleteObject({endpoint:r,dontUpdateHover:t,deleteAttachedObjects:i}),u};this.deleteEveryEndpoint=function(){var h=u.setSuspendDrawing(!0),r,n,t,o,i;for(r in f)if(n=f[r],n&&n.length)for(t=0,o=n.length;t<o;t++)u.deleteEndpoint(n[t],!0);return f={},e={},k={},s={},ht={},u.router.reset(),i=u.getDragManager(),i&&i.reset(),h||u.setSuspendDrawing(!1),u};ct=function(n,t,i){var f=u.Defaults.ConnectionType||u.getDefaultConnectionType(),e=n.constructor===f,r=e?{connection:n,source:n.source,target:n.target,sourceId:n.sourceId,targetId:n.targetId,sourceEndpoint:n.endpoints[0],targetEndpoint:n.endpoints[1]}:n;t&&u.fire("connectionDetached",r,i);u.fire("internal.connectionDetached",r,i);u.router.connectionDetached(r)};wi=u.fireMoveEvent=function(n,t){u.fire("connectionMoved",n,t)};this.unregisterEndpoint=function(n){var t,i,e,r,o;n._jsPlumb.uuid&&(k[n._jsPlumb.uuid]=null);u.router.deleteEndpoint(n);for(t in f){if(i=f[t],i){for(e=[],r=0,o=i.length;r<o;r++)i[r]!==n&&e.push(i[r]);f[t]=e}f[t].length<1&&delete f[t]}};var ti="isDetachAllowed",hr="beforeDetach",cr="checkCondition";this.deleteConnection=function(t,i){return t!=null&&(i=i||{},i.force||n.functionChain(!0,!1,[[t.endpoints[0],ti,[t]],[t.endpoints[1],ti,[t]],[t,ti,[t]],[u,cr,[hr,t]]]))?(t.setHover(!1),ct(t,!t.pending&&i.fireEvent!==!1,i.originalEvent),t.endpoints[0].detachFromConnection(t),t.endpoints[1].detachFromConnection(t),n.removeWithFunction(p,function(n){return t.id===n.id}),t.cleanup(),t.destroy(),!0):!1};this.deleteEveryConnection=function(n){n=n||{};var i=p.length,t=0;return u.batch(function(){for(var r=0;r<i;r++)t+=u.deleteConnection(p[0],n)?1:0}),t};this.deleteConnectionsForElement=function(n,t){var e,i,r,o;if(t=t||{},n=u.getElement(n),e=y(n),i=f[e],i&&i.length)for(r=0,o=i.length;r<o;r++)i[r].deleteEveryConnection(t);return u};this.deleteObject=function(t){var i={endpoints:{},connections:{},endpointCount:0,connectionCount:0},c=t.deleteAttachedObjects!==!1,o=function(n){n!=null&&i.connections[n.id]==null&&(t.dontUpdateHover||n._jsPlumb==null||n.setHover(!1),i.connections[n.id]=n,i.connectionCount++)},l=function(n){var r,u;if(n!=null&&i.endpoints[n.id]==null&&(t.dontUpdateHover||n._jsPlumb==null||n.setHover(!1),i.endpoints[n.id]=n,i.endpointCount++,c))for(r=0;r<n.connections.length;r++)u=n.connections[r],o(u)},s,r,e,h,f;t.connection?o(t.connection):l(t.endpoint);for(s in i.connections)r=i.connections[s],r._jsPlumb&&(n.removeWithFunction(p,function(n){return r.id===n.id}),ct(r,t.fireEvent===!1?!1:!r.pending,t.originalEvent),e=t.deleteAttachedObjects==null?null:!t.deleteAttachedObjects,r.endpoints[0].detachFromConnection(r,null,e),r.endpoints[1].detachFromConnection(r,null,e),r.cleanup(!0),r.destroy(!0));for(h in i.endpoints)f=i.endpoints[h],f._jsPlumb&&(u.unregisterEndpoint(f),f.cleanup(!0),f.destroy(!0));return i};var lr=function(n,t,i,r){for(var u=0,f=n.length;u<f;u++)n[u][t].apply(n[u],i);return r(n)},ar=function(n,t,i){for(var u=[],r=0,f=n.length;r<f;r++)u.push([n[r][t].apply(n[r],i),n[r]]);return u},it=function(n,t,i){return function(){return lr(n,t,arguments,i)}},lt=function(n,t){return function(){return ar(n,t,arguments)}},g=function(n,t){var i=[],r,u;if(n)if(typeof n=="string"){if(n==="*")return n;i.push(n)}else if(t)i=n;else if(n.length)for(r=0,u=n.length;r<u;r++)i.push(c(n[r]).id);else i.push(c(n).id);return i},nt=function(n,t,i){return n==="*"?!0:n.length>0?n.indexOf(t)!==-1:!i};this.getConnections=function(n,t){var f,o;n?n.constructor===String&&(n={scope:n}):n={};var s=n.scope||u.getDefaultScope(),e=g(s,!0),h=g(n.source),c=g(n.target),r=!t&&e.length>1?{}:[],l=function(n,i){if(!t&&e.length>1){var u=r[n];u==null&&(u=r[n]=[]);u.push(i)}else r.push(i)};for(f=0,o=p.length;f<o;f++){var i=p[f],a=i.proxies&&i.proxies[0]?i.proxies[0].originalEp.elementId:i.sourceId,v=i.proxies&&i.proxies[1]?i.proxies[1].originalEp.elementId:i.targetId;nt(e,i.scope)&&nt(h,a)&&nt(c,v)&&l(i.scope,i)}return r};var vr=function(n,t){return function(i){for(var r=0,u=n.length;r<u;r++)i(n[r]);return t(n)}},yr=function(n){return function(t){return n[t]}},bi=function(n,t){for(var u={length:n.length,each:vr(n,t),get:yr(n)},f=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],e=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],i=0,r=f.length;i<r;i++)u[f[i]]=it(n,f[i],t);for(i=0,r=e.length;i<r;i++)u[e[i]]=lt(n,e[i]);return u},ft=function(n){var t=bi(n,ft);return i.extend(t,{setDetachable:it(n,"setDetachable",ft),setReattach:it(n,"setReattach",ft),setConnector:it(n,"setConnector",ft),"delete":function(){for(var t=0,i=n.length;t<i;t++)u.deleteConnection(n[t])},isDetachable:lt(n,"isDetachable"),isReattach:lt(n,"isReattach")})},at=function(n){var t=bi(n,at);return i.extend(t,{setEnabled:it(n,"setEnabled",at),setAnchor:it(n,"setAnchor",at),isEnabled:lt(n,"isEnabled"),deleteEveryConnection:function(){for(var t=0,i=n.length;t<i;t++)n[t].deleteEveryConnection()},"delete":function(){for(var t=0,i=n.length;t<i;t++)u.deleteEndpoint(n[t])}})};this.select=function(n){return n=n||{},n.scope=n.scope||"*",ft(n.connections||u.getConnections(n,!0))};this.selectEndpoints=function(n){var t,r,h,i,c,l;n=n||{};n.scope=n.scope||"*";var u=!n.element&&!n.source&&!n.target,a=u?"*":g(n.element),e=u?"*":g(n.source),o=u?"*":g(n.target),v=g(n.scope,!0),s=[];for(t in f){var y=nt(a,t,!0),p=nt(e,t,!0),w=e!=="*",b=nt(o,t,!0),k=o!=="*";if(y||p||b)n:for(r=0,h=f[t].length;r<h;r++)if(i=f[t][r],nt(v,i.scope,!0)){if(c=w&&e.length>0&&!i.isSource,l=k&&o.length>0&&!i.isTarget,c||l)continue n;s.push(i)}}return at(s)};this.getAllConnections=function(){return p};this.getDefaultScope=function(){return li};this.getEndpoint=kt;this.getEndpoints=function(n){return f[c(n).id]||[]};this.getDefaultEndpointType=function(){return i.Endpoint};this.getDefaultConnectionType=function(){return i.Connection};this.getId=y;this.draw=ut;this.info=c;this.appendElement=rr;vt=!1;this.isHoverSuspended=function(){return vt};this.setHoverSuspended=function(n){vt=n};this.hide=function(n,t){return yi(n,"none",t),u};this.idstamp=rt;var yt=function(n){if(!l&&n){var t=u.getElement(n);t.offsetParent&&u.setContainer(t.offsetParent)}},pr=function(){u.Defaults.Container&&u.setContainer(u.Defaults.Container)},ki=u.manage=function(n,t,i,r){return e[n]?r&&(e[n].info=tt({elId:n,timestamp:b,recalc:!0})):(e[n]={el:t,endpoints:[],connections:[],rotation:0},e[n].info=tt({elId:n,timestamp:b}),u.addClass(t,"jtk-managed"),i||u.fire("manageElement",{id:n,info:e[n].info,el:t})),e[n]};this.unmanage=function(n){if(e[n]){var t=e[n].el;u.removeClass(t,"jtk-managed");delete e[n];u.fire("unmanageElement",{id:n,el:t})}};this.rotate=function(n,t,i){return e[n]&&(e[n].rotation=t,e[n].el.style.transform="rotate("+t+"deg)",e[n].el.style.transformOrigin="center center",i!==!0)?this.revalidate(n):{c:[],e:[]}};this.getRotation=function(n){return e[n]?e[n].rotation||0:0};tt=function(n){var r=n.timestamp,f=n.recalc,o=n.offset,t=n.elId,i;return(d&&!r&&(r=b),!f&&r&&r===ht[t])?{o:n.offset||s[t],s:a[t]}:(f||!o&&s[t]==null?(i=e[t]?e[t].el:null,i!=null&&(a[t]=u.getSize(i),s[t]=u.getOffset(i),ht[t]=r)):(s[t]=o||s[t],a[t]==null&&(i=e[t].el,i!=null&&(a[t]=u.getSize(i))),ht[t]=r),s[t]&&!s[t].right&&(s[t].right=s[t].left+a[t][0],s[t].bottom=s[t].top+a[t][1],s[t].width=a[t][0],s[t].height=a[t][1],s[t].centerx=s[t].left+s[t].width/2,s[t].centery=s[t].top+s[t].height/2),{o:s[t],s:a[t]})};this.updateOffset=tt;this.init=function(){bt||(pr(),u.router=new t.jsPlumb.DefaultRouter(u),u.anchorManager=u.router.anchorManager,bt=!0,u.fire("ready",u))}.bind(this);this.log=hi;this.jsPlumbUIComponent=h;this.makeAnchor=function(){var o,h=function(n,i){if(t.jsPlumb.Anchors[n])return new t.jsPlumb.Anchors[n](i);if(!u.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+n+"'"};},s;if(arguments.length===0)return null;var r=arguments[0],e=arguments[1],c=arguments[2],f=null;return r.compute&&r.getOrientation?r:(typeof r=="string"?f=h(arguments[0],{elementId:e,jsPlumbInstance:u}):n.isArray(r)&&(n.isArray(r[0])||n.isString(r[0])?r.length===2&&n.isObject(r[1])?n.isString(r[0])?(o=t.jsPlumb.extend({elementId:e,jsPlumbInstance:u},r[1]),f=h(r[0],o)):(o=t.jsPlumb.extend({elementId:e,jsPlumbInstance:u,anchors:r[0]},r[1]),f=new t.jsPlumb.DynamicAnchor(o)):f=new i.DynamicAnchor({anchors:r,selector:null,elementId:e,jsPlumbInstance:u}):(s={x:r[0],y:r[1],orientation:r.length>=4?[r[2],r[3]]:[0,0],offsets:r.length>=6?[r[4],r[5]]:[0,0],elementId:e,jsPlumbInstance:u,cssClass:r.length===7?r[6]:null},f=new t.jsPlumb.Anchor(s),f.clone=function(){return new t.jsPlumb.Anchor(s)})),f.id||(f.id="anchor_"+rt()),f)};this.makeAnchors=function(i,r,f){for(var o=[],e=0,s=i.length;e<s;e++)typeof i[e]=="string"?o.push(t.jsPlumb.Anchors[i[e]]({elementId:r,jsPlumbInstance:f})):n.isArray(i[e])&&o.push(u.makeAnchor(i[e],r,f));return o};this.makeDynamicAnchor=function(n,i){return new t.jsPlumb.DynamicAnchor({anchors:n,selector:i,elementId:null,jsPlumbInstance:u})};this.targetEndpointDefinitions={};this.sourceEndpointDefinitions={};di=function(n,t,i,r,u){for(var s=n.target||n.srcElement,f=!1,o=r.getSelector(t,i),e=0;e<o.length;e++)if(o[e]===s){f=!0;break}return u?!f:f};ii=function(i,r,f,e,o){var s=new h(r),c=r._jsPlumb.EndpointDropHandler({jsPlumb:u,enabled:function(){return i.def.enabled},isFull:function(){var n=u.select({target:i.id}).length;return i.def.maxConnections>0&&n>=i.def.maxConnections},element:i.el,elementId:i.id,isSource:e,isTarget:o,addClass:function(n){u.addClass(i.el,n)},removeClass:function(n){u.removeClass(i.el,n)},onDrop:function(n){var t=n.endpoints[0];t.anchor.locked=!1},isDropAllowed:function(){return s.isDropAllowed.apply(s,arguments)},isRedrop:function(n){return n.suspendedElement!=null&&n.suspendedEndpoint!=null&&n.suspendedEndpoint.element===i.el},getEndpoint:function(n){var f=i.def.endpoint,e,o;if((f==null||f._jsPlumb==null)&&(e=u.deriveEndpointAndAnchorSpec(n.getType().join(" "),!0),o=e.endpoints?t.jsPlumb.extend(r,{endpoint:i.def.def.endpoint||e.endpoints[1]}):r,e.anchors&&(o=t.jsPlumb.extend(o,{anchor:i.def.def.anchor||e.anchors[1]})),f=u.addEndpoint(i.el,o),f._mtNew=!0),r.uniqueEndpoint&&(i.def.endpoint=f),f.setDeleteOnEmpty(!0),n.isDetachable()&&f.initDraggable(),f.anchor.positionFinder!=null){var s=u.getUIPosition(arguments,u.getZoom()),c=u.getOffset(i.el),l=u.getSize(i.el),h=s==null?[0,0]:f.anchor.positionFinder(s,c,l,f.anchor.constructorParams);f.anchor.x=h[0];f.anchor.y=h[1]}return f},maybeCleanup:function(n){n._mtNew&&n.connections.length===0?u.deleteObject({endpoint:n}):delete n._mtNew}}),l=t.jsPlumb.dragEvents.drop;return f.scope=f.scope||r.scope||u.Defaults.Scope,f[l]=n.wrap(f[l],c,!0),f.rank=r.rank||0,o&&(f[t.jsPlumb.dragEvents.over]=function(){return!0}),r.allowLoopback===!1&&(f.canDrop=function(n){var t=n.getDragElement()._jsPlumbRelatedElement;return t!==i.el}),u.initDroppable(i.el,f,"internal"),c};this.makeTarget=function(n,i,r){var f=t.jsPlumb.extend({_jsPlumb:this},r),e,s;t.jsPlumb.extend(f,i);var h=f.maxConnections||-1,l=function(n){var r=c(n),e=r.id,o=t.jsPlumb.extend({},f.dropOptions||{}),s=f.connectionType||"default",i;this.targetEndpointDefinitions[e]=this.targetEndpointDefinitions[e]||{};yt(e);r.el._isJsPlumbGroup&&o.rank==null&&(o.rank=-1);i={def:t.jsPlumb.extend({},f),uniqueEndpoint:f.uniqueEndpoint,maxConnections:h,enabled:!0};f.createEndpoint&&(i.uniqueEndpoint=!0,i.endpoint=u.addEndpoint(n,i.def),i.endpoint.setDeleteOnEmpty(!1));r.def=i;this.targetEndpointDefinitions[e][s]=i;ii(r,f,o,f.isSource===!0,!0);r.el._katavorioDrop[r.el._katavorioDrop.length-1].targetDef=i}.bind(this),o=n.length&&n.constructor!==String?n:[n];for(e=0,s=o.length;e<s;e++)l(o[e]);return this};this.unmakeTarget=function(n,t){var i=c(n);return u.destroyDroppable(i.el,"internal"),t||delete this.targetEndpointDefinitions[i.id],this};this.makeSource=function(i,r,f){var e=t.jsPlumb.extend({_jsPlumb:this},f),o,h,s,y;t.jsPlumb.extend(e,r);o=e.connectionType||"default";h=u.deriveEndpointAndAnchorSpec(o);e.endpoint=e.endpoint||h.endpoints[0];e.anchor=e.anchor||h.anchors[0];var l=e.maxConnections||-1,a=e.onMaxConnections,p=function(r){var s=r.id,g=this.getElement(r.el),c,y,d;this.sourceEndpointDefinitions[s]=this.sourceEndpointDefinitions[s]||{};yt(s);c={def:t.jsPlumb.extend({},e),uniqueEndpoint:e.uniqueEndpoint,maxConnections:l,enabled:!0};e.createEndpoint&&(c.uniqueEndpoint=!0,c.endpoint=u.addEndpoint(i,c.def),c.endpoint.setDeleteOnEmpty(!1));this.sourceEndpointDefinitions[s][o]=c;r.def=c;var p=t.jsPlumb.dragEvents.stop,w=t.jsPlumb.dragEvents.drag,h=t.jsPlumb.extend({},e.dragOptions||{}),b=h.drag,k=h.stop,f=null,v=!1;h.scope=h.scope||e.scope;h[w]=n.wrap(h[w],function(){b&&b.apply(this,arguments);v=!1});h[p]=n.wrap(h[p],function(){if(k&&k.apply(this,arguments),this.currentlyDragging=!1,f._jsPlumb!=null){var l=e.anchor||this.Defaults.Anchor,r=f.anchor,o=f.connections[0],n=this.makeAnchor(l,s,this),h=f.element;if(n.positionFinder!=null){var t=u.getOffset(h),i=this.getSize(h),a={left:t.left+r.x*i[0],top:t.top+r.y*i[1]},c=n.positionFinder(a,t,i,n.constructorParams);n.x=c[0];n.y=c[1]}f.setAnchor(n,!0);f.repaint();this.repaint(f.elementId);o!=null&&this.repaint(o.targetId)}}.bind(this));y=function(i){var c,nt,tt,w,y,p,b,k,d;if(i.which!==3&&i.button!==2&&(s=this.getId(this.getElement(r.el)),c=this.sourceEndpointDefinitions[s][o],c.enabled)&&(!e.filter||(nt=n.isString(e.filter)?di(i,r.el,e.filter,this,e.filterExclude):e.filter(i,r.el),nt!==!1))){if(tt=this.select({source:s}).length,c.maxConnections>=0&&tt>=c.maxConnections)return a&&a({element:r.el,maxConnections:l},i),!1;w=t.jsPlumb.getPositionOnElement(i,g,st);y={};t.jsPlumb.extend(y,c.def);y.isTemporarySource=!0;y.anchor=[w[0],w[1],0,0];y.dragOptions=h;c.def.scope&&(y.scope=c.def.scope);f=this.addEndpoint(s,y);v=!0;f.setDeleteOnEmpty(!0);c.uniqueEndpoint&&(c.endpoint?f.finalEndpoint=c.endpoint:(c.endpoint=f,f.setDeleteOnEmpty(!1)));p=function(){u.off(f.canvas,"mouseup",p);u.off(r.el,"mouseup",p);v&&(v=!1,u.deleteEndpoint(f))};u.on(f.canvas,"mouseup",p);u.on(r.el,"mouseup",p);if(b={},c.def.extract)for(k in c.def.extract)d=(i.srcElement||i.target).getAttribute(k),d&&(b[c.def.extract[k]]=d);u.trigger(f.canvas,"mousedown",i,b);n.consume(i)}}.bind(this);this.on(r.el,"mousedown",y);c.trigger=y;e.filter&&(n.isString(e.filter)||n.isFunction(e.filter))&&u.setDragFilter(r.el,e.filter);d=t.jsPlumb.extend({},e.dropOptions||{});ii(r,e,d,!0,e.isTarget===!0)}.bind(this),v=i.length&&i.constructor!==String?i:[i];for(s=0,y=v.length;s<y;s++)p(c(v[s]));return this};this.unmakeSource=function(n,t,i){var r=c(n),f,e,o;if(u.destroyDroppable(r.el,"internal"),f=this.sourceEndpointDefinitions[r.id],f)for(e in f)(t==null||t===e)&&(o=f[e].trigger,o&&u.off(r.el,"mousedown",o),i||delete this.sourceEndpointDefinitions[r.id][e]);return this};this.unmakeEverySource=function(){for(var n in this.sourceEndpointDefinitions)u.unmakeSource(n,null,!0);return this.sourceEndpointDefinitions={},this};pt=function(t,i,r){var e,u,f;for(i=n.isArray(i)?i:[i],e=y(t),r=r||"default",u=0;u<i.length;u++)if(f=this[i[u]][e],f&&f[r])return f[r].def.scope||this.Defaults.Scope}.bind(this);ri=function(t,i,r,u){var o,f,e;for(r=n.isArray(r)?r:[r],o=y(t),u=u||"default",f=0;f<r.length;f++)e=this[r[f]][o],e&&e[u]&&(e[u].def.scope=i)}.bind(this);this.getScope=function(n){return pt(n,["sourceEndpointDefinitions","targetEndpointDefinitions"])};this.getSourceScope=function(n){return pt(n,"sourceEndpointDefinitions")};this.getTargetScope=function(n){return pt(n,"targetEndpointDefinitions")};this.setScope=function(n,t,i){this.setSourceScope(n,t,i);this.setTargetScope(n,t,i)};this.setSourceScope=function(n,t,i){ri(n,t,"sourceEndpointDefinitions",i);this.setDragScope(n,t)};this.setTargetScope=function(n,t,i){ri(n,t,"targetEndpointDefinitions",i);this.setDropScope(n,t)};this.unmakeEveryTarget=function(){for(var n in this.targetEndpointDefinitions)u.unmakeTarget(n,!0);return this.targetEndpointDefinitions={},this};et=function(t,i,r,f,e){var s=t==="source"?this.sourceEndpointDefinitions:this.targetEndpointDefinitions,h,o,l,a,y,v;if(e=e||"default",i.length&&!n.isString(i))for(h=[],a=0,y=i.length;a<y;a++)o=c(i[a]),s[o.id]&&s[o.id][e]&&(h[a]=s[o.id][e].enabled,l=f?!h[a]:r,s[o.id][e].enabled=l,u[l?"removeClass":"addClass"](o.el,"jtk-"+t+"-disabled"));else o=c(i),v=o.id,s[v]&&s[v][e]&&(h=s[v][e].enabled,l=f?!h:r,s[v][e].enabled=l,u[l?"removeClass":"addClass"](o.el,"jtk-"+t+"-disabled"));return h}.bind(this);ot=function(t,i){if(t!=null){if(n.isString(t)||!t.length)return i.apply(this,[t]);if(t.length)return i.apply(this,[t[0]])}}.bind(this);this.toggleSourceEnabled=function(n,t){return et("source",n,null,!0,t),this.isSourceEnabled(n,t)};this.setSourceEnabled=function(n,t,i){return et("source",n,t,null,i)};this.isSource=function(n,t){return t=t||"default",ot(n,function(n){var i=this.sourceEndpointDefinitions[c(n).id];return i!=null&&i[t]!=null}.bind(this))};this.isSourceEnabled=function(n,t){return t=t||"default",ot(n,function(n){var i=this.sourceEndpointDefinitions[c(n).id];return i&&i[t]&&i[t].enabled===!0}.bind(this))};this.toggleTargetEnabled=function(n,t){return et("target",n,null,!0,t),this.isTargetEnabled(n,t)};this.isTarget=function(n,t){return t=t||"default",ot(n,function(n){var i=this.targetEndpointDefinitions[c(n).id];return i!=null&&i[t]!=null}.bind(this))};this.isTargetEnabled=function(n,t){return t=t||"default",ot(n,function(n){var i=this.targetEndpointDefinitions[c(n).id];return i&&i[t]&&i[t].enabled===!0}.bind(this))};this.setTargetEnabled=function(n,t,i){return et("target",n,t,null,i)};this.ready=function(n){u.bind("ready",n)};gi=function(n,t){if(typeof n=="object"&&n.length)for(var i=0,r=n.length;i<r;i++)t(n[i]);else t(n);return u};this.repaint=function(n,t,i){return gi(n,function(n){ut(n,t,i)})};this.revalidate=function(n,t,i){var f=i?n:u.getId(n),r;return u.updateOffset({elId:f,recalc:!0,timestamp:t}),r=u.getDragManager(),r&&r.updateOffsets(f),ut(n,null,t)};this.repaintEverything=function(){var t=jsPlumbUtil.uuid();for(var n in f)u.updateOffset({elId:n,recalc:!0,timestamp:t});for(n in f)ut(n,null,t);return this};this.removeAllEndpoints=function(n,t,i){i=i||[];var r=function(n){var e=c(n),h=f[e.id],o,s;if(h)for(i.push(e),o=0,s=h.length;o<s;o++)u.deleteEndpoint(h[o],!1);if(delete f[e.id],t&&e.el&&e.el.nodeType!==3&&e.el.nodeType!==8)for(o=0,s=e.el.childNodes.length;o<s;o++)r(e.el.childNodes[o])};return r(n),this};ui=function(n,t){var r,f,i;for(u.removeAllEndpoints(n.id,!0,t),r=u.getDragManager(),f=function(n){r&&r.elementRemoved(n.id);u.router.elementRemoved(n.id);u.isSource(n.el)&&u.unmakeSource(n.el);u.isTarget(n.el)&&u.unmakeTarget(n.el);u.destroyDraggable(n.el);u.destroyDroppable(n.el);delete u.floatingConnections[n.id];delete e[n.id];delete s[n.id];n.el&&(u.removeElement(n.el),n.el._jsPlumb=null)},i=1;i<t.length;i++)f(t[i]);f(n)};this.remove=function(n,t){var i=c(n),r=[];return i.text&&i.el.parentNode?i.el.parentNode.removeChild(i.el):i.id&&u.batch(function(){ui(i,r)},t===!0),u};this.empty=function(n,t){var r=[],i=function(n,t){var u=c(n);if(u.text)u.el.parentNode.removeChild(u.el);else if(u.el){while(u.el.childNodes.length>0)i(u.el.childNodes[0]);t||ui(u,r)}};return u.batch(function(){i(n,!0)},t===!1),u};this.reset=function(n){u.silently(function(){vt=!1;u.removeAllGroups();u.removeGroupManager();u.deleteEveryEndpoint();n||u.unbind();this.targetEndpointDefinitions={};this.sourceEndpointDefinitions={};p.length=0;this.doReset&&this.doReset()}.bind(this))};this.destroy=function(){this.reset();l=null;w=null};fi=function(n){n.canvas&&n.canvas.parentNode&&n.canvas.parentNode.removeChild(n.canvas);n.cleanup();n.destroy()};this.clear=function(){u.select().each(fi);u.selectEndpoints().each(fi);f={};k={}};this.setDefaultScope=function(n){return li=n,u};this.deriveEndpointAndAnchorSpec=function(n,t){for(var i,h=((t?"":"default ")+n).split(/[\s]/),r=null,f=null,e=null,o=null,s=0;s<h.length;s++)i=u.getType(h[s],"connection"),i&&(i.endpoints&&(r=i.endpoints),i.endpoint&&(f=i.endpoint),i.anchors&&(o=i.anchors),i.anchor&&(e=i.anchor));return{endpoints:r?r:[f,f],anchors:o?o:[e,e]}};this.setId=function(t,i,r){var u,c,l,o,a,s,h;for(n.isString(t)?u=t:(t=this.getElement(t),u=this.getId(t)),c=this.getConnections({source:u,scope:"*"},!0),l=this.getConnections({target:u,scope:"*"},!0),i=""+i,r?t=this.getElement(i):(t=this.getElement(u),this.setAttribute(t,"id",i)),f[i]=f[u]||[],o=0,a=f[i].length;o<a;o++)f[i][o].setElementId(i),f[i][o].setReferenceElement(t);delete f[u];this.sourceEndpointDefinitions[i]=this.sourceEndpointDefinitions[u];delete this.sourceEndpointDefinitions[u];this.targetEndpointDefinitions[i]=this.targetEndpointDefinitions[u];delete this.targetEndpointDefinitions[u];this.router.changeId(u,i);s=this.getDragManager();s&&s.changeId(u,i);e[i]=e[u];delete e[u];h=function(n,r,u){for(var f=0,e=n.length;f<e;f++)n[f].endpoints[r].setElementId(i),n[f].endpoints[r].setReferenceElement(t),n[f][u+"Id"]=i,n[f][u]=t};h(c,0,"source");h(l,1,"target");this.repaint(i)};this.setDebugLog=function(n){hi=n};this.setSuspendDrawing=function(n,t){var i=d;return d=n,b=n?(new Date).getTime():null,t&&this.repaintEverything(),i};this.isSuspendDrawing=function(){return d};this.getSuspendedAt=function(){return b};this.batch=function(t,i){var r=this.isSuspendDrawing();r||this.setSuspendDrawing(!0);try{t()}catch(u){n.log("Function run while suspended failed",u)}r||this.setSuspendDrawing(!1,!i)};this.doWhileSuspended=this.batch;this.getCachedData=sr;this.show=function(n,t){return yi(n,"block",t),u};this.toggleVisible=or;this.addListener=this.bind;ei=[];this.registerFloatingConnection=function(t,i,r){ei[t.id]=i;n.addToList(f,t.id,r)};this.getFloatingConnectionFor=function(n){return ei[n]};this.listManager=new t.jsPlumbListManager(this,this.Defaults.ListStyle)};n.extend(t.jsPlumbInstance,n.EventGenerator,{setAttribute:function(n,t,i){this.setAttribute(n,t,i)},getAttribute:function(n,i){return this.getAttribute(t.jsPlumb.getElement(n),i)},convertToFullOverlaySpec:function(t){return n.isString(t)&&(t=[t,{}]),t[1].id=t[1].id||n.uuid(),t},registerConnectionType:function(n,i){var u,r,f;if(this._connectionTypes[n]=t.jsPlumb.extend({},i),i.overlays){for(u={},r=0;r<i.overlays.length;r++)f=this.convertToFullOverlaySpec(i.overlays[r]),u[f[1].id]=f;this._connectionTypes[n].overlays=u}},registerConnectionTypes:function(n){for(var t in n)this.registerConnectionType(t,n[t])},registerEndpointType:function(n,i){var u,r,f;if(this._endpointTypes[n]=t.jsPlumb.extend({},i),i.overlays){for(u={},r=0;r<i.overlays.length;r++)f=this.convertToFullOverlaySpec(i.overlays[r]),u[f[1].id]=f;this._endpointTypes[n].overlays=u}},registerEndpointTypes:function(n){for(var t in n)this.registerEndpointType(t,n[t])},getType:function(n,t){return t==="connection"?this._connectionTypes[n]:this._endpointTypes[n]},setIdChanged:function(n,t){this.setId(n,t,!0)},setParent:function(n,t){var i=this.getElement(n),f=this.getId(i),r=this.getElement(t),e=this.getId(r),u=this.getDragManager();i.parentNode.removeChild(i);r.appendChild(i);u&&u.setParent(i,f,r,e)},extend:function(n,t,i){var r;if(i)for(r=0;r<i.length;r++)n[i[r]]=t[i[r]];else for(r in t)n[r]=t[r];return n},floatingConnections:{},getFloatingAnchorIndex:function(n){return n.endpoints[0].isFloating()?0:n.endpoints[1].isFloating()?1:-1},proxyConnection:function(n,t,i,r,u,f){var e,s=n.endpoints[t].elementId,o=n.endpoints[t];n.proxies=n.proxies||[];e=n.proxies[t]?n.proxies[t].ep:this.addEndpoint(i,{endpoint:u(n,t),anchor:f(n,t),parameters:{isProxyEndpoint:!0}});e.setDeleteOnEmpty(!0);n.proxies[t]={ep:e,originalEp:o};t===0?this.router.sourceOrTargetChanged(s,r,n,i,0):this.router.sourceOrTargetChanged(s,r,n,i,1);o.detachFromConnection(n,null,!0);e.connections=[n];n.endpoints[t]=e;o.setVisible(!1);n.setVisible(!0);this.revalidate(i)},unproxyConnection:function(n,t,i){if(n._jsPlumb!=null&&n.proxies!=null&&n.proxies[t]!=null){var r=n.proxies[t].originalEp.element,u=n.proxies[t].originalEp.elementId;n.endpoints[t]=n.proxies[t].originalEp;t===0?this.router.sourceOrTargetChanged(i,u,n,r,0):this.router.sourceOrTargetChanged(i,u,n,r,1);n.proxies[t].ep.detachFromConnection(n,null);n.proxies[t].originalEp.addConnection(n);n.isVisible()&&n.proxies[t].originalEp.setVisible(!0);delete n.proxies[t]}}});i=new l;t.jsPlumb=i;i.getInstance=function(n,t){var i=new l(n),r;if(t)for(r in t)i[r]=t[r];return i.init(),i};i.each=function(n,t){if(n!=null)if(typeof n=="string")t(i.getElement(n));else if(n.length!=null)for(var r=0;r<n.length;r++)t(i.getElement(n[r]));else t(n)};typeof exports!="undefined"&&(exports.jsPlumb=i)}.call(typeof window!="undefined"?window:this),function(){"use strict";var i=this,n=i.jsPlumb,r=i.jsPlumbUtil,t="__label",u=function(i,r){var u={cssClass:r.cssClass,labelStyle:i.labelStyle,id:t,component:i,_jsPlumb:i._jsPlumb.instance},f=n.extend(u,r);return new n.Overlays[i._jsPlumb.instance.getRenderMode()].Label(f)},f=function(t,i){var u=null,e,f;return r.isArray(i)?(e=i[0],f=n.extend({component:t,_jsPlumb:t._jsPlumb.instance},i[1]),i.length===3&&n.extend(f,i[2]),u=new n.Overlays[t._jsPlumb.instance.getRenderMode()][e](f)):u=i.constructor===String?new n.Overlays[t._jsPlumb.instance.getRenderMode()][i]({component:t,_jsPlumb:t._jsPlumb.instance}):i,u.id=u.id||r.uuid(),t.cacheTypeItem("overlay",u,u.id),t._jsPlumb.overlays[u.id]=u,u};n.OverlayCapableJsPlumbUIComponent=function(n){i.jsPlumbUIComponent.apply(this,arguments);this._jsPlumb.overlays={};this._jsPlumb.overlayPositions={};n.label&&(this.getDefaultType().overlays[t]=["Label",{label:n.label,location:n.labelLocation||this.defaultLabelLocation||.5,labelStyle:n.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:t}]);this.setListenerComponent=function(n){if(this._jsPlumb)for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t].setListenerComponent(n)}};n.OverlayCapableJsPlumbUIComponent.applyType=function(n,t){var u,i,f,r;if(t.overlays){u={};for(i in t.overlays)f=n._jsPlumb.overlays[t.overlays[i][1].id],f?(f.updateFrom(t.overlays[i][1]),u[t.overlays[i][1].id]=!0,f.reattach(n._jsPlumb.instance,n)):(r=n.getCachedTypeItem("overlay",t.overlays[i][1].id),r!=null?(r.reattach(n._jsPlumb.instance,n),r.setVisible(!0),r.updateFrom(t.overlays[i][1]),n._jsPlumb.overlays[r.id]=r):r=n.addOverlay(t.overlays[i],!0),u[r.id]=!0);for(i in n._jsPlumb.overlays)u[n._jsPlumb.overlays[i].id]==null&&n.removeOverlay(n._jsPlumb.overlays[i].id,!0)}};r.extend(n.OverlayCapableJsPlumbUIComponent,i.jsPlumbUIComponent,{setHover:function(n){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t][n?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(n,t){var u=f(this,n),i,o,s,e;return this.getData&&u.type==="Label"&&r.isArray(n)&&(i=this.getData(),o=n[1],i&&(s=o.labelLocationAttribute||"labelLocation",e=i?i[s]:null,e&&(u.loc=e))),t||this.repaint(),u},getOverlay:function(n){return this._jsPlumb.overlays[n]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(n){var t=this.getOverlay(n);t&&t.hide()},hideOverlays:function(){for(var n in this._jsPlumb.overlays)this._jsPlumb.overlays[n].hide()},showOverlay:function(n){var t=this.getOverlay(n);t&&t.show()},showOverlays:function(){for(var n in this._jsPlumb.overlays)this._jsPlumb.overlays[n].show()},removeAllOverlays:function(n){for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t].cleanup&&this._jsPlumb.overlays[t].cleanup();this._jsPlumb.overlays={};this._jsPlumb.overlayPositions=null;this._jsPlumb.overlayPlacements={};n||this.repaint()},removeOverlay:function(n,t){var i=this._jsPlumb.overlays[n];i&&(i.setVisible(!1),!t&&i.cleanup&&i.cleanup(),delete this._jsPlumb.overlays[n],this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[n],this._jsPlumb.overlayPlacements&&delete this._jsPlumb.overlayPlacements[n])},removeOverlays:function(){for(var n=0,t=arguments.length;n<t;n++)this.removeOverlay(arguments[n])},moveParent:function(n){var i,t;if(this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),n.appendChild(this.bgCanvas)),this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas);n.appendChild(this.canvas);for(i in this._jsPlumb.overlays)this._jsPlumb.overlays[i].isAppendedAtTopLevel&&(t=this._jsPlumb.overlays[i].getElement(),t.parentNode.removeChild(t),n.appendChild(t))}},getLabel:function(){var n=this.getOverlay(t);return n!=null?n.getLabel():null},getLabelOverlay:function(){return this.getOverlay(t)},setLabel:function(n){var i=this.getOverlay(t),r;i?n.constructor===String||n.constructor===Function?i.setLabel(n):(n.label&&i.setLabel(n.label),n.location&&i.setLocation(n.location)):(r=n.constructor===String||n.constructor===Function?{label:n}:n,i=u(this,r),this._jsPlumb.overlays[t]=i);this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(n){for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t].cleanup(n),this._jsPlumb.overlays[t].destroy(n);n&&(this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null)},setVisible:function(n){this[n?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(n,t){this._jsPlumb.overlayPositions[n.id]=t},getAbsoluteOverlayPosition:function(n){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[n.id]:null},_clazzManip:function(n,t,i){if(!i)for(var r in this._jsPlumb.overlays)this._jsPlumb.overlays[r][n+"Class"](t)},addClass:function(n,t){this._clazzManip("add",n,t)},removeClass:function(n,t){this._clazzManip("remove",n,t)}})}.call(typeof window!="undefined"?window:this),function(){"use strict";var i=this,n=i.jsPlumb,t=i.jsPlumbUtil,u=function(n,t,i){var r=!1;return{drag:function(){if(r)return r=!1,!0;if(t.element){var u=i.getUIPosition(arguments,i.getZoom());u!=null&&i.setPosition(t.element,u);i.repaint(t.element,u);n.paint({anchorPoint:n.anchor.getCurrentLocation({element:n})})}},stopDrag:function(){r=!0}}},f=function(n,t,i,r){var u=t.createElement("div",{position:"absolute"}),f;t.appendElement(u);f=t.getId(u);t.setPosition(u,i);u.style.width=r[0]+"px";u.style.height=r[1]+"px";t.manage(f,u,!0);n.id=f;n.element=u},e=function(t,i,r,u,f,e,o,s){var h=new n.FloatingAnchor({reference:i,referenceCanvas:u,jsPlumbInstance:e});return o({paintStyle:t,endpoint:r,anchor:h,source:f,scope:s})},r=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],o=function(n,t){var r=0,i;if(t!=null)for(i=0;i<n.connections.length;i++)if(n.connections[i].sourceId===t||n.connections[i].targetId===t){r=i;break}return n.connections[r]};n.Endpoint=function(i){var s=i._jsPlumb,d=i.newConnection,y=i.newEndpoint,h,c,l,a,v,p,w,b,k;return this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],n.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.appendToDefaultType({connectionType:i.connectionType,maxConnections:i.maxConnections==null?this._jsPlumb.instance.Defaults.MaxConnections:i.maxConnections,paintStyle:i.endpointStyle||i.paintStyle||i.style||this._jsPlumb.instance.Defaults.EndpointStyle||n.Defaults.EndpointStyle,hoverPaintStyle:i.endpointHoverStyle||i.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||n.Defaults.EndpointHoverStyle,connectorStyle:i.connectorStyle,connectorHoverStyle:i.connectorHoverStyle,connectorClass:i.connectorClass,connectorHoverClass:i.connectorHoverClass,connectorOverlays:i.connectorOverlays,connector:i.connector,connectorTooltip:i.connectorTooltip}),this._jsPlumb.enabled=!(i.enabled===!1),this._jsPlumb.visible=!0,this.element=n.getElement(i.source),this._jsPlumb.uuid=i.uuid,this._jsPlumb.floatingEndpoint=null,h=null,this._jsPlumb.uuid&&(i.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=i.elementId,this.dragProxy=i.dragProxy,this._jsPlumb.connectionCost=i.connectionCost,this._jsPlumb.connectionsDirected=i.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={},c=i.deleteOnEmpty===!0,this.setDeleteOnEmpty=function(n){c=n},l=function(){var i=s.endpointAnchorClassPrefix+"-"+this._jsPlumb.currentAnchorClass,t;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();t=s.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");this.removeClass(i);this.addClass(t);n.updateClasses(this.element,t,i)}.bind(this),this.prepareAnchor=function(n){var t=this._jsPlumb.instance.makeAnchor(n,this.elementId,s);return t.bind("anchorChanged",function(n){this.fire("anchorChanged",{endpoint:this,anchor:n});l()}.bind(this)),t},this.setPreparedAnchor=function(n,t){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=n,l(),t||this._jsPlumb.instance.repaint(this.elementId),this},this.setAnchor=function(n,t){var i=this.prepareAnchor(n);return this.setPreparedAnchor(i,t),this},a=function(n){if(this.connections.length>0)for(var t=0;t<this.connections.length;t++)this.connections[t].setHover(n,!1);else this.setHover(n)}.bind(this),this.bind("mouseover",function(){a(!0)}),this.bind("mouseout",function(){a(!1)}),i._transient||this._jsPlumb.instance.router.addEndpoint(this,this.elementId),this.prepareEndpoint=function(r,u){var o=function(t,i){var r=s.getRenderMode();if(n.Endpoints[r][t])return new n.Endpoints[r][t](i);if(!s.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+t+"'"};},f={_jsPlumb:this._jsPlumb.instance,cssClass:i.cssClass,container:i.container,tooltip:i.tooltip,connectorTooltip:i.connectorTooltip,endpoint:this},e;return t.isString(r)?e=o(r,f):t.isArray(r)?(f=t.merge(r[1],f),e=o(r[0],f)):e=r.clone(),e.clone=function(){return t.isString(r)?o(r,f):t.isArray(r)?(f=t.merge(r[1],f),o(r[0],f)):void 0}.bind(this),e.typeId=u,e},this.setEndpoint=function(n){var t=this.prepareEndpoint(n);this.setPreparedEndpoint(t,!0)},this.setPreparedEndpoint=function(n){this.endpoint!=null&&(this.endpoint.cleanup(),this.endpoint.destroy());this.endpoint=n;this.type=this.endpoint.type;this.canvas=this.endpoint.canvas},n.extend(this,i,r),this.isSource=i.isSource||!1,this.isTemporarySource=i.isTemporarySource||!1,this.isTarget=i.isTarget||!1,this.connections=i.connections||[],this.connectorPointerEvents=i["connector-pointer-events"],this.scope=i.scope||s.getDefaultScope(),this.timestamp=null,this.reattachConnections=i.reattach||s.Defaults.ReattachConnections,this.connectionsDetachable=s.Defaults.ConnectionsDetachable,(i.connectionsDetachable===!1||i.detachable===!1)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=i.dragAllowedWhenFull!==!1,i.onMaxConnections&&this.bind("maxConnections",i.onMaxConnections),this.addConnection=function(n){this.connections.push(n);this[(this.connections.length>0?"add":"remove")+"Class"](s.endpointConnectedClass);this[(this.isFull()?"add":"remove")+"Class"](s.endpointFullClass)},this.detachFromConnection=function(n,t,i){t=t==null?this.connections.indexOf(n):t;t>=0&&(this.connections.splice(t,1),this[(this.connections.length>0?"add":"remove")+"Class"](s.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](s.endpointFullClass));!i&&c&&this.connections.length===0&&s.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:i!==!0})},this.deleteEveryConnection=function(n){for(var i=this.connections.length,t=0;t<i;t++)s.deleteConnection(this.connections[0],n)},this.detachFrom=function(n){for(var r,u,i=[],t=0;t<this.connections.length;t++)(this.connections[t].endpoints[1]===n||this.connections[t].endpoints[0]===n)&&i.push(this.connections[t]);for(r=0,u=i.length;r<u;r++)s.deleteConnection(i[0]);return this},this.getElement=function(){return this.element},this.setElement=function(r){var u=this._jsPlumb.instance.getId(r),f=this.elementId;return t.removeWithFunction(i.endpointsByElement[this.elementId],function(n){return n.id===this.id}.bind(this)),this.element=n.getElement(r),this.elementId=s.getId(this.element),s.router.rehomeEndpoint(this,f,this.element),s.dragManager.endpointAdded(this.element),t.addToList(i.endpointsByElement,u,this),this},this.makeInPlaceCopy=function(){var n=this.anchor.getCurrentLocation({element:this}),t=this.anchor.getOrientation(this),r=this.anchor.getCssClass(),u={bind:function(){},compute:function(){return[n[0],n[1]]},getCurrentLocation:function(){return[n[0],n[1]]},getOrientation:function(){return t},getCssClass:function(){return r}};return y({dropOptions:i.dropOptions,anchor:u,source:this.element,paintStyle:this.getPaintStyle(),endpoint:i.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope,reference:this})},this.connectorSelector=function(){return this.connections[0]},this.setStyle=this.setPaintStyle,this.paint=function(n){var i,a,c,f,e,v,y,t,u,h;if(n=n||{},i=n.timestamp,a=!(n.recalc===!1),(!i||this.timestamp!==i)&&(c=s.updateOffset({elId:this.elementId,timestamp:i}),f=n.offset?n.offset.o:c.o,f!=null)){if(e=n.anchorPoint,v=n.connectorPaintStyle,e==null){if(y=n.dimensions||c.s,t={xy:[f.left,f.top],wh:y,element:this,timestamp:i},a&&this.anchor.isDynamic&&this.connections.length>0){var r=o(this,n.elementWithPrecedence),l=r.endpoints[0]===this?1:0,p=l===0?r.sourceId:r.targetId,w=s.getCachedData(p),b=w.o,k=w.s;t.index=l===0?1:0;t.connection=r;t.txy=[b.left,b.top];t.twh=k;t.tElement=r.endpoints[l];t.tRotation=s.getRotation(p)}else this.connections.length>0&&(t.connection=this.connections[0]);t.rotation=s.getRotation(this.elementId);e=this.anchor.compute(t)}this.endpoint.compute(e,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,v||this.paintStyleInUse);this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor);this.timestamp=i;for(u in this._jsPlumb.overlays)this._jsPlumb.overlays.hasOwnProperty(u)&&(h=this._jsPlumb.overlays[u],h.isVisible()&&(this._jsPlumb.overlayPlacements[u]=h.draw(this.endpoint,this._jsPlumb.paintStyleInUse),h.paint(this._jsPlumb.overlayPlacements[u])))}},this.getTypeDescriptor=function(){return"endpoint"},this.isVisible=function(){return this._jsPlumb.visible},this.repaint=this.paint,v=!1,this.initDraggable=function(){if(!v&&n.isDragSupported(this.element)){var c={id:null,element:null},r=null,p=!1,l=null,w=u(this,c,s),o=i.dragOptions||{},b=n.dragEvents.start,k=n.dragEvents.stop,g=n.dragEvents.drag,nt=n.dragEvents.beforeStart,a,tt=function(n){a=n.e.payload||{}},it=function(){var u,o,h,k,g,nt,tt,t,v;if(r=this.connectorSelector(),u=!0,this.isEnabled()||(u=!1),r!=null||this.isSource||this.isTemporarySource||(u=!1),!this.isSource||!this.isFull()||r!=null&&this.dragAllowedWhenFull||(u=!1),r==null||r.isDetachable(this)||(this.isFull()?u=!1:r=null),o=s.checkCondition(r==null?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:r}),o===!1?u=!1:typeof o=="object"?n.extend(o,a||{}):o=a||{},u===!1)return s.stopDrag&&s.stopDrag(this.canvas),w.stopDrag(),!1;for(h=0;h<this.connections.length;h++)this.connections[h].setHover(!1);this.addClass("endpointDrag");s.setConnectionBeingDragged(!0);r&&!this.isFull()&&this.isSource&&(r=null);s.updateOffset({elId:this.elementId});var it=this._jsPlumb.instance.getOffset(this.canvas),b=this.canvas,rt=this._jsPlumb.instance.getSize(this.canvas);f(c,s,it,rt);s.setAttributes(this.canvas,{dragId:c.id,elId:this.elementId});k=this.dragProxy||this.endpoint;this.dragProxy==null&&this.connectionType!=null&&(g=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType),g.endpoints[1]&&(k=g.endpoints[1]));nt=this._jsPlumb.instance.makeAnchor("Center");nt.isFloating=!0;this._jsPlumb.floatingEndpoint=e(this.getPaintStyle(),nt,k,this.canvas,c.element,s,y,this.scope);tt=this._jsPlumb.floatingEndpoint.anchor;r==null?(this.setHover(!1,!1),r=d({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.element,target:c.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:i.connectorStyle,hoverPaintStyle:i.connectorHoverStyle,connector:i.connector,overlays:i.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,scope:i.scope,data:o}),r.pending=!0,r.addClass(s.draggingClass),this._jsPlumb.floatingEndpoint.addClass(s.draggingClass),this._jsPlumb.floatingEndpoint.anchor=tt,s.fire("connectionDrag",r),s.router.newConnection(r)):(p=!0,r.setHover(!1),t=r.endpoints[0].id===this.id?0:1,this.detachFromConnection(r,null,!0),v=s.getDragScope(b),s.setAttribute(this.canvas,"originalScope",v),s.fire("connectionDrag",r),t===0?(l=[r.source,r.sourceId,b,v],s.router.sourceOrTargetChanged(r.endpoints[t].elementId,c.id,r,c.element,0)):(l=[r.target,r.targetId,b,v],s.router.sourceOrTargetChanged(r.endpoints[t].elementId,c.id,r,c.element,1)),r.suspendedEndpoint=r.endpoints[t],r.suspendedElement=r.endpoints[t].getElement(),r.suspendedElementId=r.endpoints[t].elementId,r.suspendedElementType=t===0?"source":"target",r.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=r.suspendedEndpoint,r.endpoints[t]=this._jsPlumb.floatingEndpoint,r.addClass(s.draggingClass),this._jsPlumb.floatingEndpoint.addClass(s.draggingClass));s.registerFloatingConnection(c,r,this._jsPlumb.floatingEndpoint);s.currentlyDragging=!0}.bind(this),rt=function(){var t,n,i;s.setConnectionBeingDragged(!1);r&&r.endpoints!=null&&(t=s.getDropEvent(arguments),n=s.getFloatingAnchorIndex(r),r.endpoints[n===0?1:0].anchor.locked=!1,r.removeClass(s.draggingClass),this._jsPlumb&&(r.deleteConnectionNow||r.endpoints[n]===this._jsPlumb.floatingEndpoint)&&p&&r.suspendedEndpoint&&(n===0?(r.floatingElement=r.source,r.floatingId=r.sourceId,r.floatingEndpoint=r.endpoints[0],r.floatingIndex=0,r.source=l[0],r.sourceId=l[1]):(r.floatingElement=r.target,r.floatingId=r.targetId,r.floatingEndpoint=r.endpoints[1],r.floatingIndex=1,r.target=l[0],r.targetId=l[1]),i=this._jsPlumb.floatingEndpoint,s.setDragScope(l[2],l[3]),r.endpoints[n]=r.suspendedEndpoint,r.isReattach()||r._forceReattach||r._forceDetach||!s.deleteConnection(r,{originalEvent:t})?(r.setHover(!1),r._forceDetach=null,r._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(r),r.suspendedEndpoint.addConnection(r),n===1?s.router.sourceOrTargetChanged(r.floatingId,r.targetId,r,r.target,n):s.router.sourceOrTargetChanged(r.floatingId,r.sourceId,r,r.source,n),s.repaint(l[1])):s.deleteObject({endpoint:i})),this.deleteAfterDragStop?s.deleteObject({endpoint:this}):this._jsPlumb&&this.paint({recalc:!1}),s.fire("connectionDragStop",r,t),r.pending&&s.fire("connectionAborted",r,t),s.currentlyDragging=!1,r.suspendedElement=null,r.suspendedEndpoint=null,r=null);c&&c.element&&s.remove(c.element,!1,!1);h&&s.deleteObject({endpoint:h});this._jsPlumb&&(this.canvas.style.visibility="visible",this.anchor.locked=!1,this._jsPlumb.floatingEndpoint=null)}.bind(this);o=n.extend({},o);o.scope=this.scope||o.scope;o[nt]=t.wrap(o[nt],tt,!1);o[b]=t.wrap(o[b],it,!1);o[g]=t.wrap(o[g],w.drag);o[k]=t.wrap(o[k],rt);o.multipleDrop=!1;o.canDrag=function(){return this.isSource||this.isTemporarySource||this.connections.length>0&&this.connectionsDetachable!==!1}.bind(this);s.initDraggable(this.canvas,o,"internal");this.canvas._jsPlumbRelatedElement=this.element;v=!0}},p=i.endpoint||this._jsPlumb.instance.Defaults.Endpoint||n.Defaults.Endpoint,this.setEndpoint(p,!0),w=i.anchor?i.anchor:i.anchors?i.anchors:s.Defaults.Anchor||"Top",this.setAnchor(w,!0),b=["default",i.type||""].join(" "),this.addType(b,i.data,!0),this.canvas=this.endpoint.canvas,this.canvas._jsPlumb=this,this.initDraggable(),k=function(r,u,f,e){var o;if(n.isDropSupported(this.element)){o=i.dropOptions||s.Defaults.DropOptions||n.Defaults.DropOptions;o=n.extend({},o);o.scope=o.scope||this.scope;var c=n.dragEvents.drop,l=n.dragEvents.over,a=n.dragEvents.out,h=this,v=s.EndpointDropHandler({getEndpoint:function(){return h},jsPlumb:s,enabled:function(){return f!=null?f.isEnabled():!0},isFull:function(){return f.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(n){h.addClass(n)},removeClass:function(n){h.removeClass(n)},isDropAllowed:function(){return h.isDropAllowed.apply(h,arguments)},reference:e,isRedrop:function(n,t){return n.suspendedEndpoint&&t.reference&&n.suspendedEndpoint.id===t.reference.id}});o[c]=t.wrap(o[c],v,!0);o[l]=t.wrap(o[l],function(){var f=n.getDragObject(arguments),e=s.getAttribute(n.getElement(f),"dragId"),t=s.getFloatingConnectionFor(e),i,u,r;t!=null&&(i=s.getFloatingAnchorIndex(t),u=this.isTarget&&i!==0||t.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===t.suspendedEndpoint.id,u&&(r=s.checkCondition("checkDropAllowed",{sourceEndpoint:t.endpoints[i],targetEndpoint:this,connection:t}),this[(r?"add":"remove")+"Class"](s.endpointDropAllowedClass),this[(r?"remove":"add")+"Class"](s.endpointDropForbiddenClass),t.endpoints[i].anchor.over(this.anchor,this)))}.bind(this));o[a]=t.wrap(o[a],function(){var r=n.getDragObject(arguments),u=r==null?null:s.getAttribute(n.getElement(r),"dragId"),t=u?s.getFloatingConnectionFor(u):null,i,f;t!=null&&(i=s.getFloatingAnchorIndex(t),f=this.isTarget&&i!==0||t.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===t.suspendedEndpoint.id,f&&(this.removeClass(s.endpointDropAllowedClass),this.removeClass(s.endpointDropForbiddenClass),t.endpoints[i].anchor.out()))}.bind(this));s.initDroppable(r,o,"internal",u)}}.bind(this),this.anchor.isFloating||k(this.canvas,!(i._transient||this.anchor.isFloating),this,i.reference),this};t.extend(n.Endpoint,n.OverlayCapableJsPlumbUIComponent,{setVisible:function(n,t,i){var r,u;if(this._jsPlumb.visible=n,this.canvas&&(this.canvas.style.display=n?"block":"none"),this[n?"showOverlays":"hideOverlays"](),!t)for(r=0;r<this.connections.length;r++)this.connections[r].setVisible(n),i||(u=this===this.connections[r].endpoints[0]?1:0,this.connections[r].endpoints[u].connections.length===1&&this.connections[r].endpoints[u].setVisible(n,!0,!0))},getAttachedElements:function(){return this.connections},applyType:function(t,i){this.setPaintStyle(t.endpointStyle||t.paintStyle,i);this.setHoverPaintStyle(t.endpointHoverStyle||t.hoverPaintStyle,i);t.maxConnections!=null&&(this._jsPlumb.maxConnections=t.maxConnections);t.scope&&(this.scope=t.scope);n.extend(this,t,r);t.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,t.cssClass);n.OverlayCapableJsPlumbUIComponent.applyType(this,t)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(n){this._jsPlumb.enabled=n},cleanup:function(){var t=this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");n.removeClass(this.element,t);this.anchor=null;this.endpoint.cleanup(!0);this.endpoint.destroy();this.endpoint=null;this._jsPlumb.instance.destroyDraggable(this.canvas,"internal");this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(n){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(n)},isFull:function(){return this._jsPlumb.maxConnections===0?!0:!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return this.anchor!=null&&this.anchor.isFloating},isConnectedTo:function(n){var i=!1,t;if(n)for(t=0;t<this.connections.length;t++)if(this.connections[t].endpoints[1]===n||this.connections[t].endpoints[0]===n){i=!0;break}return i},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(n){this._jsPlumb.connectionCost=n},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(n){this._jsPlumb.connectionsDirected=n},setElementId:function(n){this.elementId=n;this.anchor.elementId=n},setReferenceElement:function(t){this.element=n.getElement(t)},setDragAllowedWhenFull:function(n){this.dragAllowedWhenFull=n},equals:function(n){return this.anchor.equals(n.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(n){return this.anchor.compute(n)}});i.jsPlumbInstance.prototype.EndpointDropHandler=function(n){return function(i){var u=n.jsPlumb,h,e,f,l,o,v,y;n.removeClass(u.endpointDropAllowedClass);n.removeClass(u.endpointDropForbiddenClass);var c=u.getDropEvent(arguments),s=u.getDragObject(arguments),p=u.getAttribute(s,"dragId"),w=u.getAttribute(s,"elId"),a=u.getAttribute(s,"originalScope"),r=u.getFloatingConnectionFor(p);if(r!=null&&(h=r.suspendedEndpoint!=null,!h||r.suspendedEndpoint._jsPlumb!=null)&&(e=n.getEndpoint(r),e!=null)){if(n.isRedrop(r,n)){r._forceReattach=!0;r.setHover(!1);n.maybeCleanup&&n.maybeCleanup(e);return}if(f=u.getFloatingAnchorIndex(r),f===0&&!n.isSource||f===1&&!n.isTarget){n.maybeCleanup&&n.maybeCleanup(e);return}if(n.onDrop)n.onDrop(r);if(a&&u.setDragScope(s,a),l=n.isFull(i),l&&e.fire("maxConnections",{endpoint:this,connection:r,maxConnections:e._jsPlumb.maxConnections},c),!l&&n.enabled()){if(o=!0,f===0?(r.floatingElement=r.source,r.floatingId=r.sourceId,r.floatingEndpoint=r.endpoints[0],r.floatingIndex=0,r.source=n.element,r.sourceId=u.getId(n.element)):(r.floatingElement=r.target,r.floatingId=r.targetId,r.floatingEndpoint=r.endpoints[1],r.floatingIndex=1,r.target=n.element,r.targetId=u.getId(n.element)),h&&r.suspendedEndpoint.id!==e.id&&(r.isDetachAllowed(r)&&r.endpoints[f].isDetachAllowed(r)&&r.suspendedEndpoint.isDetachAllowed(r)&&u.checkCondition("beforeDetach",r)||(o=!1)),v=function(i){var o,s,l,a;r.endpoints[f].detachFromConnection(r);r.suspendedEndpoint&&r.suspendedEndpoint.detachFromConnection(r);r.endpoints[f]=e;e.addConnection(r);o=e.getParameters();for(s in o)r.setParameter(s,o[s]);h?(l=r.suspendedEndpoint.elementId,u.fireMoveEvent({index:f,originalSourceId:f===0?l:r.sourceId,newSourceId:f===0?e.elementId:r.sourceId,originalTargetId:f===1?l:r.targetId,newTargetId:f===1?e.elementId:r.targetId,originalSourceEndpoint:f===0?r.suspendedEndpoint:r.endpoints[0],newSourceEndpoint:f===0?e:r.endpoints[0],originalTargetEndpoint:f===1?r.suspendedEndpoint:r.endpoints[1],newTargetEndpoint:f===1?e:r.endpoints[1],connection:r},c)):o.draggable&&u.initDraggable(this.element,n.dragOptions,"internal",u);f===1?u.router.sourceOrTargetChanged(r.floatingId,r.targetId,r,r.target,1):u.router.sourceOrTargetChanged(r.floatingId,r.sourceId,r,r.source,0);r.endpoints[0].finalEndpoint&&(a=r.endpoints[0],a.detachFromConnection(r),r.endpoints[0]=r.endpoints[0].finalEndpoint,r.endpoints[0].addConnection(r));t.isObject(i)&&r.mergeData(i);u.finaliseConnection(r,null,c,!1);r.setHover(!1);u.revalidate(r.endpoints[0].element)}.bind(this),y=function(){r.suspendedEndpoint&&(r.endpoints[f]=r.suspendedEndpoint,r.setHover(!1),r._forceDetach=!0,f===0?(r.source=r.suspendedEndpoint.element,r.sourceId=r.suspendedEndpoint.elementId):(r.target=r.suspendedEndpoint.element,r.targetId=r.suspendedEndpoint.elementId),r.suspendedEndpoint.addConnection(r),f===1?u.router.sourceOrTargetChanged(r.floatingId,r.targetId,r,r.target,1):u.router.sourceOrTargetChanged(r.floatingId,r.sourceId,r,r.source,0),u.repaint(r.sourceId),r._forceDetach=!1)},o=o&&n.isDropAllowed(r.sourceId,r.targetId,r.scope,r,e),o)return v(o),!0;y()}n.maybeCleanup&&n.maybeCleanup(e);u.currentlyDragging=!1}}}}.call(typeof window!="undefined"?window:this),function(){"use strict";var i=this,n=i.jsPlumb,t=i.jsPlumbUtil,u=function(i,r,u,f,e){if(n.Connectors[r]=n.Connectors[r]||{},n.Connectors[r][u]==null){if(n.Connectors[u]==null){if(i.Defaults.DoNotThrowErrors)return null;throw new TypeError("jsPlumb: unknown connector type '"+u+"'");}n.Connectors[r][u]=function(){n.Connectors[u].apply(this,arguments);n.ConnectorRenderers[r].apply(this,arguments)};t.extend(n.Connectors[r][u],[n.Connectors[u],n.ConnectorRenderers[r]])}return new n.Connectors[r][u](f,e)},r=function(n,t,i){return n?i.makeAnchor(n,t,i):null},f=function(n,i,r,u){i!=null&&(i._jsPlumbConnections=i._jsPlumbConnections||{},u?delete i._jsPlumbConnections[n.id]:i._jsPlumbConnections[n.id]=!0,t.isEmpty(i._jsPlumbConnections)?r.removeClass(i,r.connectedClass):r.addClass(i,r.connectedClass))};n.Connection=function(i){var g=i.newEndpoint,r,c,l,u,y,p,h,f,v;if(this.id=i.id,this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=i.previousConnection,this.source=n.getElement(i.source),this.target=n.getElement(i.target),n.OverlayCapableJsPlumbUIComponent.apply(this,arguments),i.sourceEndpoint?(this.source=i.sourceEndpoint.getElement(),this.sourceId=i.sourceEndpoint.elementId):this.sourceId=this._jsPlumb.instance.getId(this.source),i.targetEndpoint?(this.target=i.targetEndpoint.getElement(),this.targetId=i.targetEndpoint.elementId):this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=i.scope,this.endpoints=[],this.endpointStyles=[],r=this._jsPlumb.instance,r.manage(this.sourceId,this.source),r.manage(this.targetId,this.target),this._jsPlumb.visible=!0,this._jsPlumb.params={cssClass:i.cssClass,container:i.container,"pointer-events":i["pointer-events"],editorParams:i.editorParams,overlays:i.overlays},this._jsPlumb.lastPaintedAt=null,this.bind("mouseover",function(){this.setHover(!0)}.bind(this)),this.bind("mouseout",function(){this.setHover(!1)}.bind(this)),this.makeEndpoint=function(n,t,u,f,e){return u=u||this._jsPlumb.instance.getId(t),this.prepareEndpoint(r,g,this,f,n?0:1,i,t,u,e)},i.type&&(i.endpoints=i.endpoints||this._jsPlumb.instance.deriveEndpointAndAnchorSpec(i.type).endpoints),c=this.makeEndpoint(!0,this.source,this.sourceId,i.sourceEndpoint),l=this.makeEndpoint(!1,this.target,this.targetId,i.targetEndpoint),c&&t.addToList(i.endpointsByElement,this.sourceId,c),l&&t.addToList(i.endpointsByElement,this.targetId,l),this.scope||(this.scope=this.endpoints[0].scope),i.deleteEndpointsOnEmpty!=null&&(this.endpoints[0].setDeleteOnEmpty(i.deleteEndpointsOnEmpty),this.endpoints[1].setDeleteOnEmpty(i.deleteEndpointsOnEmpty)),u=r.Defaults.ConnectionsDetachable,i.detachable===!1&&(u=!1),this.endpoints[0].connectionsDetachable===!1&&(u=!1),this.endpoints[1].connectionsDetachable===!1&&(u=!1),y=i.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||r.Defaults.ReattachConnections,this.appendToDefaultType({detachable:u,reattach:y,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||i.paintStyle||r.Defaults.PaintStyle||n.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||i.hoverPaintStyle||r.Defaults.HoverPaintStyle||n.Defaults.HoverPaintStyle}),p=r.getSuspendedAt(),!r.isSuspendDrawing()){var w=r.getCachedData(this.sourceId),e=w.o,b=w.s,k=r.getCachedData(this.targetId),o=k.o,d=k.s,s=p||jsPlumbUtil.uuid(),a=this.endpoints[0].anchor.compute({xy:[e.left,e.top],wh:b,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[o.left,o.top],twh:d,tElement:this.endpoints[1],timestamp:s,rotation:r.getRotation(this.endpoints[0].elementId)});this.endpoints[0].paint({anchorLoc:a,timestamp:s});a=this.endpoints[1].anchor.compute({xy:[o.left,o.top],wh:d,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[e.left,e.top],twh:b,tElement:this.endpoints[0],timestamp:s,rotation:r.getRotation(this.endpoints[1].elementId)});this.endpoints[1].paint({anchorLoc:a,timestamp:s})}this.getTypeDescriptor=function(){return"connection"};this.getAttachedElements=function(){return this.endpoints};this.isDetachable=function(n){return this._jsPlumb.detachable===!1?!1:n!=null?n.connectionsDetachable===!0:this._jsPlumb.detachable===!0};this.setDetachable=function(n){this._jsPlumb.detachable=n===!0};this.isReattach=function(){return this._jsPlumb.reattach===!0||this.endpoints[0].reattachConnections===!0||this.endpoints[1].reattachConnections===!0};this.setReattach=function(n){this._jsPlumb.reattach=n===!0};this._jsPlumb.cost=i.cost||this.endpoints[0].getConnectionCost();this._jsPlumb.directed=i.directed;i.directed==null&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());h=n.extend({},this.endpoints[1].getParameters());n.extend(h,this.endpoints[0].getParameters());n.extend(h,this.getParameters());this.setParameters(h);this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||i.connector||r.Defaults.Connector||n.Defaults.Connector,!0);f=i.data==null||!t.isObject(i.data)?{}:i.data;this.getData=function(){return f};this.setData=function(n){f=n||{}};this.mergeData=function(t){f=n.extend(f,t)};v=["default",this.endpoints[0].connectionType,this.endpoints[1].connectionType,i.type].join(" ");/[^\s]/.test(v)&&this.addType(v,i.data,!0);this.updateConnectedClass()};t.extend(n.Connection,n.OverlayCapableJsPlumbUIComponent,{applyType:function(t,i,r){var f=null,u;t.connector!=null&&(f=this.getCachedTypeItem("connector",r.connector),f==null&&(f=this.prepareConnector(t.connector,r.connector),this.cacheTypeItem("connector",f,r.connector)),this.setPreparedConnector(f));t.detachable!=null&&this.setDetachable(t.detachable);t.reattach!=null&&this.setReattach(t.reattach);t.scope&&(this.scope=t.scope);t.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,t.cssClass);u=null;t.anchor?(u=this.getCachedTypeItem("anchors",r.anchor),u==null&&(u=[this._jsPlumb.instance.makeAnchor(t.anchor),this._jsPlumb.instance.makeAnchor(t.anchor)],this.cacheTypeItem("anchors",u,r.anchor))):t.anchors&&(u=this.getCachedTypeItem("anchors",r.anchors),u==null&&(u=[this._jsPlumb.instance.makeAnchor(t.anchors[0]),this._jsPlumb.instance.makeAnchor(t.anchors[1])],this.cacheTypeItem("anchors",u,r.anchors)));u!=null&&(this.endpoints[0].anchor=u[0],this.endpoints[1].anchor=u[1],this.endpoints[1].anchor.isDynamic&&this._jsPlumb.instance.repaint(this.endpoints[1].elementId));n.OverlayCapableJsPlumbUIComponent.applyType(this,t)},addClass:function(n,t){t&&(this.endpoints[0].addClass(n),this.endpoints[1].addClass(n),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(n));this.connector&&this.connector.addClass(n)},removeClass:function(n,t){t&&(this.endpoints[0].removeClass(n),this.endpoints[1].removeClass(n),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(n));this.connector&&this.connector.removeClass(n)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(n){this._jsPlumb.visible=n;this.connector&&this.connector.setVisible(n);this.repaint()},cleanup:function(){this.updateConnectedClass(!0);this.endpoints=null;this.source=null;this.target=null;this.connector!=null&&(this.connector.cleanup(!0),this.connector.destroy(!0));this.connector=null},updateConnectedClass:function(n){this._jsPlumb&&(f(this,this.source,this._jsPlumb.instance,n),f(this,this.target,this._jsPlumb.instance,n))},setHover:function(n){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(n),i.jsPlumb[n?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),i.jsPlumb[n?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb?this._jsPlumb.cost:-Infinity},setCost:function(n){this._jsPlumb.cost=n},isDirected:function(){return this._jsPlumb.directed},getConnector:function(){return this.connector},prepareConnector:function(n,i){var f={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},e=this._jsPlumb.instance.getRenderMode(),r;return t.isString(n)?r=u(this._jsPlumb.instance,e,n,f,this):t.isArray(n)&&(r=n.length===1?u(this._jsPlumb.instance,e,n[0],f,this):u(this._jsPlumb.instance,e,n[0],t.merge(n[1],f),this)),i!=null&&(r.typeId=i),r},setPreparedConnector:function(n,t,i,r){var e,o,f,u;if(this.connector!==n){if(o="",this.connector!=null&&(e=this.connector,o=e.getClass(),this.connector.cleanup(),this.connector.destroy()),this.connector=n,r&&this.cacheTypeItem("connector",n,r),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this.connector.reattach(this._jsPlumb.instance),this.addClass(o),this.canvas&&(this.canvas._jsPlumb=this),this.bgCanvas&&(this.bgCanvas._jsPlumb=this),e!=null)for(f=this.getOverlays(),u=0;u<f.length;u++)f[u].transfer&&f[u].transfer(this.connector);i||this.setListenerComponent(this.connector);t||this.repaint()}},setConnector:function(n,t,i,r){var u=this.prepareConnector(n,r);this.setPreparedConnector(u,t,i,r)},paint:function(n){var t,i,h,a,y;if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){n=n||{};var r=n.timestamp,e=!1,b=e?this.sourceId:this.targetId,k=e?this.targetId:this.sourceId,p=e?0:1,w=e?1:0;if(r==null||r!==this._jsPlumb.lastPaintedAt){var u=this._jsPlumb.instance.updateOffset({elId:k}).o,f=this._jsPlumb.instance.updateOffset({elId:b}).o,o=this.endpoints[w],s=this.endpoints[p],d=o.anchor.getCurrentLocation({xy:[u.left,u.top],wh:[u.width,u.height],element:o,timestamp:r,rotation:this._jsPlumb.instance.getRotation(this.sourceId)}),g=s.anchor.getCurrentLocation({xy:[f.left,f.top],wh:[f.width,f.height],element:s,timestamp:r,rotation:this._jsPlumb.instance.getRotation(this.targetId)});this.connector.resetBounds();this.connector.compute({sourcePos:d,targetPos:g,sourceOrientation:o.anchor.getOrientation(o),targetOrientation:s.anchor.getOrientation(s),sourceEndpoint:this.endpoints[w],targetEndpoint:this.endpoints[p],"stroke-width":this._jsPlumb.paintStyleInUse.strokeWidth,sourceInfo:u,targetInfo:f});t={minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity};for(i in this._jsPlumb.overlays)this._jsPlumb.overlays.hasOwnProperty(i)&&(h=this._jsPlumb.overlays[i],h.isVisible()&&(this._jsPlumb.overlayPlacements[i]=h.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(h)),t.minX=Math.min(t.minX,this._jsPlumb.overlayPlacements[i].minX),t.maxX=Math.max(t.maxX,this._jsPlumb.overlayPlacements[i].maxX),t.minY=Math.min(t.minY,this._jsPlumb.overlayPlacements[i].minY),t.maxY=Math.max(t.maxY,this._jsPlumb.overlayPlacements[i].maxY)));var c=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||1)/2,l=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||0),v={xmin:Math.min(this.connector.bounds.minX-(c+l),t.minX),ymin:Math.min(this.connector.bounds.minY-(c+l),t.minY),xmax:Math.max(this.connector.bounds.maxX+(c+l),t.maxX),ymax:Math.max(this.connector.bounds.maxY+(c+l),t.maxY)};this.connector.paintExtents=v;this.connector.paint(this._jsPlumb.paintStyleInUse,null,v);for(a in this._jsPlumb.overlays)this._jsPlumb.overlays.hasOwnProperty(a)&&(y=this._jsPlumb.overlays[a],y.isVisible()&&y.paint(this._jsPlumb.overlayPlacements[a],v))}this._jsPlumb.lastPaintedAt=r}},repaint:function(n){var t=jsPlumb.extend(n||{},{});t.elId=this.sourceId;this.paint(t)},prepareEndpoint:function(t,i,u,f,e,o,s,h,c){var v,y,l,a,p,w;return f?(u.endpoints[e]=f,f.addConnection(u)):(o.endpoints||(o.endpoints=[null,null]),y=c||o.endpoints[e]||o.endpoint||t.Defaults.Endpoints[e]||n.Defaults.Endpoints[e]||t.Defaults.Endpoint||n.Defaults.Endpoint,o.endpointStyles||(o.endpointStyles=[null,null]),o.endpointHoverStyles||(o.endpointHoverStyles=[null,null]),l=o.endpointStyles[e]||o.endpointStyle||t.Defaults.EndpointStyles[e]||n.Defaults.EndpointStyles[e]||t.Defaults.EndpointStyle||n.Defaults.EndpointStyle,l.fill==null&&o.paintStyle!=null&&(l.fill=o.paintStyle.stroke),l.outlineStroke==null&&o.paintStyle!=null&&(l.outlineStroke=o.paintStyle.outlineStroke),l.outlineWidth==null&&o.paintStyle!=null&&(l.outlineWidth=o.paintStyle.outlineWidth),a=o.endpointHoverStyles[e]||o.endpointHoverStyle||t.Defaults.EndpointHoverStyles[e]||n.Defaults.EndpointHoverStyles[e]||t.Defaults.EndpointHoverStyle||n.Defaults.EndpointHoverStyle,o.hoverPaintStyle!=null&&(a==null&&(a={}),a.fill==null&&(a.fill=o.hoverPaintStyle.stroke)),p=o.anchors?o.anchors[e]:o.anchor?o.anchor:r(t.Defaults.Anchors[e],h,t)||r(n.Defaults.Anchors[e],h,t)||r(t.Defaults.Anchor,h,t)||r(n.Defaults.Anchor,h,t),w=o.uuids?o.uuids[e]:null,v=i({paintStyle:l,hoverPaintStyle:a,endpoint:y,connections:[u],uuid:w,anchor:p,source:s,scope:o.scope,reattach:o.reattach||t.Defaults.ReattachConnections,detachable:o.detachable||t.Defaults.ConnectionsDetachable}),f==null&&v.setDeleteOnEmpty(!0),u.endpoints[e]=v,o.drawEndpoints===!1&&v.setVisible(!1,!0,!0)),v},replaceEndpoint:function(n,t){var i=this.endpoints[n],u=i.elementId,f=this._jsPlumb.instance.getEndpoints(u),e=f.indexOf(i),r=this.makeEndpoint(n===0,i.element,u,null,t);this.endpoints[n]=r;f.splice(e,1,r);this._jsPlumb.instance.deleteObject({endpoint:i,deleteAttachedObjects:!1});this._jsPlumb.instance.fire("endpointReplaced",{previous:i,current:r});this._jsPlumb.instance.router.sourceOrTargetChanged(this.endpoints[1].elementId,this.endpoints[1].elementId,this,this.endpoints[1].element,1)}})}.call(typeof window!="undefined"?window:this),function(){"use strict";var u=this,n=u.jsPlumbUtil,t=u.jsPlumb,f,i,r;t.AnchorManager=function(i){var e={},c={},a={},r={},s=this,u={},f=i.jsPlumbInstance,l={},w=function(n,t,i,r,u,f,e,o){for(var h,c,v,y=[],b=t[u?0:1]/(r.length+1),s=0;s<r.length;s++){h=(s+1)*b;c=f*t[u?1:0];e&&(h=t[u?0:1]-h);var p=u?h:c,l=i.left+p,k=p/t[0],w=u?c:h,a=i.top+w,d=w/t[1];o!==0&&(v=jsPlumbUtil.rotatePoint([l,a],[i.centerx,i.centery],o),l=v[0],a=v[1]);y.push([l,a,k,d,r[s][1],r[s][2]])}return y},v=function(n,t){return t[0][0]-n[0][0]},y=function(n,t){var i=n[0][0]<0?-Math.PI-n[0][0]:Math.PI-n[0][0],r=t[0][0]<0?-Math.PI-t[0][0]:Math.PI-t[0][0];return i-r},b={top:y,right:v,bottom:v,left:y},k=function(n,t){return n.sort(t)},d=function(n,t){var e=f.getCachedData(n),i=e.s,r=e.o,u=function(t,i,r,u,e,o,s){var h;if(u.length>0){var p=k(u,b[t]),d=t==="right"||t==="top",g=f.getRotation(n),l=w(t,i,r,p,e,o,d,g),y=function(n,t){c[n.id]=[t[0],t[1],t[2],t[3]];a[n.id]=s};for(h=0;h<l.length;h++){var v=l[h][4],nt=v.endpoints[0].elementId===n,tt=v.endpoints[1].elementId===n;nt&&y(v.endpoints[0],l[h]);tt&&y(v.endpoints[1],l[h])}}};u("bottom",i,r,t.bottom,!0,1,[0,1]);u("top",i,r,t.top,!0,0,[0,-1]);u("left",i,r,t.left,!1,0,[-1,0]);u("right",i,r,t.right,!1,1,[1,0])},h,o,p;this.reset=function(){e={};r={};u={}};this.addFloatingConnection=function(n,t){l[n]=t};this.newConnection=function(i){var f=i.sourceId,e=i.targetId,u=i.endpoints,o=!0,s=function(s,h,c,l,a){f===e&&c.isContinuous&&(i._jsPlumb.instance.removeElement(u[1].canvas),o=!1);n.addToList(r,l,[a,h,c.constructor===t.DynamicAnchor])};s(0,u[0],u[0].anchor,e,i);o&&s(1,u[1],u[1].anchor,f,i)};h=function(t){(function(t,i){if(t){var r=function(n){return n[4]===i};n.removeWithFunction(t.top,r);n.removeWithFunction(t.left,r);n.removeWithFunction(t.bottom,r);n.removeWithFunction(t.right,r)}})(u[t.elementId],t.id)};this.connectionDetached=function(t,i){var u=t.connection||t,o=t.sourceId,c=t.targetId,f=u.endpoints,e=function(t,i,u,f,e){n.removeWithFunction(r[f],function(n){return n[0].id===e.id})};e(1,f[1],f[1].anchor,o,u);e(0,f[0],f[0].anchor,c,u);u.floatingId&&(e(u.floatingIndex,u.floatingEndpoint,u.floatingEndpoint.anchor,u.floatingId,u),h(u.floatingEndpoint));h(u.endpoints[0]);h(u.endpoints[1]);i||(s.redraw(u.sourceId),u.targetId!==u.sourceId&&s.redraw(u.targetId))};this.addEndpoint=function(t,i){n.addToList(e,i,t)};this.changeId=function(n,t){r[t]=r[n];e[t]=e[n];delete r[n];delete e[n]};this.getConnectionsFor=function(n){return r[n]||[]};this.getEndpointsFor=function(n){return e[n]||[]};this.deleteEndpoint=function(t){n.removeWithFunction(e[t.elementId],function(n){return n.id===t.id});h(t)};this.elementRemoved=function(n){delete l[n];delete e[n];e[n]=[]};o=function(t,r,u,f,e,o,s,h,c,l,a,v){var tt=-1,k=-1,d=f.endpoints[s],it=d.id,g=[1,0][s],rt=[[r,u],f,e,o,it],w=t[c],b=d._continuousAnchorEdge?t[d._continuousAnchorEdge]:null,y,p,nt,ut;if(b&&(nt=n.findWithFunction(b,function(n){return n[4]===it}),nt!==-1))for(b.splice(nt,1),y=0;y<b.length;y++)p=b[y][1],n.addWithFunction(a,p,function(n){return n.id===p.id}),n.addWithFunction(v,b[y][1].endpoints[s],function(n){return n.id===p.endpoints[s].id}),n.addWithFunction(v,b[y][1].endpoints[g],function(n){return n.id===p.endpoints[g].id});for(y=0;y<w.length;y++)p=w[y][1],i.idx===1&&w[y][3]===o&&k===-1&&(k=y),n.addWithFunction(a,p,function(n){return n.id===p.id}),n.addWithFunction(v,w[y][1].endpoints[s],function(n){return n.id===p.endpoints[s].id}),n.addWithFunction(v,w[y][1].endpoints[g],function(n){return n.id===p.endpoints[g].id});tt!==-1?w[tt]=rt:(ut=h?k!==-1?k:0:w.length,w.splice(ut,0,rt));d._continuousAnchorEdge=c};this.sourceOrTargetChanged=function(i,u,f,e,o){var s,h,c,l;o===0?i!==u&&(f.sourceId=u,f.source=e,n.removeWithFunction(r[i],function(n){return n[0].id===f.id}),s=n.findWithFunction(r[f.targetId],function(n){return n[0].id===f.id}),s>-1&&(r[f.targetId][s][0]=f,r[f.targetId][s][1]=f.endpoints[0],r[f.targetId][s][2]=f.endpoints[0].anchor.constructor===t.DynamicAnchor),n.addToList(r,u,[f,f.endpoints[1],f.endpoints[1].anchor.constructor===t.DynamicAnchor]),f.endpoints[1].anchor.isContinuous&&(f.source===f.target?f._jsPlumb.instance.removeElement(f.endpoints[1].canvas):f.endpoints[1].canvas.parentNode==null&&f._jsPlumb.instance.appendElement(f.endpoints[1].canvas)),f.updateConnectedClass()):o===1&&(h=f.endpoints[0].elementId,f.target=e,f.targetId=u,c=n.findWithFunction(r[h],function(n){return n[0].id===f.id}),l=n.findWithFunction(r[i],function(n){return n[0].id===f.id}),c!==-1&&(r[h][c][0]=f,r[h][c][1]=f.endpoints[1],r[h][c][2]=f.endpoints[1].anchor.constructor===t.DynamicAnchor),l>-1&&(r[i].splice(l,1),n.addToList(r,u,[f,f.endpoints[0],f.endpoints[0].anchor.constructor===t.DynamicAnchor])),f.updateConnectedClass())};this.rehomeEndpoint=function(n,t,i){var o=e[t]||[],h=f.getId(i),u,c,r;for(h!==t&&(u=o.indexOf(n),u>-1&&(c=o.splice(u,1)[0],s.add(c,h))),r=0;r<n.connections.length;r++)n.connections[r].sourceId===t?s.sourceOrTargetChanged(t,n.elementId,n.connections[r],n.element,0):n.connections[r].targetId===t&&s.sourceOrTargetChanged(t,n.elementId,n.connections[r],n.element,1)};this.redraw=function(i,s,h,c,a,v){var k=[],g=[],ut=[],tt,nt,ht,ct,y,yt,pt,lt,rt,ot,at;if(!f.isSuspendDrawing()){for(tt=e[i]||[],nt=r[i]||[],h=h||jsPlumbUtil.uuid(),c=c||{left:0,top:0},s&&(s={left:s.left+c.left,top:s.top+c.top}),ht=f.updateOffset({elId:i,offset:s,recalc:!1,timestamp:h}),ct={},y=0;y<nt.length;y++){var b=nt[y][0],p=b.sourceId,w=b.targetId,ft=b.endpoints[0].anchor.isContinuous,et=b.endpoints[1].anchor.isContinuous;if(ft||et){var vt=p+"_"+w,it=ct[vt],st=b.sourceId===i?1:0,wt=f.getRotation(w),bt=f.getRotation(p);ft&&!u[p]&&(u[p]={top:[],right:[],bottom:[],left:[]});et&&!u[w]&&(u[w]={top:[],right:[],bottom:[],left:[]});i!==w&&f.updateOffset({elId:w,timestamp:h});i!==p&&f.updateOffset({elId:p,timestamp:h});yt=f.getCachedData(w);pt=f.getCachedData(p);w===p&&(ft||et)?(o(u[p],-Math.PI/2,0,b,!1,w,0,!1,"top",p,k,g),o(u[w],-Math.PI/2,0,b,!1,p,1,!1,"top",w,k,g)):(it||(it=this.calculateOrientation(p,w,pt.o,yt.o,b.endpoints[0].anchor,b.endpoints[1].anchor,b,bt,wt),ct[vt]=it),ft&&o(u[p],it.theta,0,b,!1,w,0,!1,it.a[0],p,k,g),et&&o(u[w],it.theta2,-1,b,!0,p,1,!0,it.a[1],w,k,g));ft&&n.addWithFunction(ut,p,function(n){return n===p});et&&n.addWithFunction(ut,w,function(n){return n===w});n.addWithFunction(k,b,function(n){return n.id===b.id});(ft&&st===0||et&&st===1)&&n.addWithFunction(g,b.endpoints[st],function(n){return n.id===b.endpoints[st].id})}}for(y=0;y<tt.length;y++)tt[y].connections.length===0&&tt[y].anchor.isContinuous&&(u[i]||(u[i]={top:[],right:[],bottom:[],left:[]}),o(u[i],-Math.PI/2,0,{endpoints:[tt[y],tt[y]],paint:function(){}},!1,i,0,!1,tt[y].anchor.getDefaultFace(),i,k,g),n.addWithFunction(ut,i,function(n){return n===i}));for(y=0;y<ut.length;y++)d(ut[y],u[ut[y]]);for(y=0;y<tt.length;y++)tt[y].paint({timestamp:h,offset:ht,dimensions:ht.s,recalc:v!==!0});for(y=0;y<g.length;y++)lt=f.getCachedData(g[y].elementId),g[y].paint({timestamp:null,offset:lt,dimensions:lt.s});for(y=0;y<nt.length;y++)if(rt=nt[y][1],rt.anchor.constructor===t.DynamicAnchor)for(rt.paint({elementWithPrecedence:i,timestamp:h}),n.addWithFunction(k,nt[y][0],function(n){return n.id===nt[y][0].id}),ot=0;ot<rt.connections.length;ot++)rt.connections[ot]!==nt[y][0]&&n.addWithFunction(k,rt.connections[ot],function(n){return n.id===rt.connections[ot].id});else n.addWithFunction(k,nt[y][0],function(n){return n.id===nt[y][0].id});for(at=l[i],at&&at.paint({timestamp:h,recalc:!1,elId:i}),y=0;y<k.length;y++)k[y].paint({elId:i,timestamp:null,recalc:!1,clearEdits:a})}return{c:k,e:g}};p=function(t){var o;n.EventGenerator.apply(this);this.type="Continuous";this.isDynamic=!0;this.isContinuous=!0;var f=t.faces||["top","right","bottom","left"],s=!(t.clockwise===!1),i={},h={top:"bottom",right:"left",left:"right",bottom:"top"},l={top:"right",right:"bottom",left:"top",bottom:"left"},v={top:"left",right:"top",left:"bottom",bottom:"right"},y=s?l:v,p=s?v:l,w=t.cssClass||"",r=null,u=null,b=["left","right"],k=["top","bottom"],e=null;for(o=0;o<f.length;o++)i[f[o]]=!0;this.getDefaultFace=function(){return f.length===0?"top":f[0]};this.isRelocatable=function(){return!0};this.isSnapOnRelocate=function(){return!0};this.verifyEdge=function(n){return i[n]?n:i[h[n]]?h[n]:i[y[n]]?y[n]:i[p[n]]?p[n]:n};this.isEdgeSupported=function(n){return e==null?u==null?i[n]===!0:u===n:e.indexOf(n)!==-1};this.setCurrentFace=function(n,t){r=n;t&&u!=null&&(u=r)};this.getCurrentFace=function(){return r};this.getSupportedFaces=function(){var n=[];for(var t in i)i[t]&&n.push(t);return n};this.lock=function(){u=r};this.unlock=function(){u=null};this.isLocked=function(){return u!=null};this.lockCurrentAxis=function(){r!=null&&(e=r==="left"||r==="right"?b:k)};this.unlockCurrentAxis=function(){e=null};this.compute=function(n){return c[n.element.id]||[0,0]};this.getCurrentLocation=function(n){return c[n.element.id]||[0,0]};this.getOrientation=function(n){return a[n.id]||[0,0]};this.getCssClass=function(){return w}};f.continuousAnchorFactory={get:function(n){return new p(n)},clear:function(n){delete c[n]}}};t.AnchorManager.prototype.calculateOrientation=function(n,t,i,r,u,f,e,o,s){var l=["left","top","right","bottom"],v,y,p,w,c;if(n===t)return{orientation:{HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"}.IDENTITY,a:["top","top"]};var b=Math.atan2(r.centery-i.centery,r.centerx-i.centerx),k=Math.atan2(i.centery-r.centery,i.centerx-r.centerx),h=[],a={};for(function(n,t){for(var r,i=0;i<n.length;i++)if(a[n[i]]={left:[t[i][0].left,t[i][0].centery],right:[t[i][0].right,t[i][0].centery],top:[t[i][0].centerx,t[i][0].top],bottom:[t[i][0].centerx,t[i][0].bottom]},t[i][1]!==0)for(r in a[n[i]])a[n[i]][r]=jsPlumbUtil.rotatePoint(a[n[i]][r],[t[i][0].centerx,t[i][0].centery],t[i][1])}(["source","target"],[[i,o],[r,s]]),v=0;v<l.length;v++)for(y=0;y<l.length;y++)h.push({source:l[v],target:l[y],dist:Biltong.lineLength(a.source[l[v]],a.target[l[y]])});for(h.sort(function(n,t){return n.dist<t.dist?-1:n.dist>t.dist?1:0}),p=h[0].source,w=h[0].target,c=0;c<h.length;c++)if(p=u.isContinuous&&u.locked?u.getCurrentFace():!u.isContinuous||u.isEdgeSupported(h[c].source)?h[c].source:null,w=f.isContinuous&&f.locked?f.getCurrentFace():!f.isContinuous||f.isEdgeSupported(h[c].target)?h[c].target:null,p!=null&&w!=null)break;return u.isContinuous&&u.setCurrentFace(p),f.isContinuous&&f.setCurrentFace(w),{a:[p,w],theta:b,theta2:k}};t.Anchor=function(t){this.x=t.x||0;this.y=t.y||0;this.elementId=t.elementId;this.cssClass=t.cssClass||"";this.orientation=t.orientation||[0,0];this.lastReturnValue=null;this.offsets=t.offsets||[0,0];this.timestamp=null;this._unrotatedOrientation=[this.orientation[0],this.orientation[1]];this.relocatable=t.relocatable!==!1;this.snapOnRelocate=t.snapOnRelocate!==!1;this.locked=!1;n.EventGenerator.apply(this);this.compute=function(n){var i=n.xy,r=n.wh,f=n.timestamp,e,u,t;return f&&f===this.timestamp?this.lastReturnValue:(e=[i[0]+this.x*r[0]+this.offsets[0],i[1]+this.y*r[1]+this.offsets[1],this.x,this.y],u=n.rotation,u!=null&&u!==0?(t=jsPlumbUtil.rotatePoint(e,[i[0]+r[0]/2,i[1]+r[1]/2],u),this.orientation[0]=Math.round(this._unrotatedOrientation[0]*t[2]-this._unrotatedOrientation[1]*t[3]),this.orientation[1]=Math.round(this._unrotatedOrientation[1]*t[2]+this._unrotatedOrientation[0]*t[3]),this.lastReturnValue=[t[0],t[1],this.x,this.y]):(this.orientation[0]=this._unrotatedOrientation[0],this.orientation[1]=this._unrotatedOrientation[1],this.lastReturnValue=e),this.timestamp=f,this.lastReturnValue)};this.getCurrentLocation=function(n){return n=n||{},this.lastReturnValue==null||n.timestamp!=null&&this.timestamp!==n.timestamp?this.compute(n):this.lastReturnValue};this.setPosition=function(n,t,i,r,u){(!this.locked||u)&&(this.x=n,this.y=t,this.orientation=[i,r],this.lastReturnValue=null)}};n.extend(t.Anchor,n.EventGenerator,{equals:function(n){if(!n)return!1;var t=n.getOrientation(),i=this.getOrientation();return this.x===n.x&&this.y===n.y&&this.offsets[0]===n.offsets[0]&&this.offsets[1]===n.offsets[1]&&i[0]===t[0]&&i[1]===t[1]},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}});t.FloatingAnchor=function(n){t.Anchor.apply(this,arguments);var f=n.reference,e=n.referenceCanvas,u=t.getSize(e),o=0,s=0,i=null,r=null;this.orientation=null;this.x=0;this.y=0;this.isFloating=!0;this.compute=function(n){var t=n.xy,i=[t[0]+u[0]/2,t[1]+u[1]/2];return r=i,i};this.getOrientation=function(n){if(i)return i;var t=f.getOrientation(n);return[Math.abs(t[0])*o*-1,Math.abs(t[1])*s*-1]};this.over=function(n,t){i=n.getOrientation(t)};this.out=function(){i=null};this.getCurrentLocation=function(n){return r==null?this.compute(n):r}};n.extend(t.FloatingAnchor,t.Anchor);f=function(n,i,r){return n.constructor===t.Anchor?n:i.makeAnchor(n,r,i)};t.DynamicAnchor=function(n){var r;for(t.Anchor.apply(this,arguments),this.isDynamic=!0,this.anchors=[],this.elementId=n.elementId,this.jsPlumbInstance=n.jsPlumbInstance,r=0;r<n.anchors.length;r++)this.anchors[r]=f(n.anchors[r],this.jsPlumbInstance,this.elementId);this.getAnchors=function(){return this.anchors};var i=this.anchors.length>0?this.anchors[0]:null,u=i,s=this,e=function(n,t,i,r,u,f){var e=r[0]+n.x*u[0],o=r[1]+n.y*u[1],h=r[0]+u[0]/2,c=r[1]+u[1]/2,s;return f!=null&&f!==0&&(s=jsPlumbUtil.rotatePoint([e,o],[h,c],f),e=s[0],o=s[1]),Math.sqrt(Math.pow(t-e,2)+Math.pow(i-o,2))+Math.sqrt(Math.pow(h-e,2)+Math.pow(c-o,2))},o=n.selector||function(n,t,i,r,u,f,o){for(var h,a=i[0]+r[0]/2,v=i[1]+r[1]/2,c=-1,l=Infinity,s=0;s<o.length;s++)h=e(o[s],a,v,n,t,u,f),h<l&&(c=s+0,l=h);return o[c]};this.compute=function(n){var f=n.xy,e=n.wh,t=n.txy,r=n.twh,s=n.rotation,h=n.tRotation;return(this.timestamp=n.timestamp,this.locked||t==null||r==null)?(this.lastReturnValue=i.compute(n),this.lastReturnValue):(n.timestamp=null,i=o(f,e,t,r,s,h,this.anchors),this.x=i.x,this.y=i.y,i!==u&&this.fire("anchorChanged",i),u=i,this.lastReturnValue=i.compute(n),this.lastReturnValue)};this.getCurrentLocation=function(n){return i!=null?i.getCurrentLocation(n):null};this.getOrientation=function(n){return i!=null?i.getOrientation(n):[0,0]};this.over=function(n,t){i!=null&&i.over(n,t)};this.out=function(){i!=null&&i.out()};this.setAnchor=function(n){i=n};this.getCssClass=function(){return i&&i.getCssClass()||""};this.setAnchorCoordinates=function(n){var t=jsPlumbUtil.findWithFunction(this.anchors,function(t){return t.x===n[0]&&t.y===n[1]});return t!==-1?(this.setAnchor(this.anchors[t]),!0):!1}};n.extend(t.DynamicAnchor,t.Anchor);i=function(n,i,r,u,f,e){t.Anchors[f]=function(t){var o=t.jsPlumbInstance.makeAnchor([n,i,r,u,0,0],t.elementId,t.jsPlumbInstance);return o.type=f,e&&e(o,t),o}};i(.5,0,0,-1,"TopCenter");i(.5,1,0,1,"BottomCenter");i(0,.5,-1,0,"LeftMiddle");i(1,.5,1,0,"RightMiddle");i(.5,0,0,-1,"Top");i(.5,1,0,1,"Bottom");i(0,.5,-1,0,"Left");i(1,.5,1,0,"Right");i(.5,.5,0,0,"Center");i(1,0,0,-1,"TopRight");i(1,1,0,1,"BottomRight");i(0,0,0,-1,"TopLeft");i(0,1,0,1,"BottomLeft");t.Defaults.DynamicAnchors=function(n){return n.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],n.elementId,n.jsPlumbInstance)};t.Anchors.AutoDefault=function(n){var i=n.jsPlumbInstance.makeDynamicAnchor(t.Defaults.DynamicAnchors(n));return i.type="AutoDefault",i};r=function(n,i){t.Anchors[n]=function(t){var r=t.jsPlumbInstance.makeAnchor(["Continuous",{faces:i}],t.elementId,t.jsPlumbInstance);return r.type=n,r}};t.Anchors.Continuous=function(n){return n.jsPlumbInstance.continuousAnchorFactory.get(n)};r("ContinuousLeft",["left"]);r("ContinuousTop",["top"]);r("ContinuousBottom",["bottom"]);r("ContinuousRight",["right"]);i(0,0,0,0,"Assign",function(n,t){var i=t.position||"Fixed";n.positionFinder=i.constructor===String?t.jsPlumbInstance.AnchorPositionFinders[i]:i;n.constructorParams=t});u.jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(n,t,i){return[(n.left-t.left)/i[0],(n.top-t.top)/i[1]]},Grid:function(n,t,i,r){var e=n.left-t.left,o=n.top-t.top,u=i[0]/r.grid[0],f=i[1]/r.grid[1],s=Math.floor(e/u),h=Math.floor(o/f);return[(s*u+u/2)/i[0],(h*f+f/2)/i[1]]}};t.Anchors.Perimeter=function(n){var t,i,r,f;if(n=n||{},t=n.anchorCount||60,i=n.shape,!i)throw new Error("no shape supplied to Perimeter Anchor type");var e=function(){for(var f,e,n=.5,o=Math.PI*2/t,i=0,r=[],u=0;u<t;u++)f=n+n*Math.sin(i),e=n+n*Math.cos(i),r.push([f,e,0,0]),i+=o;return r},o=function(n){for(var i=t/n.length,u=[],f=function(n,r,f,e,o,s,h){var l,a,c;for(i=t*o,l=(f-n)/i,a=(e-r)/i,c=0;c<i;c++)u.push([n+l*c,r+a*c,s==null?0:s,h==null?0:h])},r=0;r<n.length;r++)f.apply(null,n[r]);return u},u=function(n){for(var i=[],t=0;t<n.length;t++)i.push([n[t][0],n[t][1],n[t][2],n[t][3],1/n.length,n[t][4],n[t][5]]);return o(i)},s=function(){return u([[0,0,1,0,0,-1],[1,0,1,1,1,0],[1,1,0,1,0,1],[0,1,0,0,-1,0]])},h={Circle:e,Ellipse:e,Diamond:function(){return u([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:s,Square:s,Triangle:function(){return u([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(n){for(var f,u,i=n.points,r=[],e=0,t=0;t<i.length-1;t++)f=Math.sqrt(Math.pow(i[t][2]-i[t][0])+Math.pow(i[t][3]-i[t][1])),e+=f,r.push([i[t][0],i[t][1],i[t+1][0],i[t+1][1],f]);for(u=0;u<r.length;u++)r[u][4]=r[u][4]/e;return o(r)}},c=function(n,t){for(var u,f,e=[],r=t/180*Math.PI,i=0;i<n.length;i++)u=n[i][0]-.5,f=n[i][1]-.5,e.push([.5+(u*Math.cos(r)-f*Math.sin(r)),.5+(u*Math.sin(r)+f*Math.cos(r)),n[i][2],n[i][3]]);return e};if(!h[i])throw new Error("Shape ["+i+"] is unknown by Perimeter Anchor type");return r=h[i](n),n.rotation&&(r=c(r,n.rotation)),f=n.jsPlumbInstance.makeDynamicAnchor(r),f.type="Perimeter",f}}.call(typeof window!="undefined"?window:this),function(){"use strict";var n=this,i=n.jsPlumbUtil,t=n.jsPlumb;t.DefaultRouter=function(n){this.jsPlumbInstance=n;this.anchorManager=new t.AnchorManager({jsPlumbInstance:n});this.sourceOrTargetChanged=function(n,t,i,r,u){this.anchorManager.sourceOrTargetChanged(n,t,i,r,u)};this.reset=function(){this.anchorManager.reset()};this.changeId=function(n,t){this.anchorManager.changeId(n,t)};this.elementRemoved=function(n){this.anchorManager.elementRemoved(n)};this.newConnection=function(n){this.anchorManager.newConnection(n)};this.connectionDetached=function(n,t){this.anchorManager.connectionDetached(n,t)};this.redraw=function(n,t,i,r,u,f){return this.anchorManager.redraw(n,t,i,r,u,f)};this.deleteEndpoint=function(n){this.anchorManager.deleteEndpoint(n)};this.rehomeEndpoint=function(n,t,i){this.anchorManager.rehomeEndpoint(n,t,i)};this.addEndpoint=function(n,t){this.anchorManager.addEndpoint(n,t)}}}.call(typeof window!="undefined"?window:this),function(){"use strict";var r=this,n=r.jsPlumb,t=r.jsPlumbUtil,i=r.Biltong,e,f,u,s,o;n.Segments={AbstractSegment:function(n){this.params=n;this.findClosestPointOnPath=function(){return{d:Infinity,x:null,y:null,l:null}};this.getBounds=function(){return{minX:Math.min(n.x1,n.x2),minY:Math.min(n.y1,n.y2),maxX:Math.max(n.x1,n.x2),maxY:Math.max(n.y1,n.y2)}};this.lineIntersection=function(){return[]};this.boxIntersection=function(n,t,i,r){var u=[];return u.push.apply(u,this.lineIntersection(n,t,n+i,t)),u.push.apply(u,this.lineIntersection(n+i,t,n+i,t+r)),u.push.apply(u,this.lineIntersection(n+i,t+r,n,t+r)),u.push.apply(u,this.lineIntersection(n,t+r,n,t)),u};this.boundingBoxIntersection=function(n){return this.boxIntersection(n.x,n.y,n.w,n.y)}},Straight:function(t){var p=n.Segments.AbstractSegment.apply(this,arguments),h,o,a,r,f,u,e,y=function(){h=Math.sqrt(Math.pow(f-r,2)+Math.pow(e-u,2));o=i.gradient({x:r,y:u},{x:f,y:e});a=-1/o},c,l,v,s;this.type="Straight";this.getLength=function(){return h};this.getGradient=function(){return o};this.getCoordinates=function(){return{x1:r,y1:u,x2:f,y2:e}};this.setCoordinates=function(n){r=n.x1;u=n.y1;f=n.x2;e=n.y2;y()};this.setCoordinates({x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2});this.getBounds=function(){return{minX:Math.min(r,f),minY:Math.min(u,e),maxX:Math.max(r,f),maxY:Math.max(u,e)}};this.pointOnPath=function(n,t){if(n!==0||t){if(n!==1||t){var o=t?n>0?n:h+n:n*h;return i.pointOnLine({x:r,y:u},{x:f,y:e},o)}return{x:f,y:e}}return{x:r,y:u}};this.gradientAtPoint=function(){return o};this.pointAlongPathFrom=function(n,t,o){var s=this.pointOnPath(n,o),h=t<=0?{x:r,y:u}:{x:f,y:e};return t<=0&&Math.abs(t)>1&&(t*=-1),i.pointOnLine(s,h,t)};c=function(n,t,i){return i>=Math.min(n,t)&&i<=Math.max(n,t)};l=function(n,t,i){return Math.abs(i-n)<Math.abs(i-t)?n:t};this.findClosestPointOnPath=function(n,t){var s={d:Infinity,x:null,y:null,l:null,x1:r,x2:f,y1:u,y2:e},w;if(o===0)s.y=u,s.x=c(r,f,n)?n:l(r,f,n);else if(o===Infinity||o===-Infinity)s.x=r,s.y=c(u,e,t)?t:l(u,e,t);else{var p=u-o*r,b=t-a*n,v=(b-p)/(o-a),y=o*v+p;s.x=c(r,f,v)?v:l(r,f,v);s.y=c(u,e,y)?y:l(u,e,y)}return w=i.lineLength([s.x,s.y],[r,u]),s.d=i.lineLength([n,t],[s.x,s.y]),s.l=w/h,s};v=function(n,t,i){return i>t?t<=n&&n<=i:t>=n&&n>=i};s=v;this.lineIntersection=function(n,t,h,c){var y=Math.abs(i.gradient({x:n,y:t},{x:h,y:c})),a=Math.abs(o),w=a===Infinity?r:u-a*r,p=[],b=y===Infinity?n:t-y*n,l,v;return y!==a&&(y===Infinity&&a===0?s(n,r,f)&&s(u,t,c)&&(p=[n,u]):y===0&&a===Infinity?s(t,u,e)&&s(r,n,h)&&(p=[r,t]):y===Infinity?(l=n,s(l,r,f)&&(v=a*n+w,s(v,t,c)&&(p=[l,v]))):y===0?(v=t,s(v,u,e)&&(l=(t-w)/a,s(l,n,h)&&(p=[l,v]))):(l=(b-w)/(a-y),v=a*l+w,s(l,r,f)&&s(v,u,e)&&(p=[l,v]))),p};this.boxIntersection=function(n,t,i,r){var u=[];return u.push.apply(u,this.lineIntersection(n,t,n+i,t)),u.push.apply(u,this.lineIntersection(n+i,t,n+i,t+r)),u.push.apply(u,this.lineIntersection(n+i,t+r,n,t+r)),u.push.apply(u,this.lineIntersection(n,t+r,n,t)),u};this.boundingBoxIntersection=function(n){return this.boxIntersection(n.x,n.y,n.w,n.h)}},Arc:function(t){var a=n.Segments.AbstractSegment.apply(this,arguments),e=function(n,r){return i.theta([t.cx,t.cy],[n,r])},c=function(n,t){var i,u,f,e;return n.anticlockwise?(i=n.startAngle<n.endAngle?n.startAngle+r:n.startAngle,u=Math.abs(i-n.endAngle),i-u*t):(f=n.endAngle<n.startAngle?n.endAngle+r:n.endAngle,e=Math.abs(f-n.startAngle),n.startAngle+e*t)},r=2*Math.PI,o,u,f;this.radius=t.r;this.anticlockwise=t.ac;this.type="Arc";t.startAngle&&t.endAngle?(this.startAngle=t.startAngle,this.endAngle=t.endAngle,this.x1=t.cx+this.radius*Math.cos(t.startAngle),this.y1=t.cy+this.radius*Math.sin(t.startAngle),this.x2=t.cx+this.radius*Math.cos(t.endAngle),this.y2=t.cy+this.radius*Math.sin(t.endAngle)):(this.startAngle=e(t.x1,t.y1),this.endAngle=e(t.x2,t.y2),this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2);this.endAngle<0&&(this.endAngle+=r);this.startAngle<0&&(this.startAngle+=r);o=this.endAngle<this.startAngle?this.endAngle+r:this.endAngle;this.sweep=Math.abs(o-this.startAngle);this.anticlockwise&&(this.sweep=r-this.sweep);var s=2*Math.PI*this.radius,l=this.sweep/r,h=s*l;this.getLength=function(){return h};this.getBounds=function(){return{minX:t.cx-t.r,maxX:t.cx+t.r,minY:t.cy-t.r,maxY:t.cy+t.r}};u=1e-10;f=function(n){var t=Math.floor(n),i=Math.ceil(n);return n-t<u?t:i-n<u?i:n};this.pointOnPath=function(n,i){if(n===0)return{x:this.x1,y:this.y1,theta:this.startAngle};if(n===1)return{x:this.x2,y:this.y2,theta:this.endAngle};i&&(n=n/h);var r=c(this,n),u=t.cx+t.r*Math.cos(r),e=t.cy+t.r*Math.sin(r);return{x:f(u),y:f(e),theta:r}};this.gradientAtPoint=function(n,r){var f=this.pointOnPath(n,r),u=i.normal([t.cx,t.cy],[f.x,f.y]);return this.anticlockwise||u!==Infinity&&u!==-Infinity||(u*=-1),u};this.pointAlongPathFrom=function(n,i,r){var f=this.pointOnPath(n,r),e=i/s*2*Math.PI,o=this.anticlockwise?-1:1,u=f.theta+o*e,h=t.cx+this.radius*Math.cos(u),c=t.cy+this.radius*Math.sin(u);return{x:h,y:c}}},Bezier:function(t){var i;this.curve=[{x:t.x1,y:t.y1},{x:t.cp1x,y:t.cp1y},{x:t.cp2x,y:t.cp2y},{x:t.x2,y:t.y2}];var u=function(n){return n[0].x===n[1].x&&n[0].y===n[1].y},f=function(n,t){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))},e=function(n){var c={x:0,y:0},r,t,i;if(n===0)return this.curve[0];if(r=this.curve.length-1,n===1)return this.curve[r];if(t=this.curve,i=1-n,r===0)return this.curve[0];if(r===1)return{x:i*t[0].x+n*t[1].x,y:i*t[0].y+n*t[1].y};if(r<4){var o=i*i,s=n*n,h=0,u,f,e;return r===2?(t=[t[0],t[1],t[2],c],u=o,f=2*i*n,e=s):r===3&&(u=o*i,f=3*o*n,e=3*i*s,h=n*s),{x:u*t[0].x+f*t[1].x+e*t[2].x+h*t[3].x,y:u*t[0].y+f*t[1].y+e*t[2].y+h*t[3].y}}return c}.bind(this),o=function(n){var i=[],t;for(n--,t=0;t<=n;t++)i.push(e(t/n));return i},s=function(){var t,i,n,r,e;for(u(this.curve)&&(this.length=0),t=16,i=o(t),this.length=0,n=0;n<t-1;n++)r=i[n],e=i[n+1],this.length+=f(r,e)}.bind(this),h=n.Segments.AbstractSegment.apply(this,arguments);this.bounds={minX:Math.min(t.x1,t.x2,t.cp1x,t.cp2x),minY:Math.min(t.y1,t.y2,t.cp1y,t.cp2y),maxX:Math.max(t.x1,t.x2,t.cp1x,t.cp2x),maxY:Math.max(t.y1,t.y2,t.cp1y,t.cp2y)};this.type="Bezier";s();i=function(n,t,i){return i&&(t=r.jsBezier.locationAlongCurveFrom(n,t>0?0:1,t)),t};this.pointOnPath=function(n,t){return n=i(this.curve,n,t),r.jsBezier.pointOnCurve(this.curve,n)};this.gradientAtPoint=function(n,t){return n=i(this.curve,n,t),r.jsBezier.gradientAtPoint(this.curve,n)};this.pointAlongPathFrom=function(n,t,u){return n=i(this.curve,n,u),r.jsBezier.pointAlongCurveFrom(this.curve,n,t)};this.getLength=function(){return this.length};this.getBounds=function(){return this.bounds};this.findClosestPointOnPath=function(n,t){var i=r.jsBezier.nearestPointOnCurve({x:n,y:t},this.curve);return{d:Math.sqrt(Math.pow(i.point.x-n,2)+Math.pow(i.point.y-t,2)),x:i.point.x,y:i.point.y,l:1-i.location,s:this}};this.lineIntersection=function(n,t,i,u){return r.jsBezier.lineIntersection(n,t,i,u,this.curve)}}};n.SegmentRenderer={getPath:function(n,t){return{Straight:function(t){var i=n.getCoordinates();return(t?"M "+i.x1+" "+i.y1+" ":"")+"L "+i.x2+" "+i.y2},Bezier:function(t){var i=n.params;return(t?"M "+i.x2+" "+i.y2+" ":"")+"C "+i.cp2x+" "+i.cp2y+" "+i.cp1x+" "+i.cp1y+" "+i.x1+" "+i.y1},Arc:function(t){var i=n.params,r=n.sweep>Math.PI?1:0,u=n.anticlockwise?0:1;return(t?"M"+n.x1+" "+n.y1+" ":"")+"A "+n.radius+" "+i.r+" 0 "+r+","+u+" "+n.x2+" "+n.y2}}[n.type](t)}};e=function(){this.resetBounds=function(){this.bounds={minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}};this.resetBounds()};n.Connectors.AbstractConnector=function(r){var b,tt;e.apply(this,arguments);var u=[],o=0,f=[],p=[],l=r.stub||0,s=t.isArray(l)?l[0]:l,h=t.isArray(l)?l[1]:l,a=r.gap||0,v=t.isArray(a)?a[0]:a,y=t.isArray(a)?a[1]:a,k=null,c=null;this.getPathData=function(){for(var i="",t=0;t<u.length;t++)i+=n.SegmentRenderer.getPath(u[t],t===0),i+=" ";return i};this.findSegmentForPoint=function(n,t){for(var r,i={d:Infinity,s:null,x:null,y:null,l:null},e=0;e<u.length;e++)r=u[e].findClosestPointOnPath(n,t),r.d<i.d&&(i.d=r.d,i.l=r.l,i.x=r.x,i.y=r.y,i.s=u[e],i.x1=r.x1,i.x2=r.x2,i.y1=r.y1,i.y2=r.y2,i.index=e,i.connectorLocation=f[e][0]+r.l*(f[e][1]-f[e][0]));return i};this.lineIntersection=function(n,t,i,r){for(var f=[],e=0;e<u.length;e++)f.push.apply(f,u[e].lineIntersection(n,t,i,r));return f};this.boxIntersection=function(n,t,i,r){for(var f=[],e=0;e<u.length;e++)f.push.apply(f,u[e].boxIntersection(n,t,i,r));return f};this.boundingBoxIntersection=function(n){for(var t=[],i=0;i<u.length;i++)t.push.apply(t,u[i].boundingBoxIntersection(n));return t};var d=function(){for(var t,i=0,n=0;n<u.length;n++)t=u[n].getLength(),p[n]=t/o,f[n]=[i,i+=t/o]},w=function(n,t){var r,i,e;if(t&&(n=n>0?n/o:(o+n)/o),n===1)r=u.length-1,e=1;else if(n===0)e=0,r=0;else if(n>=.5){for(r=0,e=0,i=f.length-1;i>-1;i--)if(f[i][1]>=n&&f[i][0]<=n){r=i;e=(n-f[i][0])/p[i];break}}else for(r=f.length-1,e=1,i=0;i<f.length;i++)if(f[i][1]>=n){r=i;e=(n-f[i][0])/p[i];break}return{segment:u[r],proportion:e,index:r}},g=function(t,i,r){if(r.x1!==r.x2||r.y1!==r.y2){var f=new n.Segments[i](r);u.push(f);o+=f.getLength();t.updateBounds(f)}},nt=function(){o=u.length=f.length=p.length=0};return this.setSegments=function(n){k=[];o=0;for(var t=0;t<n.length;t++)k.push(n[t]),o+=n[t].getLength()},this.getLength=function(){return o},b=function(n){var u,k;this.strokeWidth=n.strokeWidth;var tt=i.quadrant(n.sourcePos,n.targetPos),w=n.targetPos[0]<n.sourcePos[0],b=n.targetPos[1]<n.sourcePos[1],it=n.strokeWidth||1,t=n.sourceEndpoint.anchor.getOrientation(n.sourceEndpoint),r=n.targetEndpoint.anchor.getOrientation(n.targetEndpoint),g=w?n.targetPos[0]:n.sourcePos[0],nt=b?n.targetPos[1]:n.sourcePos[1],l=Math.abs(n.targetPos[0]-n.sourcePos[0]),a=Math.abs(n.targetPos[1]-n.sourcePos[1]);(t[0]===0&&t[1]===0||r[0]===0&&r[1]===0)&&(u=l>a?0:1,k=[1,0][u],t=[],r=[],t[u]=n.sourcePos[u]>n.targetPos[u]?-1:1,r[u]=n.sourcePos[u]>n.targetPos[u]?1:-1,t[k]=0,r[k]=0);var f=w?l+v*t[0]:v*t[0],e=b?a+v*t[1]:v*t[1],o=w?y*r[0]:l+y*r[0],c=b?y*r[1]:a+y*r[1],d=t[0]*r[0]+t[1]*r[1],p={sx:f,sy:e,tx:o,ty:c,lw:it,xSpan:Math.abs(o-f),ySpan:Math.abs(c-e),mx:(f+o)/2,my:(e+c)/2,so:t,to:r,x:g,y:nt,w:l,h:a,segment:tt,startStubX:f+t[0]*s,startStubY:e+t[1]*s,endStubX:o+r[0]*h,endStubY:c+r[1]*h,isXGreaterThanStubTimes2:Math.abs(f-o)>s+h,isYGreaterThanStubTimes2:Math.abs(e-c)>s+h,opposite:d===-1,perpendicular:d===0,orthogonal:d===1,sourceAxis:t[0]===0?"y":"x",points:[g,nt,l,a,f,e,o,c],stubs:[s,h]};return p.anchorOrientation=p.opposite?"opposite":p.orthogonal?"orthogonal":"perpendicular",p},this.getSegments=function(){return u},this.updateBounds=function(n){var t=n.getBounds();this.bounds.minX=Math.min(this.bounds.minX,t.minX);this.bounds.maxX=Math.max(this.bounds.maxX,t.maxX);this.bounds.minY=Math.min(this.bounds.minY,t.minY);this.bounds.maxY=Math.max(this.bounds.maxY,t.maxY)},tt=function(){console.log("SEGMENTS:");for(var n=0;n<u.length;n++)console.log(u[n].type,u[n].getLength(),f[n])},this.pointOnPath=function(n,t){var i=w(n,t);return i.segment&&i.segment.pointOnPath(i.proportion,!1)||[0,0]},this.gradientAtPoint=function(n,t){var i=w(n,t);return i.segment&&i.segment.gradientAtPoint(i.proportion,!1)||0},this.pointAlongPathFrom=function(n,t,i){var r=w(n,i);return r.segment&&r.segment.pointAlongPathFrom(r.proportion,t,!1)||[0,0]},this.compute=function(n){c=b.call(this,n);nt();this._compute(c,n);this.x=c.points[0];this.y=c.points[1];this.w=c.points[2];this.h=c.points[3];this.segment=c.segment;d()},{addSegment:g,prepareCompute:b,sourceStub:s,targetStub:h,maxStub:Math.max(s,h),sourceGap:v,targetGap:y,maxGap:Math.max(v,y)}};t.extend(n.Connectors.AbstractConnector,e);n.Endpoints.AbstractEndpoint=function(n){e.apply(this,arguments);var t=this.compute=function(){var n=this._compute.apply(this,arguments);return this.x=n[0],this.y=n[1],this.w=n[2],this.h=n[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,n};return{compute:t,cssClass:n.cssClass}};t.extend(n.Endpoints.AbstractEndpoint,e);n.Endpoints.Dot=function(t){this.type="Dot";var i=n.Endpoints.AbstractEndpoint.apply(this,arguments);t=t||{};this.radius=t.radius||10;this.defaultOffset=.5*this.radius;this.defaultInnerRadius=this.radius/3;this._compute=function(n,t,i){var r;this.radius=i.radius||this.radius;var u=n[0]-this.radius,f=n[1]-this.radius,e=this.radius*2,o=this.radius*2;return i.stroke&&(r=i.strokeWidth||1,u-=r,f-=r,e+=r*2,o+=r*2),[u,f,e,o,this.radius]}};t.extend(n.Endpoints.Dot,n.Endpoints.AbstractEndpoint);n.Endpoints.Rectangle=function(t){this.type="Rectangle";var i=n.Endpoints.AbstractEndpoint.apply(this,arguments);t=t||{};this.width=t.width||20;this.height=t.height||20;this._compute=function(n,t,i){var r=i.width||this.width,u=i.height||this.height,f=n[0]-r/2,e=n[1]-u/2;return[f,e,r,u]}};t.extend(n.Endpoints.Rectangle,n.Endpoints.AbstractEndpoint);f=function(){n.jsPlumbUIComponent.apply(this,arguments);this._jsPlumb.displayElements=[]};t.extend(f,n.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(n){this._jsPlumb.displayElements.push(n)}});n.Endpoints.Image=function(i){this.type="Image";f.apply(this,arguments);n.Endpoints.AbstractEndpoint.apply(this,arguments);var u=i.onload,e=i.src||i.url,o=i.cssClass?" "+i.cssClass:"";this._jsPlumb.img=new Image;this._jsPlumb.ready=!1;this._jsPlumb.initialized=!1;this._jsPlumb.deleted=!1;this._jsPlumb.widthToUse=i.width;this._jsPlumb.heightToUse=i.height;this._jsPlumb.endpoint=i.endpoint;this._jsPlumb.img.onload=function(){this._jsPlumb!=null&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,u&&u(this))}.bind(this);this._jsPlumb.endpoint.setImage=function(n,t){var i=n.constructor===String?n:n.src;u=t;this._jsPlumb.img.src=i;this.canvas!=null&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this);this._jsPlumb.endpoint.setImage(e,u);this._compute=function(n){return this.anchorPoint=n,this._jsPlumb.ready?[n[0]-this._jsPlumb.widthToUse/2,n[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]};this.canvas=n.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+o);this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse);this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse);this._jsPlumb.instance.appendElement(this.canvas);this.actuallyPaint=function(){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);var n=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,i=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;t.sizeElement(this.canvas,n,i,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}};this.paint=function(n,t){this._jsPlumb!=null&&(this._jsPlumb.ready?this.actuallyPaint(n,t):r.setTimeout(function(){this.paint(n,t)}.bind(this),200))}};t.extend(n.Endpoints.Image,[f,n.Endpoints.AbstractEndpoint],{cleanup:function(n){n&&(this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null)}});n.Endpoints.Blank=function(i){var u=n.Endpoints.AbstractEndpoint.apply(this,arguments),r;this.type="Blank";f.apply(this,arguments);this._compute=function(n){return[n[0],n[1],10,0]};r=i.cssClass?" "+i.cssClass:"";this.canvas=n.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+r);this._jsPlumb.instance.appendElement(this.canvas);this.paint=function(){t.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}};t.extend(n.Endpoints.Blank,[n.Endpoints.AbstractEndpoint,f],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}});n.Endpoints.Triangle=function(t){this.type="Triangle";n.Endpoints.AbstractEndpoint.apply(this,arguments);var i=this;t=t||{};t.width=t.width||55;t.height=t.height||55;this.width=t.width;this.height=t.height;this._compute=function(n,t,r){var u=r.width||i.width,f=r.height||i.height,e=n[0]-u/2,o=n[1]-f/2;return[e,o,u,f]}};u=n.Overlays.AbstractOverlay=function(n){this.visible=!0;this.isAppendedAtTopLevel=!0;this.component=n.component;this.loc=n.location==null?.5:n.location;this.endpointLoc=n.endpointLocation==null?[.5,.5]:n.endpointLocation;this.visible=n.visible!==!1};u.prototype={cleanup:function(n){n&&(this.component=null,this.canvas=null,this.endpointLoc=null)},reattach:function(){},setVisible:function(n){this.visible=n;this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(n){this.loc+=n;this.component.repaint()},setLocation:function(n){this.loc=n;this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}};n.Overlays.Arrow=function(r){var e,f,o;this.type="Arrow";u.apply(this,arguments);this.isAppendedAtTopLevel=!1;r=r||{};e=this;this.length=r.length||20;this.width=r.width||20;this.id=r.id;this.direction=(r.direction||1)<0?-1:1;f=r.paintStyle||{"stroke-width":1};o=r.foldback||.623;this.computeMaxSize=function(){return e.width*1.5};this.elementCreated=function(t){if(this.path=t,r.events)for(var i in r.events)n.on(t,i,r.events[i])};this.draw=function(n,r){var u,h,e,s,a,c,l,v,y;if(n.pointAlongPathFrom){t.isString(this.loc)||this.loc>1||this.loc<0?(c=parseInt(this.loc,10),l=this.loc<0?1:0,u=n.pointAlongPathFrom(l,c,!1),h=n.pointAlongPathFrom(l,c-this.direction*this.length/2,!1),e=i.pointOnLine(u,h,this.length)):this.loc===1?(u=n.pointOnPath(this.loc),h=n.pointAlongPathFrom(this.loc,-this.length),e=i.pointOnLine(u,h,this.length),this.direction===-1&&(v=e,e=u,u=v)):this.loc===0?(e=n.pointOnPath(this.loc),h=n.pointAlongPathFrom(this.loc,this.length),u=i.pointOnLine(e,h,this.length),this.direction===-1&&(y=e,e=u,u=y)):(u=n.pointAlongPathFrom(this.loc,this.direction*this.length/2),h=n.pointOnPath(this.loc),e=i.pointOnLine(u,h,this.length));s=i.perpendicularLineTo(u,e,this.width);a=i.pointOnLine(u,e,o*this.length);var p={hxy:u,tail:s,cxy:a},w=f.stroke||r.stroke,b=f.fill||r.stroke,k=f.strokeWidth||r.strokeWidth;return{component:n,d:p,"stroke-width":k,stroke:w,fill:b,minX:Math.min(u.x,s[0].x,s[1].x),maxX:Math.max(u.x,s[0].x,s[1].x),minY:Math.min(u.y,s[0].y,s[1].y),maxY:Math.max(u.y,s[0].y,s[1].y)}}return{component:n,minX:0,maxX:0,minY:0,maxY:0}}};t.extend(n.Overlays.Arrow,u,{updateFrom:function(n){this.length=n.length||this.length;this.width=n.width||this.width;this.direction=n.direction!=null?n.direction:this.direction;this.foldback=n.foldback||this.foldback},cleanup:function(){this.path&&this.path.parentNode&&this.path.parentNode.removeChild(this.path)}});n.Overlays.PlainArrow=function(t){t=t||{};var i=n.extend(t,{foldback:1});n.Overlays.Arrow.call(this,i);this.type="PlainArrow"};t.extend(n.Overlays.PlainArrow,n.Overlays.Arrow);n.Overlays.Diamond=function(t){t=t||{};var i=t.length||40,r=n.extend(t,{length:i/2,foldback:2});n.Overlays.Arrow.call(this,r);this.type="Diamond"};t.extend(n.Overlays.Diamond,n.Overlays.Arrow);s=function(n,t){return(n._jsPlumb.cachedDimensions==null||t)&&(n._jsPlumb.cachedDimensions=n.getDimensions()),n._jsPlumb.cachedDimensions};o=function(i){n.jsPlumbUIComponent.apply(this,arguments);u.apply(this,arguments);var r=this.fire;this.fire=function(){r.apply(this,arguments);this.component&&this.component.fire.apply(this.component,arguments)};this.detached=!1;this.id=i.id;this._jsPlumb.div=null;this._jsPlumb.initialised=!1;this._jsPlumb.component=i.component;this._jsPlumb.cachedDimensions=null;this._jsPlumb.create=i.create;this._jsPlumb.initiallyInvisible=i.visible===!1;this.getElement=function(){var t,r;return this._jsPlumb.div==null&&(t=this._jsPlumb.div=n.getElement(this._jsPlumb.create(this._jsPlumb.component)),t.style.position="absolute",jsPlumb.addClass(t,this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:i.cssClass?i.cssClass:"")),this._jsPlumb.instance.appendElement(t),this._jsPlumb.instance.getId(t),this.canvas=t,r="translate(-50%, -50%)",t.style.webkitTransform=r,t.style.mozTransform=r,t.style.msTransform=r,t.style.oTransform=r,t.style.transform=r,t._jsPlumb=this,i.visible===!1&&(t.style.display="none")),this._jsPlumb.div};this.draw=function(n,i,r){var u=s(this),f,h,c,l,e,o;return u!=null&&u.length===2?(f={x:0,y:0},r?f={x:r[0],y:r[1]}:n.pointOnPath?(h=this.loc,c=!1,(t.isString(this.loc)||this.loc<0||this.loc>1)&&(h=parseInt(this.loc,10),c=!0),f=n.pointOnPath(h,c)):(l=this.loc.constructor===Array?this.loc:this.endpointLoc,f={x:l[0]*n.w,y:l[1]*n.h}),e=f.x-u[0]/2,o=f.y-u[1]/2,{component:n,d:{minx:e,miny:o,td:u,cxy:f},minX:e,maxX:e+u[0],minY:o,maxY:o+u[1]}):{minX:0,maxX:0,minY:0,maxY:0}}};t.extend(o,[n.jsPlumbUIComponent,u],{getDimensions:function(){return[1,1]},setVisible:function(n){this._jsPlumb.div&&(this._jsPlumb.div.style.display=n?"block":"none",n&&this._jsPlumb.initiallyInvisible&&(s(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1))},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(n){n?this._jsPlumb.div!=null&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div)):(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div),this.detached=!0)},reattach:function(n){this._jsPlumb.div!=null&&n.getContainer().appendChild(this._jsPlumb.div);this.detached=!1},computeMaxSize:function(){var n=s(this);return Math.max(n[0],n[1])},paint:function(n){this._jsPlumb.initialised||(this.getElement(),n.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0,this.detached&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div));this._jsPlumb.div.style.left=n.component.x+n.d.minx+"px";this._jsPlumb.div.style.top=n.component.y+n.d.miny+"px"}});n.Overlays.Custom=function(){this.type="Custom";o.apply(this,arguments)};t.extend(n.Overlays.Custom,o);n.Overlays.GuideLines=function(){var t=this;t.length=50;t.strokeWidth=5;this.type="GuideLines";u.apply(this,arguments);n.jsPlumbUIComponent.apply(this,arguments);this.draw=function(n){var u=n.pointAlongPathFrom(t.loc,t.length/2),e=n.pointOnPath(t.loc),f=i.pointOnLine(u,e,t.length),o=i.perpendicularLineTo(u,f,40),r=i.perpendicularLineTo(f,u,20);return{connector:n,head:u,tail:f,headLine:r,tailLine:o,minX:Math.min(u.x,f.x,r[0].x,r[1].x),minY:Math.min(u.y,f.y,r[0].y,r[1].y),maxX:Math.max(u.x,f.x,r[0].x,r[1].x),maxY:Math.max(u.y,f.y,r[0].y,r[1].y)}}};n.Overlays.Label=function(t){var r,i,u;this.labelStyle=t.labelStyle;this.cssClass=this.labelStyle!=null?this.labelStyle.cssClass:null;r=n.extend({create:function(){return n.createElement("div")}},t);n.Overlays.Custom.call(this,r);this.type="Label";this.label=t.label||"";this.labelText=null;this.labelStyle&&(i=this.getElement(),this.labelStyle.font=this.labelStyle.font||"12px sans-serif",i.style.font=this.labelStyle.font,i.style.color=this.labelStyle.color||"black",this.labelStyle.fill&&(i.style.background=this.labelStyle.fill),this.labelStyle.borderWidth>0&&(u=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black",i.style.border=this.labelStyle.borderWidth+"px solid "+u),this.labelStyle.padding&&(i.style.padding=this.labelStyle.padding))};t.extend(n.Overlays.Label,n.Overlays.Custom,{cleanup:function(n){n&&(this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null)},getLabel:function(){return this.label},setLabel:function(n){this.label=n;this.labelText=null;this.clearCachedDimensions();this.update();this.component.repaint()},getDimensions:function(){return this.update(),o.prototype.getDimensions.apply(this,arguments)},update:function(){if(typeof this.label=="function"){var n=this.label(this);this.getElement().innerHTML=n.replace(/\r\n/g,"<br/>")}else this.labelText==null&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))},updateFrom:function(n){n.label!=null&&this.setLabel(n.label)}})}.call(typeof window!="undefined"?window:this),function(){"use strict";var r=this,t=r.jsPlumbUtil,n=r.jsPlumbInstance,e="jtk-group-collapsed",u="jtk-group-expanded",h="[jtk-group-content]",c="elementDraggable",o="stop",s="revert",f="_groupManager",i="_jsPlumbGroup",l="_jsPlumbGroupDrag",a="group:addMember",v="group:removeMember",y="group:add",p="group:remove",w="group:expand",b="group:collapse",k="groupDragStop",d="connectionMoved",g="internal.connectionDetached",nt="removeAll",tt="orphanAll",it="show",rt="hide",ut=function(n){function k(t,i){for(var r=n.getContainer();;){if(t==null||t===r)return!1;if(t===i)return!0;t=t.parentNode}}function ut(n){delete n.proxies;var i=f[n.id],r;i!=null&&(r=function(t){return t.id===n.id},t.removeWithFunction(i.connections.source,r),t.removeWithFunction(i.connections.target,r),delete f[n.id]);i=o[n.id];i!=null&&(r=function(t){return t.id===n.id},t.removeWithFunction(i.connections.source,r),t.removeWithFunction(i.connections.target,r),delete o[n.id])}function v(t,i){for(var u=t.getEl().querySelectorAll(".jtk-managed"),r=0;r<u.length;r++)n[i?it:rt](u[r],!0)}function c(t){for(var u,i=t.getMembers().slice(),e=[],r=0;r<i.length;r++)Array.prototype.push.apply(e,i[r].querySelectorAll(".jtk-managed"));Array.prototype.push.apply(i,e);var h=n.getConnections({source:i,scope:"*"},!0),c=n.getConnections({target:i,scope:"*"},!0),s={};t.connections.source.length=0;t.connections.target.length=0;u=function(i){for(var e,u,r=0;r<i.length;r++)s[i[r].id]||(s[i[r].id]=!0,e=n.getGroupFor(i[r].source),u=n.getGroupFor(i[r].target),e===t?(u!==t&&t.connections.source.push(i[r]),f[i[r].id]=t):u===t&&(t.connections.target.push(i[r]),o[i[r].id]=t))};u(h);u(c)}var r={},f={},o={},l=this,h,s;n.bind("connection",function(i){var r=n.getGroupFor(i.source),u=n.getGroupFor(i.target);r!=null&&u!=null&&r===u?(f[i.connection.id]=r,o[i.connection.id]=r):(r!=null&&(t.suggest(r.connections.source,i.connection),f[i.connection.id]=r),u!=null&&(t.suggest(u.connections.target,i.connection),o[i.connection.id]=u))});n.bind(g,function(n){ut(n.connection)});n.bind(d,function(n){var u=n.index===0?f:o,r=u[n.connection.id],t,i;r&&(t=r.connections[n.index===0?"source":"target"],i=t.indexOf(n.connection),i!==-1&&t.splice(i,1))});this.addGroup=function(t){n.addClass(t.getEl(),u);r[t.id]=t;t.manager=this;c(t);n.fire(y,{group:t})};this.addToGroup=function(t,i,r){var e,u,f,c,v,o,y,p;if(t=this.getGroup(t),t){if(e=t.getEl(),i._isJsPlumbGroup)return;u=i._jsPlumbGroup;u!==t&&(n.removeFromDragSelection(i),f=n.getOffset(i,!0),c=t.collapsed?n.getOffset(e,!0):n.getOffset(t.getDragArea(),!0),u!=null&&(u.remove(i,!1,r,!1,t),l.updateConnectionsForGroup(u)),t.add(i,r),v=function(n,i){var r=i===0?1:0;n.each(function(n){n.setVisible(!1);n.endpoints[r].element._jsPlumbGroup===t?(n.endpoints[r].setVisible(!1),s(n,r,t)):(n.endpoints[i].setVisible(!1),h(n,i,t))})},t.collapsed&&(v(n.select({source:i}),0),v(n.select({target:i}),1)),o=n.getId(i),n.dragManager.setParent(i,o,e,n.getId(e),f),y={left:f.left-c.left,top:f.top-c.top},n.setPosition(i,y),n.dragManager.revalidateParent(i,o,f),l.updateConnectionsForGroup(t),n.revalidate(o),r||(p={group:t,el:i,pos:y},u&&(p.sourceGroup=u),n.fire(a,p)))}};this.removeFromGroup=function(n,t,i){if(n=this.getGroup(n),n){if(n.collapsed){var r=function(i,r){for(var u,f,o,e=0;e<i.length;e++)if(u=i[e],u.proxies)for(f=0;f<u.proxies.length;f++)u.proxies[f]!=null&&(o=u.proxies[f].originalEp.element,(o===t||k(o,t))&&s(u,r,n))};r(n.connections.source.slice(),0);r(n.connections.target.slice(),1)}n.remove(t,null,i)}};this.getGroup=function(n){var i=n;if(t.isString(n)&&(i=r[n],i==null))throw new TypeError("No such group ["+n+"]");return i};this.getGroups=function(){var n=[];for(var t in r)n.push(r[t]);return n};this.removeGroup=function(t,i,u,f){t=this.getGroup(t);this.expandGroup(t,!0);var e=t[i?nt:tt](u,f);return n.remove(t.getEl()),delete r[t.id],delete n._groups[t.id],n.fire(p,{group:t}),e};this.removeAllGroups=function(n,t,i){for(var u in r)this.removeGroup(r[u],n,t,i)};h=function(t,r,u){var f=t.endpoints[r===0?1:0].element,e,o;f[i]&&!f[i].shouldProxy()&&f[i].collapsed||(e=u.getEl(),o=n.getId(e),n.proxyConnection(t,r,e,o,function(n,t){return u.getEndpoint(n,t)},function(n,t){return u.getAnchor(n,t)}))};this.collapseGroup=function(t){var i,r;(t=this.getGroup(t),t==null||t.collapsed)||(i=t.getEl(),v(t,!1),t.shouldProxy()&&(r=function(n,i){for(var u,r=0;r<n.length;r++)u=n[r],h(u,i,t)},r(t.connections.source,0),r(t.connections.target,1)),t.collapsed=!0,n.removeClass(i,u),n.addClass(i,e),n.revalidate(i),n.fire(b,{group:t}))};s=function(t,i,r){n.unproxyConnection(t,i,n.getId(r.getEl()))};this.expandGroup=function(t,i){var r,f;(t=this.getGroup(t),t!=null&&t.collapsed)&&(r=t.getEl(),v(t,!0),t.shouldProxy()&&(f=function(n,i){for(var u,r=0;r<n.length;r++)u=n[r],s(u,i,t)},f(t.connections.source,0),f(t.connections.target,1)),t.collapsed=!1,n.addClass(r,u),n.removeClass(r,e),n.revalidate(r),this.repaintGroup(t),i||n.fire(w,{group:t}))};this.repaintGroup=function(t){var r,i;for(t=this.getGroup(t),r=t.getMembers(),i=0;i<r.length;i++)n.revalidate(r[i])};this.updateConnectionsForGroup=c;this.refreshAllGroups=function(){for(var t in r)c(r[t]),n.dragManager.updateOffsets(n.getId(r[t].getEl()))}},ft=function(n,u){function ct(n){return n.offsetParent}function nt(t,i){var o=ct(t),r=n.getSize(o),u=n.getSize(t),f=i[0],s=f+u[0],e=i[1],h=e+u[1];return s>0&&f<r[0]&&h>0&&e<r[1]}function tt(t){var i=n.getId(t),r=n.getOffset(t);return t.parentNode.removeChild(t),n.getContainer().appendChild(t),n.setPosition(t,r),ut(t),n.dragManager.clearParent(t,i),[i,r]}function it(t){function u(t,i,r){var u=null,f;return nt(t,[i,r])||(f=t._jsPlumbGroup,a?n.remove(t):u=tt(t),f.remove(t)),u}for(var r=[],i=0;i<t.selection.length;i++)r.push(u(t.selection[i][0],t.selection[i][1].left,t.selection[i][1].top));return r.length===1?r[0]:r}function rt(t){var i=n.getId(t);n.revalidate(t);n.dragManager.revalidateParent(t,i)}function ut(n){n._katavorioDrag&&((a||p)&&n._katavorioDrag.off(o,it),a||p||!w||(n._katavorioDrag.off(s,rt),n._katavorioDrag.setRevert(null)))}function ft(n){if(n._katavorioDrag){if(a||p)n._katavorioDrag.on(o,it);if(ot&&n._katavorioDrag.setConstrain(!0),g&&n._katavorioDrag.setUseGhostProxy(!0),!a&&!p&&w){n._katavorioDrag.on(s,rt);n._katavorioDrag.setRevert(function(n,t){return!nt(n,t)})}}}var f=this,y=u.el,b,d;this.getEl=function(){return y};this.id=u.id||t.uuid();y._isJsPlumbGroup=!0;var et=this.getDragArea=function(){var t=n.getSelector(y,h);return t&&t.length>0?t[0]:y},g=u.ghost===!0,ot=g||u.constrain===!0,w=u.revert!==!1,p=u.orphan===!0,a=u.prune===!0,st=u.dropOverride===!0,ht=u.proxied!==!1,e=[];this.connections={source:[],target:[],internal:[]};this.getAnchor=function(){return u.anchor||"Continuous"};this.getEndpoint=function(){return u.endpoint||["Dot",{radius:10}]};this.collapsed=!1;u.draggable!==!1&&(b={drag:function(){for(var t=0;t<e.length;t++)n.draw(e[t])},stop:function(t){n.fire(k,jsPlumb.extend(t,{group:f}))},scope:l},u.dragOptions&&r.jsPlumb.extend(b,u.dragOptions),n.draggable(u.el,b));u.droppable!==!1&&n.droppable(u.el,{drop:function(t){var i=t.drag.el,r;if(!i._isJsPlumbGroup&&(r=i._jsPlumbGroup,r!==f)){if(r!=null&&r.overrideDrop(i,f))return;n.getGroupManager().addToGroup(f,i,!1)}}});d=function(n,t){for(var r=n.nodeType==null?n:[n],i=0;i<r.length;i++)t(r[i])};this.overrideDrop=function(){return st&&(w||a||p)};this.add=function(t,i){var r=et();d(t,function(t){if(t._jsPlumbGroup!=null){if(t._jsPlumbGroup===f)return;t._jsPlumbGroup.remove(t,!0,i,!1)}t._jsPlumbGroup=f;e.push(t);n.isAlreadyDraggable(t)&&ft(t);t.parentNode!==r&&r.appendChild(t)});n.getGroupManager().updateConnectionsForGroup(f)};this.remove=function(i,r,u,o,s){d(i,function(i){if(i._jsPlumbGroup===f){if(delete i._jsPlumbGroup,t.removeWithFunction(e,function(n){return n===i}),r)try{f.getDragArea().removeChild(i)}catch(h){jsPlumbUtil.log("Could not remove element from Group "+h)}if(ut(i),!u){var o={group:f,el:i};s&&(o.targetGroup=s);n.fire(v,o)}}});o||n.getGroupManager().updateConnectionsForGroup(f)};this.removeAll=function(t,i){for(var u,r=0,o=e.length;r<o;r++)u=e[0],f.remove(u,t,i,!0),n.remove(u,!0);e.length=0;n.getGroupManager().updateConnectionsForGroup(f)};this.orphanAll=function(){for(var t,i={},n=0;n<e.length;n++)t=tt(e[n]),i[t[0]]=t[1];return e.length=0,i};this.getMembers=function(){return e};y[i]=this;n.bind(c,function(n){n.el._jsPlumbGroup===this&&ft(n.el)}.bind(this));this.shouldProxy=function(){return ht};n.getGroupManager().addGroup(this)};n.prototype.addGroup=function(n){var t=this,r;if(t._groups=t._groups||{},t._groups[n.id]!=null)throw new TypeError("cannot create Group ["+n.id+"]; a Group with that ID exists");if(n.el[i]!=null)throw new TypeError("cannot create Group ["+n.id+"]; the given element is already a Group");return r=new ft(t,n),t._groups[r.id]=r,n.collapsed&&this.collapseGroup(r),r};n.prototype.addToGroup=function(n,t,i){var u=function(t){var r=this.getId(t);this.manage(r,t);this.getGroupManager().addToGroup(n,t,i)}.bind(this),r;if(Array.isArray(t))for(r=0;r<t.length;r++)u(t[r]);else u(t)};n.prototype.removeFromGroup=function(n,t,i){this.getGroupManager().removeFromGroup(n,t,i);this.getContainer().appendChild(t)};n.prototype.removeGroup=function(n,t,i,r){return this.getGroupManager().removeGroup(n,t,i,r)};n.prototype.removeAllGroups=function(n,t,i){this.getGroupManager().removeAllGroups(n,t,i)};n.prototype.getGroup=function(n){return this.getGroupManager().getGroup(n)};n.prototype.getGroups=function(){return this.getGroupManager().getGroups()};n.prototype.expandGroup=function(n){this.getGroupManager().expandGroup(n)};n.prototype.collapseGroup=function(n){this.getGroupManager().collapseGroup(n)};n.prototype.repaintGroup=function(n){this.getGroupManager().repaintGroup(n)};n.prototype.toggleGroup=function(n){n=this.getGroupManager().getGroup(n);n!=null&&this.getGroupManager()[n.collapsed?"expandGroup":"collapseGroup"](n)};n.prototype.getGroupManager=function(){var n=this[f];return n==null&&(n=this[f]=new ut(this)),n};n.prototype.removeGroupManager=function(){delete this[f]};n.prototype.getGroupFor=function(n){if(n=this.getElement(n),n){for(var u=this.getContainer(),t=!1,r=null,f=null;!t;)n==null||n===u?t=!0:n[i]?(r=n[i],f=n,t=!0):n=n.parentNode;return r}}}.call(typeof window!="undefined"?window:this),function(){"use strict";var i=this,n=i.jsPlumb,r=i.jsPlumbUtil,t="Straight",u="Arc",f=function(i){this.type="Flowchart";i=i||{};i.stub=i.stub==null?30:i.stub;var r,f=n.Connectors.AbstractConnector.apply(this,arguments),h=i.midpoint==null||isNaN(i.midpoint)?.5:i.midpoint,p=i.alwaysRespectStubs===!0,e=null,o=null,w,c=i.cornerRadius!=null?i.cornerRadius:0,k=i.loopbackRadius||25,l=function(n){return n<0?-1:n===0?0:1},a=function(n){return[l(n[2]-n[0]),l(n[3]-n[1])]},s=function(n,t,i,r){if(e!==t||o!==i){var u=e==null?r.sx:e,f=o==null?r.sy:o,s=u===t?"v":"h";e=t;o=i;n.push([u,f,t,i,s])}},v=function(n){return Math.sqrt(Math.pow(n[0]-n[2],2)+Math.pow(n[1]-n[3],2))},y=function(n){var t=[];return t.push.apply(t,n),t},b=function(n,i,r){for(var g,l,k,d,e=null,o,h,s,w=0;w<i.length-1;w++){if(e=e||y(i[w]),o=y(i[w+1]),h=a(e),s=a(o),c>0&&e[4]!==o[4]){g=Math.min(v(e),v(o));l=Math.min(c,g/2);e[2]-=h[0]*l;e[3]-=h[1]*l;o[0]+=s[0]*l;o[1]+=s[1]*l;var p=h[1]===s[0]&&s[0]===1||h[1]===s[0]&&s[0]===0&&h[0]!==s[1]||h[1]===s[0]&&s[0]===-1,nt=o[1]>e[3]?1:-1,tt=o[0]>e[2]?1:-1,b=nt===tt,it=b&&p||!b&&!p?o[0]:e[2],rt=b&&p||!b&&!p?e[3]:o[1];f.addSegment(n,t,{x1:e[0],y1:e[1],x2:e[2],y2:e[3]});f.addSegment(n,u,{r:l,x1:e[2],y1:e[3],x2:o[0],y2:o[1],cx:it,cy:rt,ac:p})}else k=e[2]===e[0]?0:e[2]>e[0]?r.lw/2:-(r.lw/2),d=e[3]===e[1]?0:e[3]>e[1]?r.lw/2:-(r.lw/2),f.addSegment(n,t,{x1:e[0]-k,y1:e[1]-d,x2:e[2]+k,y2:e[3]+d});e=o}o!=null&&f.addSegment(n,t,{x1:o[0],y1:o[1],x2:o[2],y2:o[3]})};this.midpoint=h;this._compute=function(n,t){var a;r=[];e=null;o=null;w=null;var y=function(){return[n.startStubX,n.startStubY,n.endStubX,n.endStubY]},g={perpendicular:y,orthogonal:y,opposite:function(t){var i=n,r=t==="x"?0:1,u={x:function(){return i.so[r]===1&&(i.startStubX>i.endStubX&&i.tx>i.startStubX||i.sx>i.endStubX&&i.tx>i.sx)||i.so[r]===-1&&(i.startStubX<i.endStubX&&i.tx<i.startStubX||i.sx<i.endStubX&&i.tx<i.sx)},y:function(){return i.so[r]===1&&(i.startStubY>i.endStubY&&i.ty>i.startStubY||i.sy>i.endStubY&&i.ty>i.sy)||i.so[r]===-1&&(i.startStubY<i.endStubY&&i.ty<i.startStubY||i.sy<i.endStubY&&i.ty<i.sy)}};return!p&&u[t]()?{x:[(n.sx+n.tx)/2,n.startStubY,(n.sx+n.tx)/2,n.endStubY],y:[n.startStubX,(n.sy+n.ty)/2,n.endStubX,(n.sy+n.ty)/2]}[t]:[n.startStubX,n.startStubY,n.endStubX,n.endStubY]}},i=g[n.anchorOrientation](n.sourceAxis),l=n.sourceAxis==="x"?0:1,k=n.sourceAxis==="x"?1:0,nt=i[l],tt=i[k],it=i[l+2],rt=i[k+2];s(r,i[0],i[1],n);var u=n.startStubX+(n.endStubX-n.startStubX)*h,c=n.startStubY+(n.endStubY-n.startStubY)*h,d={x:[0,1],y:[1,0]},ut={perpendicular:function(t){var i=n,h={x:[[i.startStubX,i.endStubX],null,[i.endStubX,i.startStubX]],y:[[i.startStubY,i.endStubY],null,[i.endStubY,i.startStubY]]},v={x:[[u,i.startStubY],[u,i.endStubY]],y:[[i.startStubX,c],[i.endStubX,c]]},y={x:[[i.endStubX,i.startStubY]],y:[[i.startStubX,i.endStubY]]},p={x:[[i.startStubX,i.endStubY],[i.endStubX,i.endStubY]],y:[[i.endStubX,i.startStubY],[i.endStubX,i.endStubY]]},w={x:[[i.startStubX,c],[i.endStubX,c],[i.endStubX,i.endStubY]],y:[[u,i.startStubY],[u,i.endStubY],[i.endStubX,i.endStubY]]},f={x:[i.startStubY,i.endStubY],y:[i.startStubX,i.endStubX]},b=d[t][0],e=d[t][1],o=i.so[b]+1,k=i.to[e]+1,s=i.to[e]===-1&&f[t][1]<f[t][0]||i.to[e]===1&&f[t][1]>f[t][0],l=h[t][o][0],a=h[t][o][1],r={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]}[t][o][k];return i.segment===r[3]||i.segment===r[2]&&s?v[t]:i.segment===r[2]&&a<l?y[t]:i.segment===r[2]&&a>=l||i.segment===r[1]&&!s?w[t]:i.segment===r[0]||i.segment===r[1]&&s?p[t]:void 0},orthogonal:function(t,i,r,u,f){var o=n,e={x:o.so[0]===-1?Math.min(i,u):Math.max(i,u),y:o.so[1]===-1?Math.min(i,u):Math.max(i,u)}[t];return{x:[[e,r],[e,f],[u,f]],y:[[r,e],[f,e],[f,u]]}[t]},opposite:function(i,r,e,o){var s=n,a={x:"y",y:"x"}[i],v={x:"height",y:"width"}[i],y=s["is"+i.toUpperCase()+"GreaterThanStubTimes2"],h;return t.sourceEndpoint.elementId===t.targetEndpoint.elementId?(h=e+(1-t.sourceEndpoint.anchor[a])*t.sourceInfo[v]+f.maxStub,{x:[[r,h],[o,h]],y:[[h,r],[h,o]]}[i]):!y||s.so[l]===1&&r>o||s.so[l]===-1&&r<o?{x:[[r,c],[o,c]],y:[[u,r],[u,o]]}[i]:s.so[l]===1&&r<o||s.so[l]===-1&&r>o?{x:[[u,s.sy],[u,s.ty]],y:[[s.sx,c],[s.tx,c]]}[i]:void 0}},v=ut[n.anchorOrientation](n.sourceAxis,nt,tt,it,rt);if(v)for(a=0;a<v.length;a++)s(r,v[a][0],v[a][1],n);s(r,i[2],i[3],n);s(r,n.tx,n.ty,n);b(this,r,n)}};n.Connectors.Flowchart=f;r.extend(n.Connectors.Flowchart,n.Connectors.AbstractConnector)}.call(typeof window!="undefined"?window:this),function(){"use strict";var i=this,n=i.jsPlumb,r=i.jsPlumbUtil,t;n.Connectors.AbstractBezierConnector=function(t){t=t||{};var f=t.showLoopback!==!1,s=t.curviness||10,e=t.margin||5,h=t.proximityLimit||80,o=t.orientation&&t.orientation==="clockwise",i=t.loopbackRadius||25,r=!1,u;return this._compute=function(n,t){var c=t.sourcePos,l=t.targetPos,a=Math.abs(c[0]-l[0]),v=Math.abs(c[1]-l[1]);if(f&&t.sourceEndpoint.elementId===t.targetEndpoint.elementId){r=!0;var y=t.sourcePos[0],p=t.sourcePos[1]-e,w=y,b=p-i,s=w-i,h=b-i;a=2*i;v=2*i;n.points[0]=s;n.points[1]=h;n.points[2]=a;n.points[3]=v;u.addSegment(this,"Arc",{loopback:!0,x1:y-s+4,y1:p-h,startAngle:0,endAngle:2*Math.PI,r:i,ac:!o,x2:y-s-4,y2:p-h,cx:w-s,cy:b-h})}else r=!1,this._computeBezier(n,t,c,l,a,v)},u=n.Connectors.AbstractConnector.apply(this,arguments)};r.extend(n.Connectors.AbstractBezierConnector,n.Connectors.AbstractConnector);t=function(t){t=t||{};this.type="Bezier";var u=n.Connectors.AbstractBezierConnector.apply(this,arguments),r=t.curviness||150,i=10;this.getCurviness=function(){return r};this._findControlPoint=function(n,t,u,f,e,o,s){var c=o[0]!==s[0]||o[1]===s[1],h=[];return c?(s[0]===0?h.push(u[0]<t[0]?n[0]+i:n[0]-i):h.push(n[0]+r*s[0]),s[1]===0?h.push(u[1]<t[1]?n[1]+i:n[1]-i):h.push(n[1]+r*o[1])):(o[0]===0?h.push(t[0]<u[0]?n[0]+i:n[0]-i):h.push(n[0]-r*o[0]),o[1]===0?h.push(t[1]<u[1]?n[1]+i:n[1]-i):h.push(n[1]+r*s[1])),h};this._computeBezier=function(n,t,i,r,f,e){var o,s,h=i[0]<r[0]?f:0,c=i[1]<r[1]?e:0,l=i[0]<r[0]?0:f,a=i[1]<r[1]?0:e;o=this._findControlPoint([h,c],i,r,t.sourceEndpoint,t.targetEndpoint,n.so,n.to);s=this._findControlPoint([l,a],r,i,t.targetEndpoint,t.sourceEndpoint,n.to,n.so);u.addSegment(this,"Bezier",{x1:h,y1:c,x2:l,y2:a,cp1x:o[0],cp1y:o[1],cp2x:s[0],cp2y:s[1]})}};n.Connectors.Bezier=t;r.extend(t,n.Connectors.AbstractBezierConnector)}.call(typeof window!="undefined"?window:this),function(){"use strict";var t=this,n=t.jsPlumb,r=t.jsPlumbUtil,u=function(n,t,i,r){return n<=i&&r<=t?1:n<=i&&t<=r?2:i<=n&&r>=t?3:4},f=function(n,t,i,r,u,f,e,o,s){return o<=s?[n,t]:i===1?r[3]<=0&&u[3]>=1?[n+(r[2]<.5?-1*f:f),t]:r[2]>=1&&u[2]<=0?[n,t+(r[3]<.5?-1*e:e)]:[n+-1*f,t+-1*e]:i===2?r[3]>=1&&u[3]<=0?[n+(r[2]<.5?-1*f:f),t]:r[2]>=1&&u[2]<=0?[n,t+(r[3]<.5?-1*e:e)]:[n+f,t+-1*e]:i===3?r[3]>=1&&u[3]<=0?[n+(r[2]<.5?-1*f:f),t]:r[2]<=0&&u[2]>=1?[n,t+(r[3]<.5?-1*e:e)]:[n+-1*f,t+-1*e]:i===4?r[3]<=0&&u[3]>=1?[n+(r[2]<.5?-1*f:f),t]:r[2]<=0&&u[2]>=1?[n,t+(r[3]<.5?-1*e:e)]:[n+f,t+-1*e]:void 0},i=function(t){t=t||{};this.type="StateMachine";var o=n.Connectors.AbstractBezierConnector.apply(this,arguments),e=t.curviness||10,i=t.margin||5,s=t.proximityLimit||80,h=t.orientation&&t.orientation==="clockwise",r;this._computeBezier=function(n,t,h,c,l,a){var v=t.sourcePos[0]<t.targetPos[0]?0:l,y=t.sourcePos[1]<t.targetPos[1]?0:a,p=t.sourcePos[0]<t.targetPos[0]?l:0,w=t.sourcePos[1]<t.targetPos[1]?a:0;t.sourcePos[2]===0&&(v-=i);t.sourcePos[2]===1&&(v+=i);t.sourcePos[3]===0&&(y-=i);t.sourcePos[3]===1&&(y+=i);t.targetPos[2]===0&&(p-=i);t.targetPos[2]===1&&(p+=i);t.targetPos[3]===0&&(w-=i);t.targetPos[3]===1&&(w+=i);var nt=(v+p)/2,tt=(y+w)/2,it=u(v,y,p,w),rt=Math.sqrt(Math.pow(p-v,2)+Math.pow(w-y,2)),b,k,d,g;r=f(nt,tt,it,t.sourcePos,t.targetPos,e,e,rt,s);b=r[0];k=r[0];d=r[1];g=r[1];o.addSegment(this,"Bezier",{x1:p,y1:w,x2:v,y2:y,cp1x:b,cp1y:d,cp2x:k,cp2y:g})}};n.Connectors.StateMachine=i;r.extend(i,n.Connectors.AbstractBezierConnector)}.call(typeof window!="undefined"?window:this),function(){"use strict";var i=this,t=i.jsPlumb,u=i.jsPlumbUtil,n="Straight",r=function(){this.type=n;var i=t.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(t){i.addSegment(this,n,{x1:t.sx,y1:t.sy,x2:t.startStubX,y2:t.startStubY});i.addSegment(this,n,{x1:t.startStubX,y1:t.startStubY,x2:t.endStubX,y2:t.endStubY});i.addSegment(this,n,{x1:t.endStubX,y1:t.endStubY,x2:t.tx,y2:t.ty})}};t.Connectors.Straight=r;u.extend(r,t.Connectors.AbstractConnector)}.call(typeof window!="undefined"?window:this),function(){"use strict";var a=this,n=a.jsPlumb,i=a.jsPlumbUtil,v={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},o="stroke-dasharray",c="dashstyle",g="linearGradient",nt="radialGradient",tt="defs",y="fill",it="stop",p="stroke",rt="stroke-width",ut="style",w="none",ft="jsplumb_gradient_",et="strokeWidth",b={svg:"http://www.w3.org/2000/svg"},r=function(n,t){for(var i in t)n.setAttribute(i,""+t[i])},t=function(t,i){return i=i||{},i.version="1.1",i.xmlns=b.svg,n.createElementNS(b.svg,t,null,null,i)},s=function(n){return"position:absolute;left:"+n[0]+"px;top:"+n[1]+"px"},k=function(n){for(var i=n.querySelectorAll(" defs,linearGradient,radialGradient"),t=0;t<i.length;t++)i[t].parentNode.removeChild(i[t])},ot=function(n,i,r,u,f){var o=ft+f._jsPlumb.instance.idstamp(),s,h,e,c;for(k(n),s=r.gradient.offset?t(nt,{id:o}):t(g,{id:o,gradientUnits:"userSpaceOnUse"}),h=t(tt),n.appendChild(h),h.appendChild(s),e=0;e<r.gradient.stops.length;e++){var l=f.segment===1||f.segment===2?e:r.gradient.stops.length-1-e,a=r.gradient.stops[l][1],v=t(it,{offset:Math.floor(r.gradient.stops[e][0]*100)+"%","stop-color":a});s.appendChild(v)}c=r.stroke?p:y;i.setAttribute(c,"url(#"+o+")")},l=function(n,t,i,r,u){var f;if(t.setAttribute(y,i.fill?i.fill:w),t.setAttribute(p,i.stroke?i.stroke:w),i.gradient?ot(n,t,i,r,u):(k(n),t.setAttribute(ut,"")),i.strokeWidth&&t.setAttribute(rt,i.strokeWidth),i[c]&&i[et]&&!i[o]){var e=i[c].indexOf(",")===-1?" ":",",h=i[c].split(e),s="";h.forEach(function(n){s+=Math.floor(n*i.strokeWidth)+e});t.setAttribute(o,s)}else i[o]&&t.setAttribute(o,i[o]);for(f in v)i[f]&&t.setAttribute(v[f],i[f])},d=function(n,t,i){n.childNodes.length>i?n.insertBefore(t,n.childNodes[i]):n.appendChild(t)},f,e,u,h;i.svg={node:t,attr:r,pos:s};f=function(u){var c=u.pointerEventsSpec||"all",o={},f,h,e;return n.jsPlumbUIComponent.apply(this,u.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null,f=u.cssClass+" "+(u.originalArgs[0].cssClass||""),h={style:"",width:0,height:0,"pointer-events":c,position:"absolute"},this.svg=t("svg",h),u.useDivWrapper?(this.canvas=n.createElement("div",{position:"absolute"}),i.sizeElement(this.canvas,0,0,1,1),this.canvas.className=f):(r(this.svg,{"class":f}),this.canvas=this.svg),u._jsPlumb.appendElement(this.canvas,u.originalArgs[0].parent),u.useDivWrapper&&this.canvas.appendChild(this.svg),e=[this.canvas],this.getDisplayElements=function(){return e},this.appendDisplayElement=function(n){e.push(n)},this.paint=function(n,t,f){if(n!=null){var e=[this.x,this.y],h=[this.w,this.h],c;f!=null&&(f.xmin<0&&(e[0]+=f.xmin),f.ymin<0&&(e[1]+=f.ymin),h[0]=f.xmax+(f.xmin<0?-f.xmin:0),h[1]=f.ymax+(f.ymin<0?-f.ymin:0));u.useDivWrapper?(i.sizeElement(this.canvas,e[0],e[1],h[0]>0?h[0]:1,h[1]>0?h[1]:1),e[0]=0,e[1]=0,c=s([0,0])):c=s([e[0],e[1]]);o.paint.apply(this,arguments);r(this.svg,{style:c,width:h[0]||1,height:h[1]||1})}},{renderer:o}};i.extend(f,n.jsPlumbUIComponent,{cleanup:function(n){n||this.typeId==null?(this.canvas&&(this.canvas._jsPlumb=null),this.svg&&(this.svg._jsPlumb=null),this.bgCanvas&&(this.bgCanvas._jsPlumb=null),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.path=null,this.group=null,this._jsPlumb=null):(this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.bgCanvas.parentNode.removeChild(this.bgCanvas))},reattach:function(n){var t=n.getContainer();this.canvas&&this.canvas.parentNode==null&&t.appendChild(this.canvas);this.bgCanvas&&this.bgCanvas.parentNode==null&&t.appendChild(this.bgCanvas)},setVisible:function(n){this.canvas&&(this.canvas.style.display=n?"block":"none")}});n.ConnectorRenderers.svg=function(i){var u=this,e=f.apply(this,[{cssClass:i._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:i._jsPlumb}]);e.renderer.paint=function(f,e,o){var w=u.getSegments(),a="",h=[0,0],y,p;if(o.xmin<0&&(h[0]=-o.xmin),o.ymin<0&&(h[1]=-o.ymin),w.length>0){a=u.getPathData();var c={d:a,transform:"translate("+h[0]+","+h[1]+")","pointer-events":i["pointer-events"]||"visibleStroke"},s=null,v=[u.x,u.y,u.w,u.h];f.outlineStroke&&(y=f.outlineWidth||1,p=f.strokeWidth+2*y,s=n.extend({},f),delete s.gradient,s.stroke=f.outlineStroke,s.strokeWidth=p,u.bgPath==null?(u.bgPath=t("path",c),n.addClass(u.bgPath,n.connectorOutlineClass),d(u.svg,u.bgPath,0)):r(u.bgPath,c),l(u.svg,u.bgPath,s,v,u));u.path==null?(u.path=t("path",c),d(u.svg,u.path,f.outlineStroke?1:0)):r(u.path,c);l(u.svg,u.path,f,v,u)}}};i.extend(n.ConnectorRenderers.svg,f);e=n.SvgEndpoint=function(t){var i=f.apply(this,[{cssClass:t._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:t._jsPlumb}]);i.renderer.paint=function(t){var i=n.extend({},t);i.outlineStroke&&(i.stroke=i.outlineStroke);this.node==null?(this.node=this.makeNode(i),this.svg.appendChild(this.node)):this.updateNode!=null&&this.updateNode(this.node);l(this.svg,this.node,i,[this.x,this.y,this.w,this.h],this);s(this.node,[this.x,this.y])}.bind(this)};i.extend(e,f);n.Endpoints.svg.Dot=function(){n.Endpoints.Dot.apply(this,arguments);e.apply(this,arguments);this.makeNode=function(){return t("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})};this.updateNode=function(n){r(n,{cx:this.w/2,cy:this.h/2,r:this.radius})}};i.extend(n.Endpoints.svg.Dot,[n.Endpoints.Dot,e]);n.Endpoints.svg.Rectangle=function(){n.Endpoints.Rectangle.apply(this,arguments);e.apply(this,arguments);this.makeNode=function(){return t("rect",{width:this.w,height:this.h})};this.updateNode=function(n){r(n,{width:this.w,height:this.h})}};i.extend(n.Endpoints.svg.Rectangle,[n.Endpoints.Rectangle,e]);n.Endpoints.svg.Image=n.Endpoints.Image;n.Endpoints.svg.Blank=n.Endpoints.Blank;n.Overlays.svg.Label=n.Overlays.Label;n.Overlays.svg.Custom=n.Overlays.Custom;u=function(i,u){var e,f;i.apply(this,u);n.jsPlumbUIComponent.apply(this,u);this.isAppendedAtTopLevel=!1;e=this;this.path=null;this.paint=function(n,i){if(n.component.svg&&i){this.path==null&&(this.path=t("path",{"pointer-events":"all"}),n.component.svg.appendChild(this.path),this.elementCreated&&this.elementCreated(this.path,n.component),this.canvas=n.component.svg);var o=u&&u.length===1?u[0].cssClass||"":"",e=[0,0];i.xmin<0&&(e[0]=-i.xmin);i.ymin<0&&(e[1]=-i.ymin);r(this.path,{d:f(n.d),"class":o,stroke:n.stroke?n.stroke:null,fill:n.fill?n.fill:null,transform:"translate("+e[0]+","+e[1]+")"})}};f=function(n){return isNaN(n.cxy.x)||isNaN(n.cxy.y)?"":"M"+n.hxy.x+","+n.hxy.y+" L"+n.tail[0].x+","+n.tail[0].y+" L"+n.cxy.x+","+n.cxy.y+" L"+n.tail[1].x+","+n.tail[1].y+" L"+n.hxy.x+","+n.hxy.y};this.transfer=function(n){n.canvas&&this.path&&this.path.parentNode&&(this.path.parentNode.removeChild(this.path),n.canvas.appendChild(this.path))}};h={cleanup:function(n){this.path!=null&&(n?this._jsPlumb.instance.removeElement(this.path):this.path.parentNode&&this.path.parentNode.removeChild(this.path))},reattach:function(n,t){this.path&&t.canvas&&t.canvas.appendChild(this.path)},setVisible:function(n){this.path!=null&&(this.path.style.display=n?"block":"none")}};i.extend(u,[n.jsPlumbUIComponent,n.Overlays.AbstractOverlay]);n.Overlays.svg.Arrow=function(){u.apply(this,[n.Overlays.Arrow,arguments])};i.extend(n.Overlays.svg.Arrow,[n.Overlays.Arrow,u],h);n.Overlays.svg.PlainArrow=function(){u.apply(this,[n.Overlays.PlainArrow,arguments])};i.extend(n.Overlays.svg.PlainArrow,[n.Overlays.PlainArrow,u],h);n.Overlays.svg.Diamond=function(){u.apply(this,[n.Overlays.Diamond,arguments])};i.extend(n.Overlays.svg.Diamond,[n.Overlays.Diamond,u],h);n.Overlays.svg.GuideLines=function(){var u=null,i=this,f,e,o;n.Overlays.GuideLines.apply(this,arguments);this.paint=function(n,s){u==null&&(u=t("path"),n.connector.svg.appendChild(u),i.attachListeners(u,n.connector),i.attachListeners(u,i),f=t("path"),n.connector.svg.appendChild(f),i.attachListeners(f,n.connector),i.attachListeners(f,i),e=t("path"),n.connector.svg.appendChild(e),i.attachListeners(e,n.connector),i.attachListeners(e,i));var h=[0,0];s.xmin<0&&(h[0]=-s.xmin);s.ymin<0&&(h[1]=-s.ymin);r(u,{d:o(n.head,n.tail),stroke:"red",fill:null,transform:"translate("+h[0]+","+h[1]+")"});r(f,{d:o(n.tailLine[0],n.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+h[0]+","+h[1]+")"});r(e,{d:o(n.headLine[0],n.headLine[1]),stroke:"green",fill:null,transform:"translate("+h[0]+","+h[1]+")"})};o=function(n,t){return"M "+n.x+","+n.y+" L"+t.x+","+t.y}};i.extend(n.Overlays.svg.GuideLines,n.Overlays.GuideLines)}.call(typeof window!="undefined"?window:this),function(){"use strict";var r=this,n=r.jsPlumb,i=r.jsPlumbUtil,h=r.Katavorio,c=r.Biltong,l=function(n){var t=n._mottle;return t||(t=n._mottle=new r.Mottle),t},t=function(t,i){i=i||"main";var u="_katavorio_"+i,r=t[u],f=t.getEventManager();return r||(r=new h({bind:f.on,unbind:f.off,getSize:n.getSize,getConstrainingRectangle:function(n){return[n.parentNode.scrollWidth,n.parentNode.scrollHeight]},getPosition:function(n,i){var r=t.getOffset(n,i,n._katavorioDrag?n.offsetParent:null);return[r.left,r.top]},setPosition:function(n,t){n.style.left=t[0]+"px";n.style.top=t[1]+"px"},addClass:n.addClass,removeClass:n.removeClass,intersects:c.intersects,indexOf:function(n,t){return n.indexOf(t)},scope:t.getDefaultScope(),css:{noSelect:t.dragSelectClass,droppable:"jtk-droppable",draggable:"jtk-draggable",drag:"jtk-drag",selected:"jtk-drag-selected",active:"jtk-drag-active",hover:"jtk-drag-hover",ghostProxy:"jtk-ghost-proxy"}}),r.setZoom(t.getZoom()),t[u]=r,t.bind("zoom",r.setZoom)),r},a=function(n){var i=n.el._jsPlumbDragOptions,t=!0;return i.canDrag&&(t=i.canDrag()),t&&(this.setHoverSuspended(!0),this.select({source:n.el}).addClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:n.el}).addClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),this.setConnectionBeingDragged(!0)),t},v=function(n){var i=this.getUIPosition(arguments,this.getZoom()),t;i!=null&&(t=n.el._jsPlumbDragOptions,this.draw(n.el,i,null,!0),t._dragging&&this.addClass(n.el,"jtk-dragged"),t._dragging=!0)},y=function(n){for(var i=n.selection,r,u=function(t){var i;t[1]!=null&&(r=this.getUIPosition([{el:t[2].el,pos:[t[1].left,t[1].top]}]),i=this.draw(t[2].el,r));t[0]._jsPlumbDragOptions!=null&&delete t[0]._jsPlumbDragOptions._dragging;this.removeClass(t[0],"jtk-dragged");this.select({source:t[2].el}).removeClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0);this.select({target:t[2].el}).removeClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0);n.e._drawResult=n.e._drawResult||{c:[],e:[],a:[]};Array.prototype.push.apply(n.e._drawResult.c,i.c);Array.prototype.push.apply(n.e._drawResult.e,i.e);Array.prototype.push.apply(n.e._drawResult.a,i.a);this.getDragManager().dragEnded(t[2].el)}.bind(this),t=0;t<i.length;t++)u(i[t]);this.setHoverSuspended(!1);this.setConnectionBeingDragged(!1)},p=function(n,t){var r=function(r){if(t[r]!=null){if(i.isString(t[r])){var u=t[r].match(/-=/)?-1:1,f=t[r].substring(2);return n[r]+u*f}return t[r]}return n[r]};return[r("left"),r("top")]},u=function(n,t){if(t==null)return[0,0];var r=g(t),i=d(r,0);return[i[n+"X"],i[n+"Y"]]},w=u.bind(this,"page"),b=u.bind(this,"screen"),k=u.bind(this,"client"),d=function(n,t){return n.item?n.item(t):n[t]},g=function(n){return n.touches&&n.touches.length>0?n.touches:n.changedTouches&&n.changedTouches.length>0?n.changedTouches:n.targetTouches&&n.targetTouches.length>0?n.targetTouches:[n]},nt=function(n){var u={},f=[],t={},r={},i={};this.register=function(e){var o=n.getId(e),s,h;u[o]||(u[o]=e,f.push(e),t[o]={});h=function(u){var f,a,c,l;if(u)for(f=0;f<u.childNodes.length;f++)u.childNodes[f].nodeType!==3&&u.childNodes[f].nodeType!==8&&(a=jsPlumb.getElement(u.childNodes[f]),c=n.getId(u.childNodes[f],null,!0),c&&r[c]&&r[c]>0&&(s||(s=n.getOffset(e)),l=n.getOffset(a),t[o][c]={id:c,offset:{left:l.left-s.left,top:l.top-s.top}},i[c]=o),h(u.childNodes[f]))};h(e)};this.updateOffsets=function(r,u){var f,h,c;if(r!=null){u=u||{};var l=jsPlumb.getElement(r),e=n.getId(l),s=t[e],o;if(s)for(f in s)if(s.hasOwnProperty(f)){if(h=jsPlumb.getElement(f),c=u[f]||n.getOffset(h),h.offsetParent==null&&t[e][f]!=null)continue;o||(o=n.getOffset(l));t[e][f]={id:f,offset:{left:c.left-o.left,top:c.top-o.top}};i[f]=e}}};this.endpointAdded=function(f,e){var l,o,s,h,c;for(e=e||n.getId(f),l=document.body,o=f.parentNode,r[e]=r[e]?r[e]+1:1;o!=null&&o!==l;){if(s=n.getId(o,null,!0),s&&u[s]){h=n.getOffset(o);t[s][e]==null&&(c=n.getOffset(f),t[s][e]={id:e,offset:{left:c.left-h.left,top:c.top-h.top}},i[e]=s);break}o=o.parentNode}};this.endpointDeleted=function(n){if(r[n.elementId]&&(r[n.elementId]--,r[n.elementId]<=0))for(var u in t)t.hasOwnProperty(u)&&t[u]&&(delete t[u][n.elementId],delete i[n.elementId])};this.changeId=function(n,r){t[r]=t[n];t[n]={};i[r]=i[n];i[n]=null};this.getElementsForDraggable=function(n){return t[n]};this.elementRemoved=function(n){var r=i[n];r&&(t[r]&&delete t[r][n],delete i[n])};this.reset=function(){u={};f=[];t={};r={}};this.dragEnded=function(t){if(t.offsetParent!=null){var u=n.getId(t),r=i[u];r&&this.updateOffsets(r)}};this.setParent=function(r,u,f,e,o){var s=i[u],h,c;t[e]||(t[e]={});h=n.getOffset(f);c=o||n.getOffset(r);s&&t[s]&&delete t[s][u];t[e][u]={id:u,offset:{left:c.left-h.left,top:c.top-h.top}};i[u]=e};this.clearParent=function(n,r){var u=i[r];u&&(delete t[u][r],delete i[r])};this.revalidateParent=function(t,r,u){var f=i[r],e;f&&(e={},e[r]=u,this.updateOffsets(f,e),n.revalidate(f))};this.getDragAncestor=function(t){var u=jsPlumb.getElement(t),f=n.getId(u),r=i[f];return r?jsPlumb.getElement(r):null}},o=function(n,t,r){var u,f;t=i.fastTrim(t);typeof n.className.baseVal!="undefined"?n.className.baseVal=t:n.className=t;try{if(u=n.classList,u!=null){while(u.length>0)u.remove(u.item(0));for(f=0;f<r.length;f++)r[f]&&u.add(r[f])}}catch(e){i.log("JSPLUMB: cannot set class list",e)}},f=function(n){return typeof n.className.baseVal=="undefined"?n.className:n.className.baseVal},e=function(n,t,r){t=t==null?[]:i.isArray(t)?t:t.split(/\s+/);r=r==null?[]:i.isArray(r)?r:r.split(/\s+/);var s=f(n),u=s.split(/\s+/),e=function(n,t){for(var r,i=0;i<t.length;i++)n?u.indexOf(t[i])===-1&&u.push(t[i]):(r=u.indexOf(t[i]),r!==-1&&u.splice(r,1))};e(!0,t);e(!1,r);o(n,u.join(" "),u)},s;r.jsPlumb.extend(r.jsPlumbInstance.prototype,{headless:!1,pageLocation:w,screenLocation:b,clientLocation:k,getDragManager:function(){return this.dragManager==null&&(this.dragManager=new nt(this)),this.dragManager},recalculateOffsets:function(n){this.getDragManager().updateOffsets(n)},createElement:function(n,t,i,r){return this.createElementNS(null,n,t,i,r)},createElementNS:function(n,t,i,r,u){var e=n==null?document.createElement(t):document.createElementNS(n,t),f;i=i||{};for(f in i)e.style[f]=i[f];r&&(e.className=r);u=u||{};for(f in u)e.setAttribute(f,""+u[f]);return e},getAttribute:function(n,t){return n.getAttribute!=null?n.getAttribute(t):null},setAttribute:function(n,t,i){n.setAttribute!=null&&n.setAttribute(t,i)},setAttributes:function(n,t){for(var i in t)t.hasOwnProperty(i)&&n.setAttribute(i,t[i])},appendToRoot:function(n){document.body.appendChild(n)},getRenderModes:function(){return["svg"]},getClass:f,addClass:function(n,t){jsPlumb.each(n,function(n){e(n,t)})},hasClass:function(n,t){return n=jsPlumb.getElement(n),n.classList?n.classList.contains(t):f(n).indexOf(t)!==-1},removeClass:function(n,t){jsPlumb.each(n,function(n){e(n,null,t)})},toggleClass:function(n,t){jsPlumb.hasClass(n,t)?jsPlumb.removeClass(n,t):jsPlumb.addClass(n,t)},updateClasses:function(n,t,i){jsPlumb.each(n,function(n){e(n,t,i)})},setClass:function(n,t){t!=null&&jsPlumb.each(n,function(n){o(n,t,t.split(/\s+/))})},setPosition:function(n,t){n.style.left=t.left+"px";n.style.top=t.top+"px"},getPosition:function(n){var t=function(t){var i=n.style[t];return i?i.substring(0,i.length-2):0};return{left:t("left"),top:t("top")}},getStyle:function(n,t){return typeof getComputedStyle!="undefined"?getComputedStyle(n,null).getPropertyValue(t):n.currentStyle[t]},getSelector:function(n,t){return arguments.length===1?n.nodeType!=null?n:document.querySelectorAll(n):n.querySelectorAll(t)},getOffset:function(n,t,i){var f,e;n=jsPlumb.getElement(n);i=i||this.getContainer();for(var u={left:n.offsetLeft,top:n.offsetTop},r=t||i!=null&&n!==i&&n.offsetParent!==i?n.offsetParent:null,o=function(n){n!=null&&n!==document.body&&(n.scrollTop>0||n.scrollLeft>0)&&(u.left-=n.scrollLeft,u.top-=n.scrollTop)}.bind(this);r!=null;)u.left+=r.offsetLeft,u.top+=r.offsetTop,o(r),r=t?r.offsetParent:r.offsetParent===i?null:r.offsetParent;return i!=null&&!t&&(i.scrollTop>0||i.scrollLeft>0)&&(f=n.offsetParent!=null?this.getStyle(n.offsetParent,"position"):"static",e=this.getStyle(n,"position"),e!=="absolute"&&e!=="fixed"&&f!=="absolute"&&f!=="fixed"&&(u.left-=i.scrollLeft,u.top-=i.scrollTop)),u},getPositionOnElement:function(n,t,i){var r=typeof t.getBoundingClientRect!="undefined"?t.getBoundingClientRect():{left:0,top:0,width:0,height:0},u=document.body,f=document.documentElement,o=window.pageYOffset||f.scrollTop||u.scrollTop,s=window.pageXOffset||f.scrollLeft||u.scrollLeft,h=f.clientTop||u.clientTop||0,c=f.clientLeft||u.clientLeft||0,l=r.top+o-h+0*i,a=r.left+s-c+0*i,e=jsPlumb.pageLocation(n),v=r.width||t.offsetWidth*i,y=r.height||t.offsetHeight*i,p=(e[0]-a)/v,w=(e[1]-l)/y;return[p,w]},getAbsolutePosition:function(n){var t=function(t){var i=n.style[t];if(i)return parseFloat(i.substring(0,i.length-2))};return[t("left"),t("top")]},setAbsolutePosition:function(n,t,i,r){i?this.animate(n,{left:"+="+(t[0]-i[0]),top:"+="+(t[1]-i[1])},r):(n.style.left=t[0]+"px",n.style.top=t[1]+"px")},getSize:function(n){return[n.offsetWidth,n.offsetHeight]},getWidth:function(n){return n.offsetWidth},getHeight:function(n){return n.offsetHeight},getRenderMode:function(){return"svg"},draggable:function(n,t){var r;return n=i.isArray(n)||n.length!=null&&!i.isString(n)?n:[n],Array.prototype.slice.call(n).forEach(function(n){r=this.info(n);r.el&&this._initDraggableIfNecessary(r.el,!0,t,r.id,!0)}.bind(this)),this},snapToGrid:function(n,t,i){var r=[],u=function(n){var u=this.info(n),f;u.el!=null&&u.el._katavorioDrag&&(f=u.el._katavorioDrag.snap(t,i),this.revalidate(u.el),r.push([u.el,f]))}.bind(this),f,e;if(arguments.length===1||arguments.length===3)u(n,t,i);else{f=this.getManagedElements();for(e in f)u(e,arguments[0],arguments[1])}return r},initDraggable:function(n,i,r){t(this,r).draggable(n,i);n._jsPlumbDragOptions=i},destroyDraggable:function(n,i){t(this,i).destroyDraggable(n);n._jsPlumbDragOptions=null;n._jsPlumbRelatedElement=null},unbindDraggable:function(n,i,r,u){t(this,u).destroyDraggable(n,i,r)},setDraggable:function(n,t){return jsPlumb.each(n,function(n){this.isDragSupported(n)&&(this._draggableStates[this.getAttribute(n,"id")]=t,this.setElementDraggable(n,t))}.bind(this))},_draggableStates:{},toggleDraggable:function(n){var t;return jsPlumb.each(n,function(n){var i=this.getAttribute(n,"id");return t=this._draggableStates[i]==null?!1:this._draggableStates[i],t=!t,this._draggableStates[i]=t,this.setDraggable(n,t),t}.bind(this)),t},_initDraggableIfNecessary:function(n,t,r,u,f){var h,e,o,s;if(!jsPlumb.headless&&(h=t==null?!1:t,h&&jsPlumb.isDragSupported(n,this)))if(e=r||this.Defaults.DragOptions,e=jsPlumb.extend({},e),jsPlumb.isAlreadyDraggable(n,this))r.force&&this.initDraggable(n,e);else{var c=jsPlumb.dragEvents.drag,l=jsPlumb.dragEvents.stop,p=jsPlumb.dragEvents.start;this.manage(u,n);e[p]=i.wrap(e[p],a.bind(this));e[c]=i.wrap(e[c],v.bind(this));e[l]=i.wrap(e[l],y.bind(this));o=this.getId(n);this._draggableStates[o]=!0;s=this._draggableStates[o];e.disabled=s==null?!1:!s;this.initDraggable(n,e);this.getDragManager().register(n);f&&this.fire("elementDraggable",{el:n,options:e})}},animationSupported:!0,getElement:function(n){return n==null?null:(n=typeof n=="string"?n:n.tagName==null&&n.length!=null&&n.enctype==null?n[0]:n,typeof n=="string"?document.getElementById(n):n)},removeElement:function(n){t(this).elementRemoved(n);this.getEventManager().remove(n)},doAnimate:function(t,i,r){r=r||{};var u=this.getOffset(t),s=p(u,i),c=s[0]-u.left,l=s[1]-u.top,o=r.duration||250,e=15,h=o/e,a=e/o*c,v=e/o*l,f=0,y=setInterval(function(){n.setPosition(t,{left:u.left+a*(f+1),top:u.top+v*(f+1)});r.step!=null&&r.step(f,Math.ceil(h));f++;f>=h&&(window.clearInterval(y),r.complete!=null&&r.complete())},e)},destroyDroppable:function(n,i){t(this,i).destroyDroppable(n)},unbindDroppable:function(n,i,r,u){t(this,u).destroyDroppable(n,i,r)},droppable:function(n,t){n=i.isArray(n)||n.length!=null&&!i.isString(n)?n:[n];var r;return t=t||{},t.allowLoopback=!1,Array.prototype.slice.call(n).forEach(function(n){r=this.info(n);r.el&&this.initDroppable(r.el,t)}.bind(this)),this},initDroppable:function(n,i,r){t(this,r).droppable(n,i)},isAlreadyDraggable:function(n){return n._katavorioDrag!=null},isDragSupported:function(){return!0},isDropSupported:function(){return!0},isElementDraggable:function(t){return t=n.getElement(t),t._katavorioDrag&&t._katavorioDrag.isEnabled()},getDragObject:function(n){return n[0].drag.getDragElement()},getDragScope:function(n){return n._katavorioDrag&&n._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(n){return n[0].e},getUIPosition:function(n){var t=n[0].el,r,i,u;return t.offsetParent==null?null:(r=n[0].finalPos||n[0].pos,i={left:r[0],top:r[1]},t._katavorioDrag&&t.offsetParent!==this.getContainer()&&(u=this.getOffset(t.offsetParent),i.left+=u.left,i.top+=u.top),i)},setDragFilter:function(n,t,i){n._katavorioDrag&&n._katavorioDrag.setFilter(t,i)},setElementDraggable:function(t,i){t=n.getElement(t);t._katavorioDrag&&t._katavorioDrag.setEnabled(i)},setDragScope:function(n,t){n._katavorioDrag&&n._katavorioDrag.k.setDragScope(n,t)},setDropScope:function(n,t){n._katavorioDrop&&n._katavorioDrop.length>0&&n._katavorioDrop[0].k.setDropScope(n,t)},addToPosse:function(i){var u=Array.prototype.slice.call(arguments,1),r=t(this);n.each(i,function(t){t=[n.getElement(t)];t.push.apply(t,u);r.addToPosse.apply(r,t)})},setPosse:function(i){var u=Array.prototype.slice.call(arguments,1),r=t(this);n.each(i,function(t){t=[n.getElement(t)];t.push.apply(t,u);r.setPosse.apply(r,t)})},removeFromPosse:function(i){var u=Array.prototype.slice.call(arguments,1),r=t(this);n.each(i,function(t){t=[n.getElement(t)];t.push.apply(t,u);r.removeFromPosse.apply(r,t)})},removeFromAllPosses:function(i){var r=t(this);n.each(i,function(t){r.removeFromAllPosses(n.getElement(t))})},setPosseState:function(i,r,u){var f=t(this);n.each(i,function(t){f.setPosseState(n.getElement(t),r,u)})},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete",beforeStart:"beforeStart"},animEvents:{step:"step",complete:"complete"},stopDrag:function(n){n._katavorioDrag&&n._katavorioDrag.abort()},addToDragSelection:function(n){var i=this.getElement(n);i!=null&&(i._isJsPlumbGroup||i._jsPlumbGroup==null)&&t(this).select(n)},removeFromDragSelection:function(n){t(this).deselect(n)},getDragSelection:function(){return t(this).getSelection()},clearDragSelection:function(){t(this).deselectAll()},trigger:function(n,t,i,r){this.getEventManager().trigger(n,t,i,r)},doReset:function(){for(var n in this)n.indexOf("_katavorio_")===0&&this[n].reset()},getEventManager:function(){return l(this)},on:function(){return this.getEventManager().on.apply(this,arguments),this},off:function(){return this.getEventManager().off.apply(this,arguments),this}});s=function(n){var t=function(){/complete|loaded|interactive/.test(document.readyState)&&typeof document.body!="undefined"&&document.body!=null?n():setTimeout(t,9)};t()};s(n.init)}.call(typeof window!="undefined"?window:this);